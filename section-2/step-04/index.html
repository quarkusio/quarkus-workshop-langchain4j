
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../step-03/">
      
      
        <link rel="next" href="../conclusion/">
      
      
      <link rel="icon" href="../../images/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Step 4 - Using remote agents (A2A) - Quarkus LangChain4j Workshop</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#step-04-using-remote-agents-a2a" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
You are not viewing the latest version.
<a href="../../..">
    <strong>Click here to go to latest.</strong>
</a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Quarkus LangChain4j Workshop" class="md-header__button md-logo" aria-label="Quarkus LangChain4j Workshop" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Quarkus LangChain4j Workshop
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Step 4 - Using remote agents (A2A)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H6zm7-4.68V17c0 .55-.45 1-1 1H6c-.55 0-1-.45-1-1v-2.26C3.19 13.47 2 11.38 2 9c0-3.87 3.13-7 7-7 1.65 0 3.16.57 4.35 1.5C10.8 4.57 9 7.07 9 10c0 2.79 1.64 5.19 4 6.32m7.92-6.38-1.42-.91-1.4.97.4-1.65-1.33-1.03 1.68-.11.56-1.61.63 1.58 1.68.04-1.3 1.08zM19.39 13c-1.89 2.27-5.36 2.19-7.17-.05C10 10.13 11.56 6 15 5.34c.34-.05.64.29.5.63-.45 1.28-.38 2.74.35 4a4.62 4.62 0 0 0 3.27 2.28c.35.05.5.49.27.75"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 6a6 6 0 0 1 6 6c0 2.22-1.21 4.16-3 5.2V19a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-1.8c-1.79-1.04-3-2.98-3-5.2a6 6 0 0 1 6-6m2 15v1a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-1zm6-10h3v2h-3zM1 11h3v2H1zM13 1v3h-2V1zM4.92 3.5l2.13 2.14-1.42 1.41L3.5 4.93zm12.03 2.13 2.12-2.13 1.43 1.43-2.13 2.12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/quarkusio/quarkus-langchain4j-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Quarkus LangChain4j Workshop" class="md-nav__button md-logo" aria-label="Quarkus LangChain4j Workshop" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    Quarkus LangChain4j Workshop
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/quarkusio/quarkus-langchain4j-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Requirements
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Section 1 - AI Apps
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Section 1 - AI Apps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 1 - Introduction to Quarkus LangChain4j
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 2 - Playing with model parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 3 - Streaming responses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 4 - Using system messages
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 5 - Introduction to the RAG pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 6 - Deconstructing the RAG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 7 - Function calling and tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 8 - Model Context Protocol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 9 - Guardrails
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 10 - Observability and Fault Tolerance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Section 2 - Agentic Workflows
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Section 2 - Agentic Workflows
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../step-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 1 - Implementing AI Agents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../step-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 2 - Composing simple agent workflows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../step-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 3 - Building nested agent workflows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Step 4 - Using remote agents (A2A)
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Step 4 - Using remote agents (A2A)
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#new-requirement-car-disposal-decisions" class="md-nav__link">
    <span class="md-ellipsis">
      New Requirement: Car Disposal Decisions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-youll-learn" class="md-nav__link">
    <span class="md-ellipsis">
      What You&rsquo;ll Learn
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-a2a-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the A2A Protocol
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the A2A Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-a2a" class="md-nav__link">
    <span class="md-ellipsis">
      Why A2A?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a2a-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      A2A Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-tasks-vs-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Tasks vs. Messages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-are-we-going-to-build" class="md-nav__link">
    <span class="md-ellipsis">
      What Are We Going to Build?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-project-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the Project Structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#option-1-continue-from-step-03" class="md-nav__link">
    <span class="md-ellipsis">
      Option 1: Continue from Step 03
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#option-2-start-fresh-from-step-04" class="md-nav__link">
    <span class="md-ellipsis">
      Option 2: Start Fresh from Step 04
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-1-build-the-client-side-components" class="md-nav__link">
    <span class="md-ellipsis">
      Part 1: Build the Client-Side Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 1: Build the Client-Side Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-dispositionfeedbackagent" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create the DispositionFeedbackAgent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-create-the-dispositionagent-client" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Create the DispositionAgent (Client)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Create the DispositionAgent (Client)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a2aclientagent-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      @A2AClientAgent Annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-method-signature" class="md-nav__link">
    <span class="md-ellipsis">
      The Method Signature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      How It Works
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-2-update-the-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      Part 2: Update the Workflows
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 2: Update the Workflows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-3-update-feedbackworkflow" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Update FeedbackWorkflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-update-actionworkflow" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Update ActionWorkflow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Update ActionWorkflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#added-dispositionagent-to-subagents" class="md-nav__link">
    <span class="md-ellipsis">
      Added DispositionAgent to SubAgents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#added-activation-condition" class="md-nav__link">
    <span class="md-ellipsis">
      Added Activation Condition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updated-execution-priority" class="md-nav__link">
    <span class="md-ellipsis">
      Updated Execution Priority
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-update-carconditionfeedbackagent" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Update CarConditionFeedbackAgent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-update-carprocessingworkflow" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Update CarProcessingWorkflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-update-requiredaction-enum" class="md-nav__link">
    <span class="md-ellipsis">
      Step 7: Update RequiredAction Enum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-8-update-carmanagementservice" class="md-nav__link">
    <span class="md-ellipsis">
      Step 8: Update CarManagementService
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-3-build-the-remote-a2a-server" class="md-nav__link">
    <span class="md-ellipsis">
      Part 3: Build the Remote A2A Server
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 3: Build the Remote A2A Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-9-create-the-dispositiontool" class="md-nav__link">
    <span class="md-ellipsis">
      Step 9: Create the DispositionTool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-10-create-the-dispositionagent-ai-service" class="md-nav__link">
    <span class="md-ellipsis">
      Step 10: Create the DispositionAgent (AI Service)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-11-create-the-agentcard" class="md-nav__link">
    <span class="md-ellipsis">
      Step 11: Create the AgentCard
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 11: Create the AgentCard">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#publicagentcard-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      @PublicAgentCard Annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentcard-components" class="md-nav__link">
    <span class="md-ellipsis">
      AgentCard Components
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-12-create-the-agentexecutor" class="md-nav__link">
    <span class="md-ellipsis">
      Step 12: Create the AgentExecutor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 12: Create the AgentExecutor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cdi-bean-with-agentexecutor-factory" class="md-nav__link">
    <span class="md-ellipsis">
      CDI Bean with AgentExecutor Factory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Task Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Extract Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-the-ai-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Call the AI Agent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-task-status" class="md-nav__link">
    <span class="md-ellipsis">
      Update Task Status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Helper Methods
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-it-out" class="md-nav__link">
    <span class="md-ellipsis">
      Try It Out
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Try It Out">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terminal-1-start-the-remote-a2a-server" class="md-nav__link">
    <span class="md-ellipsis">
      Terminal 1: Start the Remote A2A Server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terminal-2-start-the-main-application" class="md-nav__link">
    <span class="md-ellipsis">
      Terminal 2: Start the Main Application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-complete-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Test the Complete Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-the-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Check the Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-all-works-together" class="md-nav__link">
    <span class="md-ellipsis">
      How It All Works Together
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-a2a-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the A2A Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the A2A Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client-side-a2aclientagent" class="md-nav__link">
    <span class="md-ellipsis">
      Client Side (@A2AClientAgent)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-side-agentcard-agentexecutor" class="md-nav__link">
    <span class="md-ellipsis">
      Server Side (AgentCard + AgentExecutor)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experiment-further" class="md-nav__link">
    <span class="md-ellipsis">
      Experiment Further
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Experiment Further">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-agent-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      1. Add Agent Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-test-different-disposition-scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      2. Test Different Disposition Scenarios
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-create-your-own-a2a-agent" class="md-nav__link">
    <span class="md-ellipsis">
      3. Create Your Own A2A Agent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-monitor-a2a-communication" class="md-nav__link">
    <span class="md-ellipsis">
      4. Monitor A2A Communication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      What&rsquo;s Next?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conclusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mastering Agentic Systems
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conclusion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conclusion
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#new-requirement-car-disposal-decisions" class="md-nav__link">
    <span class="md-ellipsis">
      New Requirement: Car Disposal Decisions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-youll-learn" class="md-nav__link">
    <span class="md-ellipsis">
      What You&rsquo;ll Learn
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-a2a-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the A2A Protocol
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the A2A Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-a2a" class="md-nav__link">
    <span class="md-ellipsis">
      Why A2A?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a2a-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      A2A Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-tasks-vs-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding Tasks vs. Messages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-are-we-going-to-build" class="md-nav__link">
    <span class="md-ellipsis">
      What Are We Going to Build?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-project-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the Project Structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#option-1-continue-from-step-03" class="md-nav__link">
    <span class="md-ellipsis">
      Option 1: Continue from Step 03
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#option-2-start-fresh-from-step-04" class="md-nav__link">
    <span class="md-ellipsis">
      Option 2: Start Fresh from Step 04
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-1-build-the-client-side-components" class="md-nav__link">
    <span class="md-ellipsis">
      Part 1: Build the Client-Side Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 1: Build the Client-Side Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-dispositionfeedbackagent" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Create the DispositionFeedbackAgent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-create-the-dispositionagent-client" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Create the DispositionAgent (Client)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Create the DispositionAgent (Client)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a2aclientagent-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      @A2AClientAgent Annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-method-signature" class="md-nav__link">
    <span class="md-ellipsis">
      The Method Signature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      How It Works
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-2-update-the-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      Part 2: Update the Workflows
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 2: Update the Workflows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-3-update-feedbackworkflow" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Update FeedbackWorkflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-update-actionworkflow" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Update ActionWorkflow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Update ActionWorkflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#added-dispositionagent-to-subagents" class="md-nav__link">
    <span class="md-ellipsis">
      Added DispositionAgent to SubAgents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#added-activation-condition" class="md-nav__link">
    <span class="md-ellipsis">
      Added Activation Condition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updated-execution-priority" class="md-nav__link">
    <span class="md-ellipsis">
      Updated Execution Priority
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-update-carconditionfeedbackagent" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Update CarConditionFeedbackAgent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-update-carprocessingworkflow" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Update CarProcessingWorkflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-update-requiredaction-enum" class="md-nav__link">
    <span class="md-ellipsis">
      Step 7: Update RequiredAction Enum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-8-update-carmanagementservice" class="md-nav__link">
    <span class="md-ellipsis">
      Step 8: Update CarManagementService
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-3-build-the-remote-a2a-server" class="md-nav__link">
    <span class="md-ellipsis">
      Part 3: Build the Remote A2A Server
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 3: Build the Remote A2A Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-9-create-the-dispositiontool" class="md-nav__link">
    <span class="md-ellipsis">
      Step 9: Create the DispositionTool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-10-create-the-dispositionagent-ai-service" class="md-nav__link">
    <span class="md-ellipsis">
      Step 10: Create the DispositionAgent (AI Service)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-11-create-the-agentcard" class="md-nav__link">
    <span class="md-ellipsis">
      Step 11: Create the AgentCard
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 11: Create the AgentCard">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#publicagentcard-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      @PublicAgentCard Annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentcard-components" class="md-nav__link">
    <span class="md-ellipsis">
      AgentCard Components
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-12-create-the-agentexecutor" class="md-nav__link">
    <span class="md-ellipsis">
      Step 12: Create the AgentExecutor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 12: Create the AgentExecutor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cdi-bean-with-agentexecutor-factory" class="md-nav__link">
    <span class="md-ellipsis">
      CDI Bean with AgentExecutor Factory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Task Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Extract Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-the-ai-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Call the AI Agent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-task-status" class="md-nav__link">
    <span class="md-ellipsis">
      Update Task Status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Helper Methods
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-it-out" class="md-nav__link">
    <span class="md-ellipsis">
      Try It Out
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Try It Out">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terminal-1-start-the-remote-a2a-server" class="md-nav__link">
    <span class="md-ellipsis">
      Terminal 1: Start the Remote A2A Server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terminal-2-start-the-main-application" class="md-nav__link">
    <span class="md-ellipsis">
      Terminal 2: Start the Main Application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-complete-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Test the Complete Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-the-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Check the Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-all-works-together" class="md-nav__link">
    <span class="md-ellipsis">
      How It All Works Together
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-a2a-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding the A2A Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the A2A Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client-side-a2aclientagent" class="md-nav__link">
    <span class="md-ellipsis">
      Client Side (@A2AClientAgent)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-side-agentcard-agentexecutor" class="md-nav__link">
    <span class="md-ellipsis">
      Server Side (AgentCard + AgentExecutor)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Key Takeaways
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experiment-further" class="md-nav__link">
    <span class="md-ellipsis">
      Experiment Further
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Experiment Further">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-agent-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      1. Add Agent Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-test-different-disposition-scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      2. Test Different Disposition Scenarios
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-create-your-own-a2a-agent" class="md-nav__link">
    <span class="md-ellipsis">
      3. Create Your Own A2A Agent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-monitor-a2a-communication" class="md-nav__link">
    <span class="md-ellipsis">
      4. Monitor A2A Communication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      What&rsquo;s Next?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<div><h1 id="step-04-using-remote-agents-a2a">Step 04 - Using Remote Agents (A2A)<a class="headerlink" href="#step-04-using-remote-agents-a2a" title="Permanent link"></a></h1>
<h2 id="new-requirement-car-disposal-decisions">New Requirement: Car Disposal Decisions<a class="headerlink" href="#new-requirement-car-disposal-decisions" title="Permanent link"></a></h2>
<p>The Miles of Smiles management team has yet another new challenge: they need to decide what to do with cars that are beyond economical repair.</p>
<p>When cars are returned with severe damage or major mechanical issues, the company needs to:</p>
<ol>
<li><strong>Analyze if disposal is needed</strong>: determine if repair costs exceed the car’s value</li>
<li><strong>Consult a specialized disposition expert</strong>: a remote AI agent that makes disposal recommendations</li>
<li><strong>Execute the disposal decision</strong>: scrap, sell, or donate the car</li>
</ol>
<p>The disposition expert is maintained by a separate (remote) team and runs in its own system. 
You’ll learn how to integrate it using the <strong>Agent-to-Agent (A2A) protocol</strong>.</p>
<hr>
<h2 id="what-youll-learn">What You’ll Learn<a class="headerlink" href="#what-youll-learn" title="Permanent link"></a></h2>
<p>In this step, you will:</p>
<ul>
<li>Understand the <strong>Agent-to-Agent (A2A) protocol</strong> for distributed agent communication</li>
<li>Build a <strong>client agent</strong> that connects to remote A2A agents using <code>@A2AClientAgent</code></li>
<li>Create an <strong>A2A server</strong> that exposes an AI agent as a remote service</li>
<li>Learn about <strong>AgentCard</strong>, <strong>AgentExecutor</strong>, and <strong>TaskUpdater</strong> components from the A2A SDK</li>
<li>Understand the difference between <strong>Tasks</strong> and <strong>Messages</strong> in A2A protocol</li>
<li>Run <strong>multiple Quarkus applications</strong> that communicate via A2A</li>
<li>Integrate remote agents into existing workflows</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At the moment the A2A integration is quite low-level and requires some boilerplate code.
The Quarkus LangChain4j team is working on higher-level abstractions to simplify A2A usage in future releases.</p>
</div>
<hr>
<h2 id="understanding-the-a2a-protocol">Understanding the A2A Protocol<a class="headerlink" href="#understanding-the-a2a-protocol" title="Permanent link"></a></h2>
<p>The <strong>Agent-to-Agent (A2A) protocol</strong> is an open standard for AI agents to communicate across different systems and platforms.</p>
<h3 id="why-a2a">Why A2A?<a class="headerlink" href="#why-a2a" title="Permanent link"></a></h3>
<ul>
<li><strong>Separation of concerns</strong>: Different teams can develop specialized agents independently</li>
<li><strong>Scalability</strong>: Distribute agent workload across multiple systems</li>
<li><strong>Reusability</strong>: One agent can serve multiple client applications</li>
<li><strong>Technology independence</strong>: Agents can be implemented in different languages/frameworks</li>
</ul>
<h3 id="a2a-architecture">A2A Architecture<a class="headerlink" href="#a2a-architecture" title="Permanent link"></a></h3>
<pre class="mermaid"><code>graph LR
    subgraph "Quarkus Runtime 1: Car Management System"
        W[CarProcessingWorkflow] 
        DA["DispositionAgent&lt;br/&gt;@A2AClientAgent"]
        W --&gt; DA
    end

    subgraph "A2A Protocol Layer"
        AP[JSON-RPC over HTTP]
    end

    subgraph "Quarkus Runtime 2: Disposition Service"
        AC[AgentCard&lt;br/&gt;Agent Metadata]
        AE[AgentExecutor&lt;br/&gt;Request Handler]
        AI[DispositionAgent&lt;br/&gt;AI Service]
        T[DispositionTool]

        AC -.describes.-&gt; AI
        AE --&gt; AI
        AI --&gt; T
    end

    DA --&gt;|A2A Request| AP
    AP --&gt;|A2A Response| DA
    AP &lt;--&gt;|JSON-RPC| AE
</code></pre>
<p><strong>The Flow:</strong></p>
<ol>
<li><strong>Client agent</strong> (<code>DispositionAgent</code> with <code>@A2AClientAgent</code>) sends a request to the remote agent</li>
<li><strong>A2A Protocol Layer</strong> (JSON-RPC) transports the request over HTTP</li>
<li><strong>AgentCard</strong> describes the remote agent’s capabilities (skills, inputs, outputs)</li>
<li><strong>AgentExecutor</strong> receives the request and orchestrates the execution</li>
<li><strong>Remote AI agent</strong> (DispositionAgent AI service) processes the request using tools</li>
<li>Response flows back through the same path</li>
</ol>
<hr>
<h2 id="understanding-tasks-vs-messages">Understanding Tasks vs. Messages<a class="headerlink" href="#understanding-tasks-vs-messages" title="Permanent link"></a></h2>
<p>The A2A protocol distinguishes between two types of interactions:</p>
<table>
<thead>
<tr>
<th>Concept</th>
<th>Description</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Task</strong></td>
<td>A long-running job with a defined goal and tracked state</td>
<td>“Determine if this car should be scrapped”</td>
</tr>
<tr>
<td><strong>Message</strong></td>
<td>A single conversational exchange with no tracked state</td>
<td>Chat messages, quick questions</td>
</tr>
</tbody>
</table>
<p>In this step, we’ll use <strong>Tasks</strong> because car disposition analysis is a discrete job with a clear objective.</p>
<p><strong>Task Lifecycle:</strong></p>
<pre class="mermaid"><code>sequenceDiagram
    participant Client as Client Agent
    participant Server as A2A Server
    participant Executor as AgentExecutor
    participant AI as AI Agent

    Client-&gt;&gt;Server: Create Task (POST /tasks)
    Server-&gt;&gt;Executor: Initialize TaskUpdater
    Executor-&gt;&gt;AI: Execute with input
    AI-&gt;&gt;AI: Process and use tools
    AI-&gt;&gt;Executor: Return result
    Executor-&gt;&gt;Server: Update task status
    Server-&gt;&gt;Client: Task result</code></pre>
<hr>
<h2 id="what-are-we-going-to-build">What Are We Going to Build?<a class="headerlink" href="#what-are-we-going-to-build" title="Permanent link"></a></h2>
<p><img alt="App Blueprint" class="center" src="../../images/agentic-app-4.png"></p>
<p>We’ll extend the car management system with:</p>
<ol>
<li><strong>DispositionFeedbackAgent</strong>: Analyzes if a car should be disposed (scrap/sell/donate)</li>
<li><strong>DispositionAgent (Client)</strong>: Connects to the remote disposition expert via A2A</li>
<li><strong>Remote A2A Server</strong>: A separate Quarkus application exposing the disposition expert</li>
<li><strong>Disposition Workflow</strong>: Integrates disposition analysis into the car processing flow</li>
</ol>
<p><strong>The Complete Architecture:</strong></p>
<pre class="mermaid"><code>graph TD
    subgraph "Main Application (localhost:8080)"
        R[Rental/CarWash/Maintenance Returns]
        FW[FeedbackWorkflow&lt;br/&gt;Parallel]
        DFA[DispositionFeedbackAgent]
        AW[ActionWorkflow&lt;br/&gt;Conditional]
        DAC["DispositionAgent&lt;br/&gt;@A2AClientAgent"]

        R --&gt; FW
        FW --&gt; DFA
        DFA --&gt; AW
        AW --&gt; DAC
    end

    subgraph "Remote Disposition Service (localhost:8888)"
        AC[AgentCard]
        AE[AgentExecutor]
        DAI[DispositionAgent&lt;br/&gt;AI Service]
        DT[DispositionTool]

        AE --&gt; DAI
        DAI --&gt; DT
    end

    DAC --&gt;|A2A Protocol| AE
</code></pre>
<hr>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link"></a></h2>
<p>Before starting:</p>
<ul>
<li>Completed Step 03 (or have the <code>section-2/step-03</code> code available)</li>
<li>Application from Step 03 is stopped (Ctrl+C)</li>
<li>Ports 8080 and 8888 are available (you’ll run two applications simultaneously)</li>
</ul>
<hr>
<h2 id="understanding-the-project-structure">Understanding the Project Structure<a class="headerlink" href="#understanding-the-project-structure" title="Permanent link"></a></h2>
<p>The Step 04 code includes <strong>two separate Quarkus applications</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>section-2/step-04/
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>├── multi-agent-system/          # Main car management application (port 8080)
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>│   ├── src/main/java/com/carmanagement/
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>│   │   ├── agentic/
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>│   │   │   ├── agents/
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>│   │   │   │   ├── DispositionAgent.java          # A2A client agent
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>│   │   │   │   └── DispositionFeedbackAgent.java  # Analyzes disposal needs
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>│   │   │   └── workflow/
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>│   │   │       ├── FeedbackWorkflow.java          # Parallel analysis
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>│   │   │       ├── ActionWorkflow.java            # Conditional routing
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>│   │   │       └── CarProcessingWorkflow.java     # Main orchestrator
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>│   └── pom.xml
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>│
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>└── remote-a2a-agent/            # Remote disposition service (port 8888)
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    ├── src/main/java/com/demo/
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    │   ├── DispositionAgentCard.java       # Describes agent capabilities
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    │   ├── DispositionAgentExecutor.java   # Handles A2A requests
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    │   ├── DispositionAgent.java           # AI service
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    │   └── DispositionTool.java            # Tool for scrap/sell/donate
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    └── pom.xml
</code></pre></div>
<p><strong>Why Two Applications?</strong></p>
<ul>
<li>Simulates a real-world scenario where different teams maintain different agents</li>
<li>The disposition service could be reused by multiple client applications</li>
<li>Demonstrates cross-application agent communication via A2A</li>
</ul>
<hr>
<h2 id="option-1-continue-from-step-03">Option 1: Continue from Step 03<a class="headerlink" href="#option-1-continue-from-step-03" title="Permanent link"></a></h2>
<p>If you want to continue building on your Step 03 code, copy the updated files:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1">Linux / macOS</label><label for="__tabbed_1_2">Windows</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">cd</span><span class="w"> </span>section-2/step-03
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>cp<span class="w"> </span>../step-04/multi-agent-system/pom.xml<span class="w"> </span>./pom.xml
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>cp<span class="w"> </span>../step-04/multi-agent-system/src/main/java/com/carmanagement/model/CarInfo.java<span class="w"> </span>./src/main/java/com/carmanagement/model/CarInfo.java
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>cp<span class="w"> </span>../step-04/multi-agent-system/src/main/java/com/carmanagement/model/CarStatus.java<span class="w"> </span>./src/main/java/com/carmanagement/model/CarStatus.java
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>cp<span class="w"> </span>../step-04/multi-agent-system/src/main/resources/static/css/styles.css<span class="w"> </span>./src/main/resources/static/css/styles.css
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>cp<span class="w"> </span>../step-04/multi-agent-system/src/main/resources/static/js/app.js<span class="w"> </span>./src/main/resources/static/js/app.js
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>cp<span class="w"> </span>../step-04/multi-agent-system/src/main/resources/templates/index.html<span class="w"> </span>./src/main/resources/templates/index.html
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>cp<span class="w"> </span>../step-04/multi-agent-system/src/main/resources/import.sql<span class="w"> </span>./src/main/resources/import.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>cd section-2\step-03
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>copy ..\step-04\multi-agent-system\pom.xml .\pom.xml
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>copy ..\step-04\multi-agent-system\src\main\java\com\carmanagement\model\CarInfo.java .\src\main\java\com\carmanagement\model\CarInfo.java
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>copy ..\step-04\multi-agent-system\src\main\java\com\carmanagement\model\CarStatus.java .\src\main\java\com\carmanagement\model\CarStatus.java
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>copy ..\step-04\multi-agent-system\src\main\resources\static\css\styles.css .\src\main\resources\static\css\styles.css
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>copy ..\step-04\multi-agent-system\src\main\resources\static\js\app.js .\src\main\resources\static\js\app.js
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>copy ..\step-04\multi-agent-system\src\main\resources\templates\index.html .\src\main\resources\templates\index.html
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>copy ..\step-04\multi-agent-system\src\main\resources\import.sql .\src\main\resources\import.sql
</code></pre></div>
</div>
</div>
</div>
<hr>
<h2 id="option-2-start-fresh-from-step-04">Option 2: Start Fresh from Step 04<a class="headerlink" href="#option-2-start-fresh-from-step-04" title="Permanent link"></a></h2>
<p>Navigate to the complete <code>section-2/step-04/multi-agent-system</code> directory:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">cd</span><span class="w"> </span>section-2/step-04/multi-agent-system
</code></pre></div>
<hr>
<h2 id="part-1-build-the-client-side-components">Part 1: Build the Client-Side Components<a class="headerlink" href="#part-1-build-the-client-side-components" title="Permanent link"></a></h2>
<h3 id="step-1-create-the-dispositionfeedbackagent">Step 1: Create the DispositionFeedbackAgent<a class="headerlink" href="#step-1-create-the-dispositionfeedbackagent" title="Permanent link"></a></h3>
<p>This agent analyzes feedback to determine if a car should be disposed.</p>
<p>In <code>src/main/java/com/carmanagement/agentic/agents</code>, create <code>DispositionFeedbackAgent.java</code>:</p>
<div class="highlight"><span class="filename">DispositionFeedbackAgent.java</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents</span><span class="p">;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.service.SystemMessage</span><span class="p">;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.service.UserMessage</span><span class="p">;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.Agent</span><span class="p">;</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="cm">/**</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="cm"> * Agent that analyzes feedback to determine if a car should be disposed of.</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="cm"> */</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">DispositionFeedbackAgent</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">    </span><span class="nd">@SystemMessage</span><span class="p">(</span><span class="s">"""</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="s">        You are a car disposition analyzer for a car rental company. Your job is to determine if a car should be disposed of based on feedback.</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="s">        Analyze the maintenance feedback and car information to decide if the car should be scrapped, sold, or donated.</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="s">        If the car is in decent shape, respond with "DISPOSITION_NOT_REQUIRED".</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="s">        Include the reason for your choice but keep your response short.</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="s">        """</span><span class="p">)</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">    </span><span class="nd">@UserMessage</span><span class="p">(</span><span class="s">"""</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="s">        Car Information:</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="s">        Make: {carMake}</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="s">        Model: {carModel}</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="s">        Year: {carYear}</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="s">        Previous Condition: {carCondition}</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a><span class="s">        Feedback:</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="s">        Rental Feedback: {rentalFeedback}</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="s">        Car Wash Feedback: {carWashFeedback}</span>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="s">        Maintenance Feedback: {maintenanceFeedback}</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="s">        """</span><span class="p">)</span>
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a><span class="w">    </span><span class="nd">@Agent</span><span class="p">(</span><span class="n">outputName</span><span class="o">=</span><span class="s">"dispositionRequest"</span><span class="p">,</span><span class="w"> </span><span class="n">description</span><span class="o">=</span><span class="s">"Car disposition analyzer. Using feedback, determines if a car should be disposed of."</span><span class="p">)</span>
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">analyzeForDisposition</span><span class="p">(</span>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">rentalFeedback</span><span class="p">,</span>
<a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carWashFeedback</span><span class="p">,</span>
<a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceFeedback</span><span class="p">);</span>
<a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key Points:</strong></p>
<ul>
<li><strong>System message</strong>: Focuses on economic viability (is the car worth repairing?)</li>
<li><strong>Specific output format</strong>: Returns <code>"DISPOSITION_NOT_REQUIRED"</code> when the car is repairable</li>
<li><strong>outputName</strong>: <code>"dispositionRequest"</code> (stores the analysis in AgenticScope’s state)</li>
<li><strong>Three feedback sources</strong>: Analyzes rental, car wash, and maintenance feedback</li>
</ul>
<p><strong>Decision Criteria:</strong></p>
<p>The agent considers:
- Severity of damage (structural, engine, transmission)
- Repair costs vs. car value
- Age and condition of the vehicle
- Safety concerns</p>
<h3 id="step-2-create-the-dispositionagent-client">Step 2: Create the DispositionAgent (Client)<a class="headerlink" href="#step-2-create-the-dispositionagent-client" title="Permanent link"></a></h3>
<p>This is where the A2A magic happens! 
This agent connects to the remote disposition agent.</p>
<p>In <code>src/main/java/com/carmanagement/agentic/agents</code>, create <code>DispositionAgent.java</code>:</p>
<div class="highlight"><span class="filename">DispositionAgent.java</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents</span><span class="p">;</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.A2AClientAgent</span><span class="p">;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="cm">/**</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="cm"> * Agent that determines how to dispose of a car.</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="cm"> */</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">DispositionAgent</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">    </span><span class="nd">@A2AClientAgent</span><span class="p">(</span><span class="n">a2aServerUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"http://localhost:8888"</span><span class="p">,</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">            </span><span class="n">outputName</span><span class="o">=</span><span class="s">"dispositionAgentResult"</span><span class="p">,</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">            </span><span class="n">description</span><span class="o">=</span><span class="s">"Car disposition specialist. Determines how to dispose of a car."</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">    </span><span class="p">)</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">processDisposition</span><span class="p">(</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">);</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Let’s break it down:</strong></p>
<h4 id="a2aclientagent-annotation"><code>@A2AClientAgent</code> Annotation<a class="headerlink" href="#a2aclientagent-annotation" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nd">@A2AClientAgent</span><span class="p">(</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="n">a2aServerUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"http://localhost:8888"</span><span class="p">,</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"dispositionAgentResult"</span><span class="p">,</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Car disposition specialist. Recommends how to dispose of a car (scrap, sell, donate)."</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="p">)</span>
</code></pre></div>
<p>This annotation transforms the method into an <strong>A2A client</strong>:</p>
<ul>
<li><strong><code>a2aServerUrl</code></strong>: The URL of the remote A2A server</li>
<li><strong><code>outputName</code></strong>: Where to store the result in AgenticScope’s state</li>
<li><strong><code>description</code></strong>: Describes the agent’s purpose (helps with agent discovery)</li>
</ul>
<h4 id="the-method-signature">The Method Signature<a class="headerlink" href="#the-method-signature" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">String</span><span class="w"> </span><span class="nf">processDisposition</span><span class="p">(</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="p">)</span>
</code></pre></div>
<p>These parameters are sent to the remote agent as task inputs. 
The remote agent can access them by name.</p>
<h4 id="how-it-works">How It Works<a class="headerlink" href="#how-it-works" title="Permanent link"></a></h4>
<ol>
<li>When this method is called, Quarkus LangChain4j:</li>
<li>Creates an A2A Task with the method parameters as inputs</li>
<li>Sends the task to the remote server via JSON-RPC</li>
<li>Waits for the remote agent to complete the task</li>
<li>
<p>Returns the result as a String</p>
</li>
<li>
<p>No manual HTTP requests needed</p>
</li>
<li>Type-safe: compile-time checking of parameters</li>
<li>Automatic error handling and retries</li>
</ol>
<hr>
<h2 id="part-2-update-the-workflows">Part 2: Update the Workflows<a class="headerlink" href="#part-2-update-the-workflows" title="Permanent link"></a></h2>
<h3 id="step-3-update-feedbackworkflow">Step 3: Update FeedbackWorkflow<a class="headerlink" href="#step-3-update-feedbackworkflow" title="Permanent link"></a></h3>
<p>The <code>FeedbackWorkflow</code> needs to include the new disposition analysis.</p>
<p>Update <code>src/main/java/com/carmanagement/agentic/workflow/FeedbackWorkflow.java</code>:</p>
<div class="highlight"><span class="filename">FeedbackWorkflow.java</span><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.workflow</span><span class="p">;</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.CarWashFeedbackAgent</span><span class="p">;</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.DispositionFeedbackAgent</span><span class="p">;</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.MaintenanceFeedbackAgent</span><span class="p">;</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.Agent</span><span class="p">;</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.ParallelAgent</span><span class="p">;</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.SubAgent</span><span class="p">;</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="cm">/**</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="cm"> * Workflow for processing car feedback in parallel.</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="cm"> */</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">FeedbackWorkflow</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">    </span><span class="cm">/**</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="cm">     * Runs multiple feedback agents in parallel to analyze different aspects of car feedback.</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="cm">     */</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">    </span><span class="nd">@Agent</span><span class="p">(</span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"feedbackResult"</span><span class="p">)</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">    </span><span class="nd">@ParallelAgent</span><span class="p">(</span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"feedbackResult"</span><span class="p">,</span><span class="w"> </span><span class="n">subAgents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">            </span><span class="nd">@SubAgent</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarWashFeedbackAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"carWashRequest"</span><span class="p">),</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">            </span><span class="nd">@SubAgent</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaintenanceFeedbackAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"maintenanceRequest"</span><span class="p">),</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="w">            </span><span class="nd">@SubAgent</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DispositionFeedbackAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"dispositionRequest"</span><span class="p">)</span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">analyzeFeedback</span><span class="p">(</span>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">rentalFeedback</span><span class="p">,</span>
<a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carWashFeedback</span><span class="p">,</span>
<a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceFeedback</span><span class="p">);</span>
<a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key changes:</strong></p>
<p>Added <code>DispositionFeedbackAgent</code> to the parallel workflow:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nd">@SubAgent</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DispositionFeedbackAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"dispositionRequest"</span><span class="p">)</span>
</code></pre></div>
<p>Now <strong>three agents run concurrently</strong>:
- <code>CarWashFeedbackAgent</code> — analyzes cleaning needs
- <code>MaintenanceFeedbackAgent</code> — analyzes maintenance needs
- <code>DispositionFeedbackAgent</code> — analyzes disposal needs</p>
<p>This parallel execution is efficient: all three analyses happen at the same time!</p>
<h3 id="step-4-update-actionworkflow">Step 4: Update ActionWorkflow<a class="headerlink" href="#step-4-update-actionworkflow" title="Permanent link"></a></h3>
<p>The <code>ActionWorkflow</code> needs to handle disposition requests.</p>
<p>Update <code>src/main/java/com/carmanagement/agentic/workflow/ActionWorkflow.java</code>:</p>
<div class="highlight"><span class="filename">ActionWorkflow.java</span><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.workflow</span><span class="p">;</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.CarWashAgent</span><span class="p">;</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.DispositionAgent</span><span class="p">;</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.MaintenanceAgent</span><span class="p">;</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.ActivationCondition</span><span class="p">;</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.ConditionalAgent</span><span class="p">;</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.SubAgent</span><span class="p">;</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="cm">/**</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="cm"> * Workflow for processing car actions conditionally.</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="cm"> */</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ActionWorkflow</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">    </span><span class="cm">/**</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="cm">     * Runs the appropriate action agent based on the feedback analysis.</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="cm">     */</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">    </span><span class="nd">@ConditionalAgent</span><span class="p">(</span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"actionResult"</span><span class="p">,</span><span class="w"> </span><span class="n">subAgents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">            </span><span class="nd">@SubAgent</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaintenanceAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"actionResult"</span><span class="p">),</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">            </span><span class="nd">@SubAgent</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarWashAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"actionResult"</span><span class="p">),</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">            </span><span class="nd">@SubAgent</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DispositionAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"actionResult"</span><span class="p">)</span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">processAction</span><span class="p">(</span>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carWashRequest</span><span class="p">,</span>
<a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceRequest</span><span class="p">,</span>
<a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">);</span>
<a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a>
<a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="w">    </span><span class="nd">@ActivationCondition</span><span class="p">(</span><span class="n">MaintenanceAgent</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">activateMaintenance</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">isRequired</span><span class="p">(</span><span class="n">maintenanceRequest</span><span class="p">);</span>
<a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a>
<a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a><span class="w">    </span><span class="nd">@ActivationCondition</span><span class="p">(</span><span class="n">CarWashAgent</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">activateCarWash</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">carWashRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">isRequired</span><span class="p">(</span><span class="n">carWashRequest</span><span class="p">);</span>
<a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a>
<a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="w">    </span><span class="nd">@ActivationCondition</span><span class="p">(</span><span class="n">DispositionAgent</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">activateDisposition</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">isRequired</span><span class="p">(</span><span class="n">dispositionRequest</span><span class="p">);</span>
<a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a>
<a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isRequired</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">value</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">value</span><span class="p">.</span><span class="na">toUpperCase</span><span class="p">().</span><span class="na">contains</span><span class="p">(</span><span class="s">"NOT_REQUIRED"</span><span class="p">);</span>
<a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key changes:</strong></p>
<h4 id="added-dispositionagent-to-subagents">Added DispositionAgent to SubAgents<a class="headerlink" href="#added-dispositionagent-to-subagents" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nd">@SubAgent</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DispositionAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"actionResult"</span><span class="p">)</span>
</code></pre></div>
<h4 id="added-activation-condition">Added Activation Condition<a class="headerlink" href="#added-activation-condition" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nd">@ActivationCondition</span><span class="p">(</span><span class="n">DispositionAgent</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">activateDisposition</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">isRequired</span><span class="p">(</span><span class="n">dispositionRequest</span><span class="p">);</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="p">}</span>
</code></pre></div>
<h4 id="updated-execution-priority">Updated Execution Priority<a class="headerlink" href="#updated-execution-priority" title="Permanent link"></a></h4>
<p>The conditional workflow now has <strong>priority ordering</strong>:</p>
<ol>
<li><strong>Disposition</strong> (highest priority) — if disposal is needed</li>
<li><strong>Maintenance</strong> — if maintenance is needed and disposal isn’t</li>
<li><strong>Car Wash</strong> — if washing is needed and neither disposal nor maintenance is</li>
<li><strong>Skip</strong> — if nothing is needed</li>
</ol>
<p>This ensures critical issues (disposal) are handled before routine tasks (washing).</p>
<h3 id="step-5-update-carconditionfeedbackagent">Step 5: Update CarConditionFeedbackAgent<a class="headerlink" href="#step-5-update-carconditionfeedbackagent" title="Permanent link"></a></h3>
<p>The <code>CarConditionFeedbackAgent</code> should consider disposition feedback.</p>
<p>Update <code>src/main/java/com/carmanagement/agentic/agents/CarConditionFeedbackAgent.java</code>:</p>
<div class="highlight"><span class="filename">CarConditionFeedbackAgent.java</span><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents</span><span class="p">;</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.Agent</span><span class="p">;</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.service.SystemMessage</span><span class="p">;</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.service.UserMessage</span><span class="p">;</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="cm">/**</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="cm"> * Agent that analyzes feedback to update the car condition.</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="cm"> */</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">CarConditionFeedbackAgent</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">    </span><span class="nd">@SystemMessage</span><span class="p">(</span><span class="s">"""       </span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="s">        You are a car condition analyzer for a car rental company. Your job is to determine the current condition of a car based on feedback.</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="s">        Analyze all feedback and the previous car condition to provide an updated condition description.</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="s">        Always provide a concise condition description, even if there's minimal feedback.</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="s">        Do not add any headers or prefixes to your response.</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="s">        """</span><span class="p">)</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="w">    </span><span class="c1">// --8&lt;-- [start:carConditionFeedbackSnippet]</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="w">    </span><span class="nd">@UserMessage</span><span class="p">(</span><span class="s">"""</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="s">            Car Information:</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="s">            Make: {carMake}</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="s">            Model: {carModel}</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="s">            Year: {carYear}</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="s">            Previous Condition: {carCondition}</span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="s">            Feedback from other agents:</span>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="s">            Car Wash Recommendation: {carWashRequest}</span>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="s">            Maintenance Recommendation: {maintenanceRequest}</span>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="s">            """</span><span class="p">)</span>
<a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="w">    </span><span class="nd">@Agent</span><span class="p">(</span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Car condition analyzer. Determines the current condition of a car based on feedback."</span><span class="p">,</span>
<a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="w">            </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"carCondition"</span><span class="p">)</span>
<a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">analyzeForCondition</span><span class="p">(</span>
<a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carWashRequest</span><span class="p">,</span>
<a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceRequest</span><span class="p">);</span>
<a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a><span class="w">    </span><span class="c1">// --8&lt;-- [end:carConditionFeedbackSnippet]</span>
<a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key changes:</strong></p>
<p>Now takes <code>dispositionRequest</code> as input to provide more comprehensive condition assessments.</p>
<h3 id="step-6-update-carprocessingworkflow">Step 6: Update CarProcessingWorkflow<a class="headerlink" href="#step-6-update-carprocessingworkflow" title="Permanent link"></a></h3>
<p>Update the output method to handle disposition:</p>
<p>Update <code>src/main/java/com/carmanagement/agentic/workflow/CarProcessingWorkflow.java</code>:</p>
<div class="highlight"><span class="filename">CarProcessingWorkflow.java</span><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.workflow</span><span class="p">;</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.CarConditionFeedbackAgent</span><span class="p">;</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.model.CarConditions</span><span class="p">;</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.model.RequiredAction</span><span class="p">;</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.Output</span><span class="p">;</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.SequenceAgent</span><span class="p">;</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.SubAgent</span><span class="p">;</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="cm">/**</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="cm"> * Workflow for processing car returns using a sequence of agents.</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="cm"> */</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">CarProcessingWorkflow</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="w">    </span><span class="cm">/**</span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="cm">     * Processes a car return by running feedback analysis and then appropriate actions.</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="cm">     */</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="w">    </span><span class="nd">@SequenceAgent</span><span class="p">(</span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"carProcessingAgentResult"</span><span class="p">,</span><span class="w"> </span><span class="n">subAgents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="w">            </span><span class="nd">@SubAgent</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FeedbackWorkflow</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"carProcessingAgentResult"</span><span class="p">),</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="w">            </span><span class="nd">@SubAgent</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ActionWorkflow</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"carProcessingAgentResult"</span><span class="p">),</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="w">            </span><span class="nd">@SubAgent</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarConditionFeedbackAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">outputName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"carProcessingAgentResult"</span><span class="p">)</span>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="w">    </span><span class="n">CarConditions</span><span class="w"> </span><span class="nf">processCarReturn</span><span class="p">(</span>
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">rentalFeedback</span><span class="p">,</span>
<a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carWashFeedback</span><span class="p">,</span>
<a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceFeedback</span><span class="p">);</span>
<a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a>
<a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a><span class="w">    </span><span class="nd">@Output</span>
<a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">CarConditions</span><span class="w"> </span><span class="nf">output</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceRequest</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">carWashRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a><span class="w">        </span><span class="n">RequiredAction</span><span class="w"> </span><span class="n">requiredAction</span><span class="p">;</span>
<a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a><span class="w">        </span><span class="c1">// Check maintenance first (higher priority)</span>
<a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRequired</span><span class="p">(</span><span class="n">dispositionRequest</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a><span class="w">            </span><span class="n">requiredAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RequiredAction</span><span class="p">.</span><span class="na">DISPOSITION</span><span class="p">;</span>
<a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRequired</span><span class="p">(</span><span class="n">maintenanceRequest</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a><span class="w">            </span><span class="n">requiredAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RequiredAction</span><span class="p">.</span><span class="na">MAINTENANCE</span><span class="p">;</span>
<a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRequired</span><span class="p">(</span><span class="n">carWashRequest</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-42" name="__codelineno-14-42" href="#__codelineno-14-42"></a><span class="w">            </span><span class="n">requiredAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RequiredAction</span><span class="p">.</span><span class="na">CAR_WASH</span><span class="p">;</span>
<a id="__codelineno-14-43" name="__codelineno-14-43" href="#__codelineno-14-43"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-44" name="__codelineno-14-44" href="#__codelineno-14-44"></a><span class="w">            </span><span class="n">requiredAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RequiredAction</span><span class="p">.</span><span class="na">NONE</span><span class="p">;</span>
<a id="__codelineno-14-45" name="__codelineno-14-45" href="#__codelineno-14-45"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-14-46" name="__codelineno-14-46" href="#__codelineno-14-46"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CarConditions</span><span class="p">(</span><span class="n">carCondition</span><span class="p">,</span><span class="w"> </span><span class="n">requiredAction</span><span class="p">);</span>
<a id="__codelineno-14-47" name="__codelineno-14-47" href="#__codelineno-14-47"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-14-48" name="__codelineno-14-48" href="#__codelineno-14-48"></a>
<a id="__codelineno-14-49" name="__codelineno-14-49" href="#__codelineno-14-49"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isRequired</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-50" name="__codelineno-14-50" href="#__codelineno-14-50"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">value</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">value</span><span class="p">.</span><span class="na">toUpperCase</span><span class="p">().</span><span class="na">contains</span><span class="p">(</span><span class="s">"NOT_REQUIRED"</span><span class="p">);</span>
<a id="__codelineno-14-51" name="__codelineno-14-51" href="#__codelineno-14-51"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-14-52" name="__codelineno-14-52" href="#__codelineno-14-52"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key changes:</strong></p>
<p>The <code>@Output</code> method now checks for disposition requests first:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="w"> </span><span class="nd">@Output</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="kd">static</span><span class="w"> </span><span class="n">CarConditions</span><span class="w"> </span><span class="nf">output</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceRequest</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">carWashRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">    </span><span class="n">RequiredAction</span><span class="w"> </span><span class="n">requiredAction</span><span class="p">;</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span><span class="c1">// Check maintenance first (higher priority)</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRequired</span><span class="p">(</span><span class="n">dispositionRequest</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">              </span><span class="c1">// Highest priority</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">        </span><span class="n">requiredAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RequiredAction</span><span class="p">.</span><span class="na">DISPOSITION</span><span class="p">;</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRequired</span><span class="p">(</span><span class="n">maintenanceRequest</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">        </span><span class="n">requiredAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RequiredAction</span><span class="p">.</span><span class="na">MAINTENANCE</span><span class="p">;</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRequired</span><span class="p">(</span><span class="n">carWashRequest</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">        </span><span class="n">requiredAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RequiredAction</span><span class="p">.</span><span class="na">CAR_WASH</span><span class="p">;</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">        </span><span class="n">requiredAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RequiredAction</span><span class="p">.</span><span class="na">NONE</span><span class="p">;</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CarConditions</span><span class="p">(</span><span class="n">carCondition</span><span class="p">,</span><span class="w"> </span><span class="n">requiredAction</span><span class="p">);</span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="p">}</span>
</code></pre></div>
<p>Disposition has the highest priority in the result.</p>
<h3 id="step-7-update-requiredaction-enum">Step 7: Update RequiredAction Enum<a class="headerlink" href="#step-7-update-requiredaction-enum" title="Permanent link"></a></h3>
<p>Update the <code>RequiredAction</code> enum to include disposition:</p>
<p>Update <code>src/main/java/com/carmanagement/model/RequiredAction.java</code>:</p>
<div class="highlight"><span class="filename">RequiredAction.java</span><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.model</span><span class="p">;</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">RequiredAction</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span><span class="n">NONE</span><span class="p">,</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">    </span><span class="n">CAR_WASH</span><span class="p">,</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">    </span><span class="n">MAINTENANCE</span><span class="p">,</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">    </span><span class="n">DISPOSITION</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="p">}</span>
</code></pre></div>
<h3 id="step-8-update-carmanagementservice">Step 8: Update CarManagementService<a class="headerlink" href="#step-8-update-carmanagementservice" title="Permanent link"></a></h3>
<p>Update the service to handle disposition status:</p>
<p>Update <code>src/main/java/com/carmanagement/service/CarManagementService.java</code>:</p>
<div class="highlight"><span class="filename">CarManagementService.java</span><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.service</span><span class="p">;</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.workflow.CarProcessingWorkflow</span><span class="p">;</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.model.CarConditions</span><span class="p">;</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.model.CarInfo</span><span class="p">;</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.model.CarStatus</span><span class="p">;</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.model.RequiredAction</span><span class="p">;</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.enterprise.context.ApplicationScoped</span><span class="p">;</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.inject.Inject</span><span class="p">;</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.transaction.Transactional</span><span class="p">;</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="cm">/**</span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="cm"> * Service for managing car returns from various operations.</span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="cm"> */</span>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="nd">@ApplicationScoped</span>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CarManagementService</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a><span class="w">    </span><span class="nd">@Inject</span>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a><span class="w">    </span><span class="n">CarProcessingWorkflow</span><span class="w"> </span><span class="n">carProcessingWorkflow</span><span class="p">;</span>
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a><span class="w">    </span><span class="cm">/**</span>
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a><span class="cm">     * Process a car return from any operation.</span>
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a><span class="cm">     *</span>
<a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a><span class="cm">     * @param carNumber The car number</span>
<a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a><span class="cm">     * @param rentalFeedback Optional rental feedback</span>
<a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a><span class="cm">     * @param carWashFeedback Optional car wash feedback</span>
<a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a><span class="cm">     * @param maintenanceFeedback Optional maintenance feedback</span>
<a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a><span class="cm">     * @return Result of the processing</span>
<a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a><span class="cm">     */</span>
<a id="__codelineno-17-30" name="__codelineno-17-30" href="#__codelineno-17-30"></a><span class="w">    </span><span class="nd">@Transactional</span>
<a id="__codelineno-17-31" name="__codelineno-17-31" href="#__codelineno-17-31"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">processCarReturn</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">rentalFeedback</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">carWashFeedback</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceFeedback</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-32" name="__codelineno-17-32" href="#__codelineno-17-32"></a><span class="w">        </span><span class="n">CarInfo</span><span class="w"> </span><span class="n">carInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarInfo</span><span class="p">.</span><span class="na">findById</span><span class="p">(</span><span class="n">carNumber</span><span class="p">);</span>
<a id="__codelineno-17-33" name="__codelineno-17-33" href="#__codelineno-17-33"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">carInfo</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-34" name="__codelineno-17-34" href="#__codelineno-17-34"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">"Car not found with number: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">carNumber</span><span class="p">;</span>
<a id="__codelineno-17-35" name="__codelineno-17-35" href="#__codelineno-17-35"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-17-36" name="__codelineno-17-36" href="#__codelineno-17-36"></a>
<a id="__codelineno-17-37" name="__codelineno-17-37" href="#__codelineno-17-37"></a><span class="w">        </span><span class="c1">// Process the car return using the workflow and get the AgenticScope</span>
<a id="__codelineno-17-38" name="__codelineno-17-38" href="#__codelineno-17-38"></a><span class="w">        </span><span class="n">CarConditions</span><span class="w"> </span><span class="n">carConditions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">carProcessingWorkflow</span><span class="p">.</span><span class="na">processCarReturn</span><span class="p">(</span>
<a id="__codelineno-17-39" name="__codelineno-17-39" href="#__codelineno-17-39"></a><span class="w">                </span><span class="n">carInfo</span><span class="p">.</span><span class="na">make</span><span class="p">,</span>
<a id="__codelineno-17-40" name="__codelineno-17-40" href="#__codelineno-17-40"></a><span class="w">                </span><span class="n">carInfo</span><span class="p">.</span><span class="na">model</span><span class="p">,</span>
<a id="__codelineno-17-41" name="__codelineno-17-41" href="#__codelineno-17-41"></a><span class="w">                </span><span class="n">carInfo</span><span class="p">.</span><span class="na">year</span><span class="p">,</span>
<a id="__codelineno-17-42" name="__codelineno-17-42" href="#__codelineno-17-42"></a><span class="w">                </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-17-43" name="__codelineno-17-43" href="#__codelineno-17-43"></a><span class="w">                </span><span class="n">carInfo</span><span class="p">.</span><span class="na">condition</span><span class="p">,</span>
<a id="__codelineno-17-44" name="__codelineno-17-44" href="#__codelineno-17-44"></a><span class="w">                </span><span class="n">rentalFeedback</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">rentalFeedback</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">""</span><span class="p">,</span>
<a id="__codelineno-17-45" name="__codelineno-17-45" href="#__codelineno-17-45"></a><span class="w">                </span><span class="n">carWashFeedback</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">carWashFeedback</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">""</span><span class="p">,</span>
<a id="__codelineno-17-46" name="__codelineno-17-46" href="#__codelineno-17-46"></a><span class="w">                </span><span class="n">maintenanceFeedback</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">maintenanceFeedback</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">""</span><span class="p">);</span>
<a id="__codelineno-17-47" name="__codelineno-17-47" href="#__codelineno-17-47"></a>
<a id="__codelineno-17-48" name="__codelineno-17-48" href="#__codelineno-17-48"></a><span class="w">        </span><span class="c1">// Update the car's condition with the result from CarConditionFeedbackAgent</span>
<a id="__codelineno-17-49" name="__codelineno-17-49" href="#__codelineno-17-49"></a><span class="w">        </span><span class="n">carInfo</span><span class="p">.</span><span class="na">condition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">carConditions</span><span class="p">.</span><span class="na">generalCondition</span><span class="p">();</span>
<a id="__codelineno-17-50" name="__codelineno-17-50" href="#__codelineno-17-50"></a>
<a id="__codelineno-17-51" name="__codelineno-17-51" href="#__codelineno-17-51"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">carConditions</span><span class="p">.</span><span class="na">requiredAction</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">RequiredAction</span><span class="p">.</span><span class="na">NONE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-52" name="__codelineno-17-52" href="#__codelineno-17-52"></a><span class="w">            </span><span class="n">carInfo</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarStatus</span><span class="p">.</span><span class="na">AVAILABLE</span><span class="p">;</span>
<a id="__codelineno-17-53" name="__codelineno-17-53" href="#__codelineno-17-53"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">carConditions</span><span class="p">.</span><span class="na">requiredAction</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">RequiredAction</span><span class="p">.</span><span class="na">DISPOSITION</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-54" name="__codelineno-17-54" href="#__codelineno-17-54"></a><span class="w">            </span><span class="n">carInfo</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarStatus</span><span class="p">.</span><span class="na">PENDING_DISPOSITION</span><span class="p">;</span>
<a id="__codelineno-17-55" name="__codelineno-17-55" href="#__codelineno-17-55"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-17-56" name="__codelineno-17-56" href="#__codelineno-17-56"></a>
<a id="__codelineno-17-57" name="__codelineno-17-57" href="#__codelineno-17-57"></a><span class="w">        </span><span class="c1">// Persist the changes to the database</span>
<a id="__codelineno-17-58" name="__codelineno-17-58" href="#__codelineno-17-58"></a><span class="w">        </span><span class="n">carInfo</span><span class="p">.</span><span class="na">persist</span><span class="p">();</span>
<a id="__codelineno-17-59" name="__codelineno-17-59" href="#__codelineno-17-59"></a>
<a id="__codelineno-17-60" name="__codelineno-17-60" href="#__codelineno-17-60"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">carConditions</span><span class="p">.</span><span class="na">generalCondition</span><span class="p">();</span>
<a id="__codelineno-17-61" name="__codelineno-17-61" href="#__codelineno-17-61"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-17-62" name="__codelineno-17-62" href="#__codelineno-17-62"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key changes:</strong></p>
<p>Added handling for <code>RequiredAction.DISPOSITION</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">case</span><span class="w"> </span><span class="n">DISPOSITION</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">carInfo</span><span class="p">.</span><span class="na">setStatus</span><span class="p">(</span><span class="n">CarStatus</span><span class="p">.</span><span class="na">DISPOSED</span><span class="p">);</span>
</code></pre></div>
<p>When disposition is required, the car is marked as disposed and removed from the active fleet.</p>
<hr>
<h2 id="part-3-build-the-remote-a2a-server">Part 3: Build the Remote A2A Server<a class="headerlink" href="#part-3-build-the-remote-a2a-server" title="Permanent link"></a></h2>
<p>Now let’s build the remote disposition service that will handle A2A requests.</p>
<p>Navigate to the remote-a2a-agent directory:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nb">cd</span><span class="w"> </span>section-2/step-04/remote-a2a-agent
</code></pre></div>
<h3 id="step-9-create-the-dispositiontool">Step 9: Create the DispositionTool<a class="headerlink" href="#step-9-create-the-dispositiontool" title="Permanent link"></a></h3>
<p>The tool that executes disposition actions (scrap, sell, donate).</p>
<p>In <code>src/main/java/com/demo</code>, create <code>DispositionTool.java</code>:</p>
<div class="highlight"><span class="filename">DispositionTool.java</span><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.demo</span><span class="p">;</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agent.tool.Tool</span><span class="p">;</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.inject.Singleton</span><span class="p">;</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="cm">/**</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="cm"> * Tool for requesting car disposition operations.</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="cm"> * This tool is used by the LLM to determine the appropriate disposition for a car.</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="cm"> */</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="nd">@Singleton</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DispositionTool</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="w">    </span><span class="cm">/**</span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="cm">     * Enum representing the possible disposition options for a car.</span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="cm">     */</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">DispositionOption</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="w">        </span><span class="n">SCRAP</span><span class="p">(</span><span class="s">"Scrap the car"</span><span class="p">),</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="w">        </span><span class="n">SELL</span><span class="p">(</span><span class="s">"Sell the car"</span><span class="p">),</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="w">        </span><span class="n">DONATE</span><span class="p">(</span><span class="s">"Donate the car"</span><span class="p">);</span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="w">        </span><span class="n">DispositionOption</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">description</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a>
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a><span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getDescription</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>
<a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a>
<a id="__codelineno-20-33" name="__codelineno-20-33" href="#__codelineno-20-33"></a><span class="w">    </span><span class="cm">/**</span>
<a id="__codelineno-20-34" name="__codelineno-20-34" href="#__codelineno-20-34"></a><span class="cm">     * Requests disposition for a car based on the provided parameters.</span>
<a id="__codelineno-20-35" name="__codelineno-20-35" href="#__codelineno-20-35"></a><span class="cm">     *</span>
<a id="__codelineno-20-36" name="__codelineno-20-36" href="#__codelineno-20-36"></a><span class="cm">     * @param carNumber The car number</span>
<a id="__codelineno-20-37" name="__codelineno-20-37" href="#__codelineno-20-37"></a><span class="cm">     * @param carMake The car make</span>
<a id="__codelineno-20-38" name="__codelineno-20-38" href="#__codelineno-20-38"></a><span class="cm">     * @param carModel The car model</span>
<a id="__codelineno-20-39" name="__codelineno-20-39" href="#__codelineno-20-39"></a><span class="cm">     * @param carYear The car year</span>
<a id="__codelineno-20-40" name="__codelineno-20-40" href="#__codelineno-20-40"></a><span class="cm">     * @param dispositionOption The disposition option (SCRAP, SELL, or DONATE)</span>
<a id="__codelineno-20-41" name="__codelineno-20-41" href="#__codelineno-20-41"></a><span class="cm">     * @param carCondition The condition of the car</span>
<a id="__codelineno-20-42" name="__codelineno-20-42" href="#__codelineno-20-42"></a><span class="cm">     * @return A summary of the disposition request</span>
<a id="__codelineno-20-43" name="__codelineno-20-43" href="#__codelineno-20-43"></a><span class="cm">     */</span>
<a id="__codelineno-20-44" name="__codelineno-20-44" href="#__codelineno-20-44"></a><span class="w">    </span><span class="nd">@Tool</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"DispositionTool"</span><span class="p">)</span>
<a id="__codelineno-20-45" name="__codelineno-20-45" href="#__codelineno-20-45"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">requestDisposition</span><span class="p">(</span>
<a id="__codelineno-20-46" name="__codelineno-20-46" href="#__codelineno-20-46"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-20-47" name="__codelineno-20-47" href="#__codelineno-20-47"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-20-48" name="__codelineno-20-48" href="#__codelineno-20-48"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-20-49" name="__codelineno-20-49" href="#__codelineno-20-49"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-20-50" name="__codelineno-20-50" href="#__codelineno-20-50"></a><span class="w">            </span><span class="n">DispositionOption</span><span class="w"> </span><span class="n">dispositionOption</span><span class="p">,</span>
<a id="__codelineno-20-51" name="__codelineno-20-51" href="#__codelineno-20-51"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-52" name="__codelineno-20-52" href="#__codelineno-20-52"></a>
<a id="__codelineno-20-53" name="__codelineno-20-53" href="#__codelineno-20-53"></a><span class="w">        </span><span class="c1">// In a real implementation, this would make an API call to a disposition service</span>
<a id="__codelineno-20-54" name="__codelineno-20-54" href="#__codelineno-20-54"></a><span class="w">        </span><span class="c1">// or update a database with the disposition request</span>
<a id="__codelineno-20-55" name="__codelineno-20-55" href="#__codelineno-20-55"></a>
<a id="__codelineno-20-56" name="__codelineno-20-56" href="#__codelineno-20-56"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Car disposition requested for "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">carMake</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">" "</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-20-57" name="__codelineno-20-57" href="#__codelineno-20-57"></a><span class="w">                </span><span class="n">carModel</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">" ("</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">carYear</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"), Car #"</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-20-58" name="__codelineno-20-58" href="#__codelineno-20-58"></a><span class="w">                </span><span class="n">carNumber</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">": "</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-20-59" name="__codelineno-20-59" href="#__codelineno-20-59"></a><span class="w">                </span><span class="n">dispositionOption</span><span class="p">.</span><span class="na">getDescription</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-20-60" name="__codelineno-20-60" href="#__codelineno-20-60"></a><span class="w">                </span><span class="s">"\n"</span><span class="p">;</span>
<a id="__codelineno-20-61" name="__codelineno-20-61" href="#__codelineno-20-61"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"⛍ DispositionTool result: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
<a id="__codelineno-20-62" name="__codelineno-20-62" href="#__codelineno-20-62"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<a id="__codelineno-20-63" name="__codelineno-20-63" href="#__codelineno-20-63"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-20-64" name="__codelineno-20-64" href="#__codelineno-20-64"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key Points:</strong></p>
<ul>
<li><strong>@Dependent scope</strong>: Required for tool detection</li>
<li><strong>Three methods</strong>: <code>scrapCar()</code>, <code>sellCar()</code>, <code>donateCar()</code></li>
<li><strong>@Tool annotation</strong>: Makes each method available to the AI agent</li>
<li><strong>Detailed descriptions</strong>: Help the AI agent choose the appropriate action</li>
</ul>
<h3 id="step-10-create-the-dispositionagent-ai-service">Step 10: Create the DispositionAgent (AI Service)<a class="headerlink" href="#step-10-create-the-dispositionagent-ai-service" title="Permanent link"></a></h3>
<p>The AI agent that actually makes disposition decisions.</p>
<p>In <code>src/main/java/com/demo</code>, create <code>DispositionAgent.java</code>:</p>
<div class="highlight"><span class="filename">DispositionAgent.java</span><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.demo</span><span class="p">;</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.service.SystemMessage</span><span class="p">;</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.service.UserMessage</span><span class="p">;</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.quarkiverse.langchain4j.RegisterAiService</span><span class="p">;</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.quarkiverse.langchain4j.ToolBox</span><span class="p">;</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.enterprise.context.ApplicationScoped</span><span class="p">;</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="cm">/**</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="cm"> * Agent that determines how to dispose of a car.</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="cm"> */</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="nd">@RegisterAiService</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="nd">@ApplicationScoped</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">DispositionAgent</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="w">    </span><span class="nd">@SystemMessage</span><span class="p">(</span><span class="s">"""</span>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="s">        /nothink, Reasoning: low.</span>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="s">        You handle intake for the car disposition department.</span>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="s">        It is your job to submit a request to the provided DispositionTool function to take action on the request (SCRAP, SELL, or DONATE).</span>
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="s">        Be specific about what disposition option is most appropriate based on the car's condition.</span>
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="s">        """</span><span class="p">)</span>
<a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a><span class="w">    </span><span class="nd">@UserMessage</span><span class="p">(</span><span class="s">"""</span>
<a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a><span class="s">        Car Information:</span>
<a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a><span class="s">        Make: {carMake}</span>
<a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a><span class="s">        Model: {carModel}</span>
<a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a><span class="s">        Year: {carYear}</span>
<a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a><span class="s">        Car Number: {carNumber}</span>
<a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a>
<a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a><span class="s">        Previous Car Condition:</span>
<a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a><span class="s">        {carCondition}</span>
<a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a>
<a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a><span class="s">        Disposition Request:</span>
<a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a><span class="s">        {dispositionRequest}</span>
<a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a><span class="s">        """</span><span class="p">)</span>
<a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a><span class="w">    </span><span class="nd">@ToolBox</span><span class="p">(</span><span class="n">DispositionTool</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">processDisposition</span><span class="p">(</span>
<a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-21-40" name="__codelineno-21-40" href="#__codelineno-21-40"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-21-41" name="__codelineno-21-41" href="#__codelineno-21-41"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-21-42" name="__codelineno-21-42" href="#__codelineno-21-42"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">);</span>
<a id="__codelineno-21-43" name="__codelineno-21-43" href="#__codelineno-21-43"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key Points:</strong></p>
<ul>
<li><strong><code>@RegisterAiService</code></strong>: Registers this as an AI service (not an agentic agent)</li>
<li><strong><code>@ToolBox(DispositionTool.class)</code></strong>: Has access to the DispositionTool</li>
<li><strong>System message</strong>: Defines the agent as a car disposition specialist</li>
<li><strong>Decision criteria</strong>: Considers condition, age, safety, and recommendation from the feedback agent</li>
</ul>
<div class="admonition note">
<p class="admonition-title">AI Service vs. Agentic Agent</p>
<p>Notice this is a <strong>traditional AI service</strong> (from Section 1), not an agentic workflow. 
The A2A server can expose both types.</p>
</div>
<h3 id="step-11-create-the-agentcard">Step 11: Create the AgentCard<a class="headerlink" href="#step-11-create-the-agentcard" title="Permanent link"></a></h3>
<p>The <strong>AgentCard</strong> describes the agent’s capabilities, skills, and interface.</p>
<p>In <code>src/main/java/com/demo</code>, create <code>DispositionAgentCard.java</code>:</p>
<div class="highlight"><span class="filename">DispositionAgentCard.java</span><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.demo</span><span class="p">;</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Collections</span><span class="p">;</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.AgentInterface</span><span class="p">;</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.TransportProtocol</span><span class="p">;</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.enterprise.context.ApplicationScoped</span><span class="p">;</span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.enterprise.inject.Produces</span><span class="p">;</span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.server.PublicAgentCard</span><span class="p">;</span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.AgentCapabilities</span><span class="p">;</span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.AgentCard</span><span class="p">;</span>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.AgentSkill</span><span class="p">;</span>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="nd">@ApplicationScoped</span>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DispositionAgentCard</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a>
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a><span class="w">    </span><span class="nd">@Produces</span>
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a><span class="w">    </span><span class="nd">@PublicAgentCard</span>
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">AgentCard</span><span class="w"> </span><span class="nf">agentCard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AgentCard</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span>
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a><span class="w">                </span><span class="p">.</span><span class="na">name</span><span class="p">(</span><span class="s">"Disposition Agent"</span><span class="p">)</span>
<a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a><span class="w">                </span><span class="p">.</span><span class="na">description</span><span class="p">(</span><span class="s">"Determines how a car should be disposed of based on the car condition and disposition request."</span><span class="p">)</span>
<a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a><span class="w">                </span><span class="p">.</span><span class="na">url</span><span class="p">(</span><span class="s">"http://localhost:8888/"</span><span class="p">)</span>
<a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a><span class="w">                </span><span class="p">.</span><span class="na">version</span><span class="p">(</span><span class="s">"1.0.0"</span><span class="p">)</span>
<a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a><span class="w">                </span><span class="p">.</span><span class="na">protocolVersion</span><span class="p">(</span><span class="s">"1.0.0"</span><span class="p">)</span>
<a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a><span class="w">                </span><span class="p">.</span><span class="na">capabilities</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AgentCapabilities</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span>
<a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a><span class="w">                        </span><span class="p">.</span><span class="na">streaming</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a><span class="w">                        </span><span class="p">.</span><span class="na">pushNotifications</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<a id="__codelineno-22-31" name="__codelineno-22-31" href="#__codelineno-22-31"></a><span class="w">                        </span><span class="p">.</span><span class="na">stateTransitionHistory</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<a id="__codelineno-22-32" name="__codelineno-22-32" href="#__codelineno-22-32"></a><span class="w">                        </span><span class="p">.</span><span class="na">build</span><span class="p">())</span>
<a id="__codelineno-22-33" name="__codelineno-22-33" href="#__codelineno-22-33"></a><span class="w">                </span><span class="p">.</span><span class="na">defaultInputModes</span><span class="p">(</span><span class="n">Collections</span><span class="p">.</span><span class="na">singletonList</span><span class="p">(</span><span class="s">"text"</span><span class="p">))</span>
<a id="__codelineno-22-34" name="__codelineno-22-34" href="#__codelineno-22-34"></a><span class="w">                </span><span class="p">.</span><span class="na">defaultOutputModes</span><span class="p">(</span><span class="n">Collections</span><span class="p">.</span><span class="na">singletonList</span><span class="p">(</span><span class="s">"text"</span><span class="p">))</span>
<a id="__codelineno-22-35" name="__codelineno-22-35" href="#__codelineno-22-35"></a><span class="w">                </span><span class="p">.</span><span class="na">skills</span><span class="p">(</span><span class="n">Collections</span><span class="p">.</span><span class="na">singletonList</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AgentSkill</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span>
<a id="__codelineno-22-36" name="__codelineno-22-36" href="#__codelineno-22-36"></a><span class="w">                                </span><span class="p">.</span><span class="na">id</span><span class="p">(</span><span class="s">"disposition"</span><span class="p">)</span>
<a id="__codelineno-22-37" name="__codelineno-22-37" href="#__codelineno-22-37"></a><span class="w">                                </span><span class="p">.</span><span class="na">name</span><span class="p">(</span><span class="s">"Car disposition"</span><span class="p">)</span>
<a id="__codelineno-22-38" name="__codelineno-22-38" href="#__codelineno-22-38"></a><span class="w">                                </span><span class="p">.</span><span class="na">description</span><span class="p">(</span><span class="s">"Makes a request to dispose of a car (SCRAP, SELL, or DONATE)"</span><span class="p">)</span>
<a id="__codelineno-22-39" name="__codelineno-22-39" href="#__codelineno-22-39"></a><span class="w">                                </span><span class="p">.</span><span class="na">tags</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"disposition"</span><span class="p">))</span>
<a id="__codelineno-22-40" name="__codelineno-22-40" href="#__codelineno-22-40"></a><span class="w">                                </span><span class="p">.</span><span class="na">build</span><span class="p">()))</span>
<a id="__codelineno-22-41" name="__codelineno-22-41" href="#__codelineno-22-41"></a><span class="w">                </span><span class="p">.</span><span class="na">preferredTransport</span><span class="p">(</span><span class="n">TransportProtocol</span><span class="p">.</span><span class="na">JSONRPC</span><span class="p">.</span><span class="na">asString</span><span class="p">())</span>
<a id="__codelineno-22-42" name="__codelineno-22-42" href="#__codelineno-22-42"></a><span class="w">                </span><span class="p">.</span><span class="na">additionalInterfaces</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<a id="__codelineno-22-43" name="__codelineno-22-43" href="#__codelineno-22-43"></a><span class="w">                        </span><span class="k">new</span><span class="w"> </span><span class="n">AgentInterface</span><span class="p">(</span><span class="n">TransportProtocol</span><span class="p">.</span><span class="na">JSONRPC</span><span class="p">.</span><span class="na">asString</span><span class="p">(),</span><span class="w"> </span><span class="s">"http://localhost:8888"</span><span class="p">)))</span>
<a id="__codelineno-22-44" name="__codelineno-22-44" href="#__codelineno-22-44"></a><span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<a id="__codelineno-22-45" name="__codelineno-22-45" href="#__codelineno-22-45"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-22-46" name="__codelineno-22-46" href="#__codelineno-22-46"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Let’s break it down:</strong></p>
<h4 id="publicagentcard-annotation"><code>@PublicAgentCard</code> Annotation<a class="headerlink" href="#publicagentcard-annotation" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="nd">@Produces</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="nd">@PublicAgentCard</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="kd">public</span><span class="w"> </span><span class="n">AgentCard</span><span class="w"> </span><span class="nf">agentCard</span><span class="p">()</span>
</code></pre></div>
<p>This makes the AgentCard available at the <code>/card</code> endpoint. 
Clients can query this endpoint to discover the agent’s capabilities.</p>
<h4 id="agentcard-components">AgentCard Components<a class="headerlink" href="#agentcard-components" title="Permanent link"></a></h4>
<p><strong>Basic Information:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="p">.</span><span class="na">name</span><span class="p">(</span><span class="s">"Disposition Agent"</span><span class="p">)</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="p">.</span><span class="na">description</span><span class="p">(</span><span class="s">"Determines how a car should be disposed..."</span><span class="p">)</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="p">.</span><span class="na">url</span><span class="p">(</span><span class="s">"http://localhost:8888/"</span><span class="p">)</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="p">.</span><span class="na">version</span><span class="p">(</span><span class="s">"1.0.0"</span><span class="p">)</span>
</code></pre></div>
<p><strong>Capabilities:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="p">.</span><span class="na">capabilities</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AgentCapabilities</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span><span class="p">.</span><span class="na">streaming</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w">           </span><span class="c1">// Supports streaming responses</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">    </span><span class="p">.</span><span class="na">pushNotifications</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w">  </span><span class="c1">// No push notifications</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">    </span><span class="p">.</span><span class="na">stateTransitionHistory</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w">  </span><span class="c1">// No state history tracking</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">    </span><span class="p">.</span><span class="na">build</span><span class="p">())</span>
</code></pre></div>
<p><strong>Skills:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="p">.</span><span class="na">skills</span><span class="p">(</span><span class="n">Collections</span><span class="p">.</span><span class="na">singletonList</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AgentSkill</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="p">.</span><span class="na">id</span><span class="p">(</span><span class="s">"disposition"</span><span class="p">)</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">    </span><span class="p">.</span><span class="na">name</span><span class="p">(</span><span class="s">"Car disposition"</span><span class="p">)</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">    </span><span class="p">.</span><span class="na">description</span><span class="p">(</span><span class="s">"Makes a request to dispose of a car (SCRAP, SELL, or DONATE)"</span><span class="p">)</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">    </span><span class="p">.</span><span class="na">tags</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"disposition"</span><span class="p">))</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">    </span><span class="p">.</span><span class="na">build</span><span class="p">()))</span>
</code></pre></div>
<p>Skills describe what the agent can do. This helps clients discover appropriate agents for their needs.</p>
<p><strong>Transport Protocol:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="p">.</span><span class="na">preferredTransport</span><span class="p">(</span><span class="n">TransportProtocol</span><span class="p">.</span><span class="na">JSONRPC</span><span class="p">.</span><span class="na">asString</span><span class="p">())</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="p">.</span><span class="na">additionalInterfaces</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="n">AgentInterface</span><span class="p">(</span><span class="n">TransportProtocol</span><span class="p">.</span><span class="na">JSONRPC</span><span class="p">.</span><span class="na">asString</span><span class="p">(),</span><span class="w"> </span><span class="s">"http://localhost:8888"</span><span class="p">)))</span>
</code></pre></div>
<p>Specifies that this agent communicates via JSON-RPC over HTTP.</p>
<h3 id="step-12-create-the-agentexecutor">Step 12: Create the AgentExecutor<a class="headerlink" href="#step-12-create-the-agentexecutor" title="Permanent link"></a></h3>
<p>The <strong>AgentExecutor</strong> handles incoming A2A requests and orchestrates the AI agent.</p>
<p>In <code>src/main/java/com/demo</code>, create <code>DispositionAgentExecutor.java</code>:</p>
<div class="highlight"><span class="filename">DispositionAgentExecutor.java</span><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.demo</span><span class="p">;</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.enterprise.context.ApplicationScoped</span><span class="p">;</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.enterprise.inject.Produces</span><span class="p">;</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.inject.Inject</span><span class="p">;</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.server.agentexecution.AgentExecutor</span><span class="p">;</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.server.agentexecution.RequestContext</span><span class="p">;</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.server.events.EventQueue</span><span class="p">;</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.server.tasks.TaskUpdater</span><span class="p">;</span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.JSONRPCError</span><span class="p">;</span>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.Message</span><span class="p">;</span>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.Part</span><span class="p">;</span>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.TextPart</span><span class="p">;</span>
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.UnsupportedOperationError</span><span class="p">;</span>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a>
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="cm">/**</span>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="cm"> * Executor for the DispositionAgent.</span>
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a><span class="cm"> * Handles the integration between the A2A framework and the DispositionAgent.</span>
<a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a><span class="cm"> */</span>
<a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a><span class="nd">@ApplicationScoped</span>
<a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DispositionAgentExecutor</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a>
<a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a><span class="w">    </span><span class="nd">@Inject</span>
<a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a><span class="w">    </span><span class="n">DispositionAgent</span><span class="w"> </span><span class="n">dispositionAgent</span><span class="p">;</span>
<a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a>
<a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a><span class="w">    </span><span class="nd">@Inject</span>
<a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a><span class="w">    </span><span class="n">DispositionTool</span><span class="w"> </span><span class="n">dispositionTool</span><span class="p">;</span>
<a id="__codelineno-28-32" name="__codelineno-28-32" href="#__codelineno-28-32"></a>
<a id="__codelineno-28-33" name="__codelineno-28-33" href="#__codelineno-28-33"></a><span class="w">    </span><span class="nd">@Produces</span>
<a id="__codelineno-28-34" name="__codelineno-28-34" href="#__codelineno-28-34"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">AgentExecutor</span><span class="w"> </span><span class="nf">agentExecutor</span><span class="p">(</span><span class="n">DispositionAgent</span><span class="w"> </span><span class="n">dispositionAgent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-35" name="__codelineno-28-35" href="#__codelineno-28-35"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AgentExecutor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-36" name="__codelineno-28-36" href="#__codelineno-28-36"></a><span class="w">            </span><span class="nd">@Override</span>
<a id="__codelineno-28-37" name="__codelineno-28-37" href="#__codelineno-28-37"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="n">RequestContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">EventQueue</span><span class="w"> </span><span class="n">eventQueue</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">JSONRPCError</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-38" name="__codelineno-28-38" href="#__codelineno-28-38"></a>
<a id="__codelineno-28-39" name="__codelineno-28-39" href="#__codelineno-28-39"></a><span class="w">                </span><span class="n">TaskUpdater</span><span class="w"> </span><span class="n">updater</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TaskUpdater</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">eventQueue</span><span class="p">);</span>
<a id="__codelineno-28-40" name="__codelineno-28-40" href="#__codelineno-28-40"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="na">getTask</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-41" name="__codelineno-28-41" href="#__codelineno-28-41"></a><span class="w">                    </span><span class="n">updater</span><span class="p">.</span><span class="na">submit</span><span class="p">();</span>
<a id="__codelineno-28-42" name="__codelineno-28-42" href="#__codelineno-28-42"></a><span class="w">                </span><span class="p">}</span>
<a id="__codelineno-28-43" name="__codelineno-28-43" href="#__codelineno-28-43"></a><span class="w">                </span><span class="n">updater</span><span class="p">.</span><span class="na">startWork</span><span class="p">();</span>
<a id="__codelineno-28-44" name="__codelineno-28-44" href="#__codelineno-28-44"></a>
<a id="__codelineno-28-45" name="__codelineno-28-45" href="#__codelineno-28-45"></a><span class="w">                </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<a id="__codelineno-28-46" name="__codelineno-28-46" href="#__codelineno-28-46"></a>
<a id="__codelineno-28-47" name="__codelineno-28-47" href="#__codelineno-28-47"></a><span class="w">                </span><span class="c1">// Process the request message</span>
<a id="__codelineno-28-48" name="__codelineno-28-48" href="#__codelineno-28-48"></a><span class="w">                </span><span class="n">Message</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getMessage</span><span class="p">();</span>
<a id="__codelineno-28-49" name="__codelineno-28-49" href="#__codelineno-28-49"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="na">getParts</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-50" name="__codelineno-28-50" href="#__codelineno-28-50"></a><span class="w">                    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Part</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">message</span><span class="p">.</span><span class="na">getParts</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-51" name="__codelineno-28-51" href="#__codelineno-28-51"></a><span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">part</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">TextPart</span><span class="w"> </span><span class="n">textPart</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-52" name="__codelineno-28-52" href="#__codelineno-28-52"></a><span class="w">                            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"\uD83D\uDCAC Text part: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">textPart</span><span class="p">.</span><span class="na">getText</span><span class="p">());</span>
<a id="__codelineno-28-53" name="__codelineno-28-53" href="#__codelineno-28-53"></a><span class="w">                            </span><span class="n">inputs</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">textPart</span><span class="p">.</span><span class="na">getText</span><span class="p">());</span>
<a id="__codelineno-28-54" name="__codelineno-28-54" href="#__codelineno-28-54"></a><span class="w">                        </span><span class="p">}</span>
<a id="__codelineno-28-55" name="__codelineno-28-55" href="#__codelineno-28-55"></a><span class="w">                    </span><span class="p">}</span>
<a id="__codelineno-28-56" name="__codelineno-28-56" href="#__codelineno-28-56"></a><span class="w">                </span><span class="p">}</span>
<a id="__codelineno-28-57" name="__codelineno-28-57" href="#__codelineno-28-57"></a>
<a id="__codelineno-28-58" name="__codelineno-28-58" href="#__codelineno-28-58"></a><span class="w">                </span><span class="c1">// Call the agent with all parameters as strings</span>
<a id="__codelineno-28-59" name="__codelineno-28-59" href="#__codelineno-28-59"></a><span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">agentResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dispositionAgent</span><span class="p">.</span><span class="na">processDisposition</span><span class="p">(</span>
<a id="__codelineno-28-60" name="__codelineno-28-60" href="#__codelineno-28-60"></a><span class="w">                        </span><span class="n">inputs</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w">                      </span><span class="c1">// carMake</span>
<a id="__codelineno-28-61" name="__codelineno-28-61" href="#__codelineno-28-61"></a><span class="w">                        </span><span class="n">inputs</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w">                      </span><span class="c1">// carModel</span>
<a id="__codelineno-28-62" name="__codelineno-28-62" href="#__codelineno-28-62"></a><span class="w">                        </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="w">    </span><span class="c1">// carYear</span>
<a id="__codelineno-28-63" name="__codelineno-28-63" href="#__codelineno-28-63"></a><span class="w">                        </span><span class="n">Long</span><span class="p">.</span><span class="na">parseLong</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span><span class="w">      </span><span class="c1">// carNumber</span>
<a id="__codelineno-28-64" name="__codelineno-28-64" href="#__codelineno-28-64"></a><span class="w">                        </span><span class="n">inputs</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="w">                      </span><span class="c1">// carCondition</span>
<a id="__codelineno-28-65" name="__codelineno-28-65" href="#__codelineno-28-65"></a><span class="w">                        </span><span class="n">inputs</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span><span class="w">                     </span><span class="c1">// dispositionRequest</span>
<a id="__codelineno-28-66" name="__codelineno-28-66" href="#__codelineno-28-66"></a>
<a id="__codelineno-28-67" name="__codelineno-28-67" href="#__codelineno-28-67"></a><span class="w">                </span><span class="c1">// Return the result</span>
<a id="__codelineno-28-68" name="__codelineno-28-68" href="#__codelineno-28-68"></a><span class="w">                </span><span class="n">TextPart</span><span class="w"> </span><span class="n">responsePart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TextPart</span><span class="p">(</span><span class="n">agentResponse</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
<a id="__codelineno-28-69" name="__codelineno-28-69" href="#__codelineno-28-69"></a><span class="w">                </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Part</span><span class="o">&lt;?&gt;&gt;</span><span class="w"> </span><span class="n">parts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">responsePart</span><span class="p">);</span>
<a id="__codelineno-28-70" name="__codelineno-28-70" href="#__codelineno-28-70"></a><span class="w">                </span><span class="n">updater</span><span class="p">.</span><span class="na">addArtifact</span><span class="p">(</span><span class="n">parts</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
<a id="__codelineno-28-71" name="__codelineno-28-71" href="#__codelineno-28-71"></a><span class="w">                </span><span class="n">updater</span><span class="p">.</span><span class="na">complete</span><span class="p">();</span>
<a id="__codelineno-28-72" name="__codelineno-28-72" href="#__codelineno-28-72"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-28-73" name="__codelineno-28-73" href="#__codelineno-28-73"></a>
<a id="__codelineno-28-74" name="__codelineno-28-74" href="#__codelineno-28-74"></a><span class="w">            </span><span class="nd">@Override</span>
<a id="__codelineno-28-75" name="__codelineno-28-75" href="#__codelineno-28-75"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">cancel</span><span class="p">(</span><span class="n">RequestContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">EventQueue</span><span class="w"> </span><span class="n">eventQueue</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">JSONRPCError</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-76" name="__codelineno-28-76" href="#__codelineno-28-76"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UnsupportedOperationError</span><span class="p">();</span>
<a id="__codelineno-28-77" name="__codelineno-28-77" href="#__codelineno-28-77"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-28-78" name="__codelineno-28-78" href="#__codelineno-28-78"></a><span class="w">        </span><span class="p">};</span>
<a id="__codelineno-28-79" name="__codelineno-28-79" href="#__codelineno-28-79"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-28-80" name="__codelineno-28-80" href="#__codelineno-28-80"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Let’s break it down:</strong></p>
<h4 id="cdi-bean-with-agentexecutor-factory">CDI Bean with AgentExecutor Factory<a class="headerlink" href="#cdi-bean-with-agentexecutor-factory" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="nd">@ApplicationScoped</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DispositionAgentExecutor</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w">    </span><span class="nd">@Produces</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">AgentExecutor</span><span class="w"> </span><span class="nf">agentExecutor</span><span class="p">(</span><span class="n">DispositionAgent</span><span class="w"> </span><span class="n">dispositionAgent</span><span class="p">)</span>
</code></pre></div>
<p>Produces an <code>AgentExecutor</code> bean that Quarkus LangChain4j will use to handle A2A task requests.</p>
<h4 id="task-processing">Task Processing<a class="headerlink" href="#task-processing" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="n">RequestContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">EventQueue</span><span class="w"> </span><span class="n">eventQueue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="w">    </span><span class="n">TaskUpdater</span><span class="w"> </span><span class="n">updater</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TaskUpdater</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">eventQueue</span><span class="p">);</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="w">    </span><span class="c1">// Extract input parts from the task</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="w">    </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">MessagePart</span><span class="o">&gt;</span><span class="w"> </span><span class="n">inputParts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">task</span><span class="p">().</span><span class="na">input</span><span class="p">();</span>
</code></pre></div>
<p>The <code>RequestContext</code> contains the incoming task with all input parameters sent by the client.</p>
<h4 id="extract-parameters">Extract Parameters<a class="headerlink" href="#extract-parameters" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getTextPart</span><span class="p">(</span><span class="n">inputParts</span><span class="p">,</span><span class="w"> </span><span class="s">"carMake"</span><span class="p">);</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getTextPart</span><span class="p">(</span><span class="n">inputParts</span><span class="p">,</span><span class="w"> </span><span class="s">"carModel"</span><span class="p">);</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getIntegerPart</span><span class="p">(</span><span class="n">inputParts</span><span class="p">,</span><span class="w"> </span><span class="s">"carYear"</span><span class="p">);</span>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="c1">// ... etc</span>
</code></pre></div>
<p>Extracts each parameter by name from the task input. These names must match the client agent’s method parameters.</p>
<h4 id="call-the-ai-agent">Call the AI Agent<a class="headerlink" href="#call-the-ai-agent" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dispositionAgent</span><span class="p">.</span><span class="na">processDisposition</span><span class="p">(</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="w">    </span><span class="n">carMake</span><span class="p">,</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span><span class="w"> </span><span class="n">dispositionRequest</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="p">);</span>
</code></pre></div>
<p>Invokes the AI agent to process the disposition request.</p>
<h4 id="update-task-status">Update Task Status<a class="headerlink" href="#update-task-status" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="n">updater</span><span class="p">.</span><span class="na">finishTask</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">MessagePart</span><span class="p">.</span><span class="na">text</span><span class="p">(</span><span class="n">result</span><span class="p">)));</span>
</code></pre></div>
<p>Sends the result back to the client via the <code>TaskUpdater</code>. This completes the A2A task.</p>
<h4 id="helper-methods">Helper Methods<a class="headerlink" href="#helper-methods" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getTextPart</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">MessagePart</span><span class="o">&gt;</span><span class="w"> </span><span class="n">parts</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="w">    </span><span class="n">MessagePart</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parts</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">part</span><span class="p">.</span><span class="na">content</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">""</span><span class="p">;</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="p">}</span>
</code></pre></div>
<p>Safely extracts text values from MessagePart objects.</p>
<hr>
<h2 id="try-it-out">Try It Out<a class="headerlink" href="#try-it-out" title="Permanent link"></a></h2>
<p>You’ll need to run <strong>two applications simultaneously</strong>.</p>
<h3 id="terminal-1-start-the-remote-a2a-server">Terminal 1: Start the Remote A2A Server<a class="headerlink" href="#terminal-1-start-the-remote-a2a-server" title="Permanent link"></a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="nb">cd</span><span class="w"> </span>section-2/step-04/remote-a2a-agent
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>./mvnw<span class="w"> </span>quarkus:dev
</code></pre></div>
<p>Wait for:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>Listening on: http://localhost:8888
</code></pre></div>
<p>The disposition service is now running and ready to accept A2A requests!</p>
<h3 id="terminal-2-start-the-main-application">Terminal 2: Start the Main Application<a class="headerlink" href="#terminal-2-start-the-main-application" title="Permanent link"></a></h3>
<p>Open a <strong>new terminal</strong> and run:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="nb">cd</span><span class="w"> </span>section-2/step-04/multi-agent-system
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>./mvnw<span class="w"> </span>quarkus:dev
</code></pre></div>
<p>Wait for:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>Listening on: http://localhost:8080
</code></pre></div>
<h3 id="test-the-complete-flow">Test the Complete Flow<a class="headerlink" href="#test-the-complete-flow" title="Permanent link"></a></h3>
<p>Open your browser to <a href="http://localhost:8080" target="_blank">http://localhost:8080</a>.</p>
<p>After reloading the UI, you should see the Returns section is now called <strong>Returns and Dispositions</strong>. You’ll also notice that there is a new tab to list the cars that are pending disposition.</p>
<p><img alt="Maintenance Returns Tab" class="center" src="../../images/agentic-UI-maintenance-returns-2.png"></p>
<p>On the Maintenance Return tab, enter feedback indicating severe damage for car 11:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>looks like this car hit a tree
</code></pre></div>
<p>Click <strong>Return</strong>.</p>
<p><strong>What happens?</strong></p>
<ol>
<li><strong>Parallel Analysis</strong> (FeedbackWorkflow):</li>
<li><code>DispositionFeedbackAgent</code>: “Disposition required — severe damage”</li>
<li><code>MaintenanceFeedbackAgent</code>: “Major repairs needed”</li>
<li>
<p><code>CarWashFeedbackAgent</code>: “Not applicable”</p>
</li>
<li>
<p><strong>Conditional Routing</strong> (ActionWorkflow):</p>
</li>
<li>Disposition condition: <code>true</code> (required)</li>
<li>
<p>→ Executes <code>DispositionAgent</code> (A2A client)</p>
</li>
<li>
<p><strong>A2A Communication</strong>:</p>
</li>
<li>Client sends task to <code>http://localhost:8888</code></li>
<li><code>AgentExecutor</code> receives and processes task</li>
<li><code>DispositionAgent</code> (AI service) analyzes using <code>DispositionTool</code></li>
<li>
<p>Result flows back to client</p>
</li>
<li>
<p><strong>UI Update</strong>:</p>
</li>
<li>Car status → <code>DISPOSED</code></li>
<li>Car appears in the Dispositions tab</li>
</ol>
<h3 id="check-the-logs">Check the Logs<a class="headerlink" href="#check-the-logs" title="Permanent link"></a></h3>
<p><strong>Terminal 1 (Remote A2A Server):</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>[DispositionAgentExecutor] Received task: process disposition
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>[DispositionAgent] Analyzing car: Ford Mustang (2022)
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>⛍ DispositionTool result: Car disposition requested for Ford Mustang (2022), Car #11: Scrap the car
</code></pre></div>
<p><strong>Terminal 2 (Main Application):</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>[DispositionFeedbackAgent] DISPOSITION_REQUIRED - Severe structural damage, uneconomical to repair
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>[ActionWorkflow] Activating DispositionAgent
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>[DispositionAgent @A2AClientAgent] Sending task to http://localhost:8888
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>[DispositionAgent @A2AClientAgent] Received result: Car should be scrapped...
</code></pre></div>
<p>Notice the <strong>cross-application communication</strong> via A2A!</p>
<hr>
<h2 id="how-it-all-works-together">How It All Works Together<a class="headerlink" href="#how-it-all-works-together" title="Permanent link"></a></h2>
<p>Let’s trace the complete flow:</p>
<pre class="mermaid"><code>sequenceDiagram
    participant User
    participant Service as CarManagementService
    participant Workflow as CarProcessingWorkflow
    participant FeedbackWF as FeedbackWorkflow
    participant ActionWF as ActionWorkflow
    participant Client as DispositionAgent&lt;br/&gt;@A2AClientAgent
    participant A2A as A2A Protocol&lt;br/&gt;(JSON-RPC)
    participant Executor as AgentExecutor
    participant Remote as DispositionAgent&lt;br/&gt;AI Service
    participant Tool as DispositionTool

    User-&gt;&gt;Service: Return car with severe damage
    Service-&gt;&gt;Workflow: processCarReturn(...)

    rect rgb(255, 243, 205)
    Note over Workflow,FeedbackWF: Parallel Analysis
    Workflow-&gt;&gt;FeedbackWF: Execute
    par Concurrent Execution
        FeedbackWF-&gt;&gt;FeedbackWF: CarWashFeedbackAgent
    and
        FeedbackWF-&gt;&gt;FeedbackWF: MaintenanceFeedbackAgent
    and
        FeedbackWF-&gt;&gt;FeedbackWF: DispositionFeedbackAgent&lt;br/&gt;Result: "DISPOSITION_REQUIRED"
    end
    end

    rect rgb(248, 215, 218)
    Note over Workflow,ActionWF: Conditional Routing
    Workflow-&gt;&gt;ActionWF: Execute
    ActionWF-&gt;&gt;ActionWF: Check: dispositionRequest required? YES
    ActionWF-&gt;&gt;Client: Execute DispositionAgent
    end

    rect rgb(212, 237, 218)
    Note over Client,Tool: A2A Communication
    Client-&gt;&gt;A2A: Create Task with inputs
    A2A-&gt;&gt;Executor: POST /tasks
    Executor-&gt;&gt;Remote: processDisposition(...)
    Remote-&gt;&gt;Tool: scrapCar() / sellCar() / donateCar()
    Tool-&gt;&gt;Tool: Execute disposal action
    Tool-&gt;&gt;Remote: Return result
    Remote-&gt;&gt;Executor: Return recommendation
    Executor-&gt;&gt;A2A: Update task status
    A2A-&gt;&gt;Client: Return result
    end

    Client-&gt;&gt;Workflow: Return disposition result
    Workflow-&gt;&gt;Service: Return CarConditions
    Service-&gt;&gt;Service: Set status to DISPOSED
    Service-&gt;&gt;User: Update UI</code></pre>
<hr>
<h2 id="understanding-the-a2a-implementation">Understanding the A2A Implementation<a class="headerlink" href="#understanding-the-a2a-implementation" title="Permanent link"></a></h2>
<h3 id="client-side-a2aclientagent">Client Side (<code>@A2AClientAgent</code>)<a class="headerlink" href="#client-side-a2aclientagent" title="Permanent link"></a></h3>
<p>The client agent is remarkably simple:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="nd">@A2AClientAgent</span><span class="p">(</span><span class="n">a2aServerUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"http://localhost:8888"</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="n">String</span><span class="w"> </span><span class="nf">processDisposition</span><span class="p">(...)</span>
</code></pre></div>
<p>Quarkus LangChain4j handles:
- Creating the A2A task
- Serializing method parameters as task inputs
- Sending the HTTP request via JSON-RPC
- Waiting for the response
- Deserializing the result
- Error handling and retries</p>
<h3 id="server-side-agentcard-agentexecutor">Server Side (AgentCard + AgentExecutor)<a class="headerlink" href="#server-side-agentcard-agentexecutor" title="Permanent link"></a></h3>
<p>The server requires more components:</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>AgentCard</strong></td>
<td>Describes agent capabilities, published at <code>/card</code> endpoint</td>
</tr>
<tr>
<td><strong>AgentExecutor</strong></td>
<td>Receives and processes A2A task requests</td>
</tr>
<tr>
<td><strong>TaskUpdater</strong></td>
<td>Updates task status and sends results back to client</td>
</tr>
<tr>
<td><strong>AI Agent</strong></td>
<td>The actual AI service that processes requests</td>
</tr>
<tr>
<td><strong>Tools</strong></td>
<td>Actions the AI agent can perform</td>
</tr>
</tbody>
</table>
<p>This separation allows:
- Agents to focus on business logic
- A2A infrastructure to handle protocol details
- Multiple agents to be exposed from one server</p>
<hr>
<h2 id="key-takeaways">Key Takeaways<a class="headerlink" href="#key-takeaways" title="Permanent link"></a></h2>
<ul>
<li><strong>A2A enables distributed agents</strong>: Different teams can maintain specialized agents in separate systems</li>
<li><strong><code>@A2AClientAgent</code> is powerful</strong>: Simple annotation transforms a method into an A2A client</li>
<li><strong>AgentCard describes capabilities</strong>: Clients can discover what remote agents can do</li>
<li><strong>AgentExecutor handles protocol</strong>: Separates A2A infrastructure from agent logic</li>
<li><strong>Tasks vs. Messages</strong>: A2A supports both task-based and conversational interactions</li>
<li><strong>Type-safe integration</strong>: Method parameters automatically become task inputs</li>
<li><strong>Remote agents integrate seamlessly</strong>: Works with existing workflows and agents</li>
<li><strong>Two runtimes communicate</strong>: Real-world simulation of distributed agent systems</li>
</ul>
<hr>
<h2 id="experiment-further">Experiment Further<a class="headerlink" href="#experiment-further" title="Permanent link"></a></h2>
<h3 id="1-add-agent-discovery">1. Add Agent Discovery<a class="headerlink" href="#1-add-agent-discovery" title="Permanent link"></a></h3>
<p>The AgentCard is published at <code>http://localhost:8888/card</code>. Try:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>curl<span class="w"> </span>http://localhost:8888/card<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq
</code></pre></div>
<p>You’ll see the full agent description including skills, capabilities, and transport protocols.</p>
<h3 id="2-test-different-disposition-scenarios">2. Test Different Disposition Scenarios<a class="headerlink" href="#2-test-different-disposition-scenarios" title="Permanent link"></a></h3>
<p>Try these feedback examples:</p>
<p><strong>Scenario 1: Sell the car</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>Minor engine issues, good body condition, low mileage. Repair cost: $800.
</code></pre></div>
<p><strong>Scenario 2: Donate the car</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>Old car, high mileage, runs but needs work. Market value low.
</code></pre></div>
<p><strong>Scenario 3: Scrap the car</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>Total loss from flood damage, electrical system destroyed.
</code></pre></div>
<p>Observe how the remote agent makes different decisions!</p>
<h3 id="3-create-your-own-a2a-agent">3. Create Your Own A2A Agent<a class="headerlink" href="#3-create-your-own-a2a-agent" title="Permanent link"></a></h3>
<p>What other specialized agents could be useful?</p>
<ul>
<li><strong>Pricing Agent</strong>: Determines optimal rental pricing based on demand</li>
<li><strong>Route Planner Agent</strong>: Plans maintenance schedules for the fleet</li>
<li><strong>Insurance Agent</strong>: Assesses insurance claims for damaged cars</li>
</ul>
<p>Try creating a simple A2A server for one of these!</p>
<h3 id="4-monitor-a2a-communication">4. Monitor A2A Communication<a class="headerlink" href="#4-monitor-a2a-communication" title="Permanent link"></a></h3>
<p>Add logging to see the JSON-RPC messages:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="c1"># In application.properties</span>
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="na">quarkus.log.category."io.a2a".level</span><span class="o">=</span><span class="s">DEBUG</span>
</code></pre></div>
<p>This shows the raw A2A protocol messages.</p>
<hr>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link"></a></h2>
<details class="warning">
<summary>Connection refused to localhost:8888</summary>
<p>Make sure the remote A2A server is running in Terminal 1. Check for:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>Listening on: http://localhost:8888
</code></pre></div>
<p>If you see “Port already in use”, another application is using port 8888. You can change it in <code>remote-a2a-agent/src/main/resources/application.properties</code>:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="na">quarkus.http.port</span><span class="o">=</span><span class="s">8889</span>
</code></pre></div>
<p>Then update the client’s <code>a2aServerUrl</code> accordingly.</p>
</details>
<details class="warning">
<summary>Task execution timeout</summary>
<p>If the remote agent takes too long to respond, you might see a timeout error. The default timeout is sufficient for most cases, but you can increase it if needed by configuring the A2A client.</p>
</details>
<details class="warning">
<summary>Parameter mismatch errors</summary>
<p>If you see errors about missing parameters, verify that:</p>
<ul>
<li>Client agent method parameter names match what AgentExecutor extracts</li>
<li>The <code>getTextPart()</code> / <code>getIntegerPart()</code> calls use the correct keys</li>
<li>All required parameters are being sent by the client</li>
</ul>
</details>
<details class="warning">
<summary>Agent not activating</summary>
<p>If the DispositionAgent never executes, check:</p>
<ul>
<li>The <code>@ActivationCondition</code> method is correctly implemented</li>
<li>The <code>dispositionRequest</code> contains <code>"DISPOSITION_REQUIRED"</code></li>
<li>The condition is being checked in the correct order</li>
</ul>
</details>
<details class="warning">
<summary>Both applications on same port</summary>
<p>If you see “Port already in use” on 8080:</p>
<ul>
<li>Make sure you stopped the application from Step 03</li>
<li>Only run the main application from <code>multi-agent-system</code>, not from a previous step directory</li>
<li>Check for zombie Java processes: <code>ps aux | grep java</code></li>
</ul>
</details>
<hr>
<h2 id="whats-next">What’s Next?<a class="headerlink" href="#whats-next" title="Permanent link"></a></h2>
<p>You’ve successfully built a distributed agent system using the A2A protocol!</p>
<p>You learned how to:
- Connect to remote agents using <code>@A2AClientAgent</code>
- Build A2A servers with AgentCard and AgentExecutor
- Integrate remote agents into complex workflows
- Run multiple Quarkus applications that communicate via A2A</p>
<p>This completes <strong>Section 2: Agentic Systems</strong>! You’ve progressed from simple agents to complex distributed workflows with remote agent communication.</p>
<p><strong>Congratulations!</strong> You now have the skills to build sophisticated multi-agent systems with Quarkus LangChain4j!</p>
<hr>
<h2 id="additional-resources">Additional Resources<a class="headerlink" href="#additional-resources" title="Permanent link"></a></h2>
<ul>
<li><a href="https://a2a.dev">A2A Protocol Specification</a></li>
<li><a href="https://docs.quarkiverse.io/quarkus-langchain4j/dev/">Quarkus LangChain4j Documentation</a></li>
<li><a href="https://docs.quarkiverse.io/quarkus-langchain4j/dev/agentic.html">Quarkus LangChain4j Agentic Module</a></li>
</ul></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../step-03/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Step 3 - Building nested agent workflows">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Step 3 - Building nested agent workflows
              </div>
            </div>
          </a>
        
        
          
          <a href="../conclusion/" class="md-footer__link md-footer__link--next" aria-label="Next: Mastering Agentic Systems">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Mastering Agentic Systems
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <!--
  Copyright (c) 2016-2022 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Copyright and theme information, adapter to have the Red Hat footer -->
<div class="md-copyright">
    <div class="md-copyright__highlight">
        Sponsored by <a href="https://www.redhat.com"><img style="vertical-align: middle;" alt="Red Hat" src="../../images/redhat_reversed.svg"/></a> <br/>
        <a href="https://creativecommons.org/licenses/by/3.0/">CC by 3.0</a> |
        <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </div>
    
    Made with
    <a
            href="https://squidfunk.github.io/mkdocs-material/"
            target="_blank" rel="noopener"
    >
        Material for MkDocs
    </a>
    
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "content.tabs.link", "content.code.annotate", "navigation.instant", "navigation.indexes", "navigation.tracking", "navigation.footer", "navigation.tabs.sticky", "content.code.select", "content.code.copy"], "search": "../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>