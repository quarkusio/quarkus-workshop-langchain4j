
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://quarkus.io/quarkus-workshop-langchain4j/section-2/step-05/">
      
      
        <link rel="prev" href="../step-04/">
      
      
        <link rel="next" href="../conclusion/">
      
      
        
      
      
      <link rel="icon" href="../../images/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Step 5 - Using remote agents (A2A) - Quarkus LangChain4j Workshop</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../extra.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/panzoom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  <meta name="panzoom-theme" content="material">
<meta name="panzoom-data" content='{"selectors": [".d2", ".mermaid"], "initial_zoom_level": 1.0}'> </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#step-05-using-remote-agents-a2a" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
You are not viewing the latest version.
<a href="../../..">
    <strong>Click here to go to latest.</strong>
</a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Quarkus LangChain4j Workshop" class="md-header__button md-logo" aria-label="Quarkus LangChain4j Workshop" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Quarkus LangChain4j Workshop
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Step 5 - Using remote agents (A2A)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H6zm7-4.68V17c0 .55-.45 1-1 1H6c-.55 0-1-.45-1-1v-2.26C3.19 13.47 2 11.38 2 9c0-3.87 3.13-7 7-7 1.65 0 3.16.57 4.35 1.5C10.8 4.57 9 7.07 9 10c0 2.79 1.64 5.19 4 6.32m7.92-6.38-1.42-.91-1.4.97.4-1.65-1.33-1.03 1.68-.11.56-1.61.63 1.58 1.68.04-1.3 1.08zM19.39 13c-1.89 2.27-5.36 2.19-7.17-.05C10 10.13 11.56 6 15 5.34c.34-.05.64.29.5.63-.45 1.28-.38 2.74.35 4a4.62 4.62 0 0 0 3.27 2.28c.35.05.5.49.27.75"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 6a6 6 0 0 1 6 6c0 2.22-1.21 4.16-3 5.2V19a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-1.8c-1.79-1.04-3-2.98-3-5.2a6 6 0 0 1 6-6m2 15v1a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-1zm6-10h3v2h-3zM1 11h3v2H1zM13 1v3h-2V1zM4.92 3.5l2.13 2.14-1.42 1.41L3.5 4.93zm12.03 2.13 2.12-2.13 1.43 1.43-2.13 2.12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/quarkusio/quarkus-langchain4j-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Quarkus LangChain4j Workshop" class="md-nav__button md-logo" aria-label="Quarkus LangChain4j Workshop" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    Quarkus LangChain4j Workshop
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/quarkusio/quarkus-langchain4j-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../requirements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Requirements
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Section 1 - AI Apps
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Section 1 - AI Apps
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 1 - Introduction to Quarkus LangChain4j
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 2 - Playing with model parameters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 3 - Streaming responses
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 4 - Using system messages
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 5 - Introduction to the RAG pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 6 - Deconstructing the RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 7 - Function calling and tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 8 - Model Context Protocol
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 9 - Guardrails
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../section-1/step-10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 10 - Observability and Fault Tolerance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Section 2 - Agentic Workflows
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Section 2 - Agentic Workflows
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../step-01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 1 - Implementing AI Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../step-02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 2 - Creating simple agentic workflows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../step-03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 3 - Composing multiple agentic workflows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../step-04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 4 - Supervisor pattern for dynamic orchestration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Step 5 - Using remote agents (A2A)
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Step 5 - Using remote agents (A2A)
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#new-requirement-distributing-the-disposition-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        New Requirement: Distributing the Disposition Service
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-youll-learn" class="md-nav__link">
    <span class="md-ellipsis">
      
        What You&rsquo;ll Learn
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-a2a-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      
        Understanding the A2A Protocol
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the A2A Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-a2a" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why A2A?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a2a-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        A2A Architecture
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-tasks-vs-messages" class="md-nav__link">
    <span class="md-ellipsis">
      
        Understanding Tasks vs. Messages
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-are-we-going-to-build" class="md-nav__link">
    <span class="md-ellipsis">
      
        What Are We Going to Build?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-project-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Understanding the Project Structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-1-build-the-client-side-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 1: Build the Client-Side Components
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 1: Build the Client-Side Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-update-the-dispositionfeedbackagent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Update the DispositionFeedbackAgent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-convert-the-dispositionagent-to-a2a-client" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Convert the DispositionAgent to A2A Client
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Convert the DispositionAgent to A2A Client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a2aclientagent-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      
        @A2AClientAgent Annotation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-method-signature" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Method Signature
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How It Works
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-2-update-the-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 2: Update the Workflows
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 2: Update the Workflows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-3-update-feedbackworkflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Update FeedbackWorkflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-create-carassignmentworkflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Create CarAssignmentWorkflow
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Create CarAssignmentWorkflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#added-dispositionagent-to-subagents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Added DispositionAgent to SubAgents
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#added-activation-condition" class="md-nav__link">
    <span class="md-ellipsis">
      
        Added Activation Condition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updated-execution-priority" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updated Execution Priority
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-update-carprocessingworkflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5: Update CarProcessingWorkflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-update-carassignment-enum" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 6: Update CarAssignment Enum
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-update-carmanagementservice" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 7: Update CarManagementService
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-3-build-the-remote-a2a-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 3: Build the Remote A2A Server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 3: Build the Remote A2A Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-8-create-the-dispositiontool" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 8: Create the DispositionTool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-9-create-the-dispositionagent-ai-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 9: Create the DispositionAgent (AI Service)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-10-create-the-agentcard" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 10: Create the AgentCard
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 10: Create the AgentCard">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#publicagentcard-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      
        @PublicAgentCard Annotation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentcard-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        AgentCard Components
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-11-create-the-agentexecutor" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 11: Create the AgentExecutor
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 11: Create the AgentExecutor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cdi-bean-with-agentexecutor-factory" class="md-nav__link">
    <span class="md-ellipsis">
      
        CDI Bean with AgentExecutor Factory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Task Processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Extract Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-the-ai-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Call the AI Agent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-task-status" class="md-nav__link">
    <span class="md-ellipsis">
      
        Update Task Status
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Helper Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-it-out" class="md-nav__link">
    <span class="md-ellipsis">
      
        Try It Out
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Try It Out">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terminal-1-start-the-remote-a2a-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Terminal 1: Start the Remote A2A Server
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terminal-2-start-the-main-application" class="md-nav__link">
    <span class="md-ellipsis">
      
        Terminal 2: Start the Main Application
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-complete-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test the Complete Flow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-the-logs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Check the Logs
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-all-works-together" class="md-nav__link">
    <span class="md-ellipsis">
      
        How It All Works Together
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-a2a-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Understanding the A2A Implementation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the A2A Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client-side-a2aclientagent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Client Side (@A2AClientAgent)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-side-agentcard-agentexecutor" class="md-nav__link">
    <span class="md-ellipsis">
      
        Server Side (AgentCard + AgentExecutor)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Takeaways
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experiment-further" class="md-nav__link">
    <span class="md-ellipsis">
      
        Experiment Further
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Experiment Further">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-agent-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Add Agent Discovery
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-test-different-disposition-scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Test Different Disposition Scenarios
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-create-your-own-a2a-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Create Your Own A2A Agent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-monitor-a2a-communication" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Monitor A2A Communication
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      
        What&rsquo;s Next?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional Resources
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conclusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mastering Agentic Systems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conclusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Conclusion
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#new-requirement-distributing-the-disposition-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        New Requirement: Distributing the Disposition Service
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-youll-learn" class="md-nav__link">
    <span class="md-ellipsis">
      
        What You&rsquo;ll Learn
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-a2a-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      
        Understanding the A2A Protocol
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the A2A Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-a2a" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why A2A?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a2a-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        A2A Architecture
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-tasks-vs-messages" class="md-nav__link">
    <span class="md-ellipsis">
      
        Understanding Tasks vs. Messages
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-are-we-going-to-build" class="md-nav__link">
    <span class="md-ellipsis">
      
        What Are We Going to Build?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-project-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Understanding the Project Structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-1-build-the-client-side-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 1: Build the Client-Side Components
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 1: Build the Client-Side Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-update-the-dispositionfeedbackagent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Update the DispositionFeedbackAgent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-convert-the-dispositionagent-to-a2a-client" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Convert the DispositionAgent to A2A Client
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Convert the DispositionAgent to A2A Client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a2aclientagent-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      
        @A2AClientAgent Annotation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-method-signature" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Method Signature
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How It Works
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-2-update-the-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 2: Update the Workflows
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 2: Update the Workflows">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-3-update-feedbackworkflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Update FeedbackWorkflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-create-carassignmentworkflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Create CarAssignmentWorkflow
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Create CarAssignmentWorkflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#added-dispositionagent-to-subagents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Added DispositionAgent to SubAgents
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#added-activation-condition" class="md-nav__link">
    <span class="md-ellipsis">
      
        Added Activation Condition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updated-execution-priority" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updated Execution Priority
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-update-carprocessingworkflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5: Update CarProcessingWorkflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-update-carassignment-enum" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 6: Update CarAssignment Enum
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-update-carmanagementservice" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 7: Update CarManagementService
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-3-build-the-remote-a2a-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 3: Build the Remote A2A Server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 3: Build the Remote A2A Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-8-create-the-dispositiontool" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 8: Create the DispositionTool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-9-create-the-dispositionagent-ai-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 9: Create the DispositionAgent (AI Service)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-10-create-the-agentcard" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 10: Create the AgentCard
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 10: Create the AgentCard">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#publicagentcard-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      
        @PublicAgentCard Annotation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentcard-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        AgentCard Components
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-11-create-the-agentexecutor" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 11: Create the AgentExecutor
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 11: Create the AgentExecutor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cdi-bean-with-agentexecutor-factory" class="md-nav__link">
    <span class="md-ellipsis">
      
        CDI Bean with AgentExecutor Factory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Task Processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Extract Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-the-ai-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Call the AI Agent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-task-status" class="md-nav__link">
    <span class="md-ellipsis">
      
        Update Task Status
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Helper Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#try-it-out" class="md-nav__link">
    <span class="md-ellipsis">
      
        Try It Out
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Try It Out">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terminal-1-start-the-remote-a2a-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Terminal 1: Start the Remote A2A Server
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terminal-2-start-the-main-application" class="md-nav__link">
    <span class="md-ellipsis">
      
        Terminal 2: Start the Main Application
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-complete-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test the Complete Flow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-the-logs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Check the Logs
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-all-works-together" class="md-nav__link">
    <span class="md-ellipsis">
      
        How It All Works Together
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-the-a2a-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Understanding the A2A Implementation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding the A2A Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client-side-a2aclientagent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Client Side (@A2AClientAgent)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-side-agentcard-agentexecutor" class="md-nav__link">
    <span class="md-ellipsis">
      
        Server Side (AgentCard + AgentExecutor)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Takeaways
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experiment-further" class="md-nav__link">
    <span class="md-ellipsis">
      
        Experiment Further
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Experiment Further">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-agent-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Add Agent Discovery
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-test-different-disposition-scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Test Different Disposition Scenarios
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-create-your-own-a2a-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Create Your Own A2A Agent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-monitor-a2a-communication" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Monitor A2A Communication
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" class="md-nav__link">
    <span class="md-ellipsis">
      
        What&rsquo;s Next?
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional Resources
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div><h1 id="step-05-using-remote-agents-a2a">Step 05 - Using Remote Agents (A2A)<a class="headerlink" href="#step-05-using-remote-agents-a2a" title="Permanent link"></a></h1>
<h2 id="new-requirement-distributing-the-disposition-service">New Requirement: Distributing the Disposition Service<a class="headerlink" href="#new-requirement-distributing-the-disposition-service" title="Permanent link"></a></h2>
<p>In Step 4, you implemented a complete disposition system using the Supervisor Pattern with local agents. The system works well, but the Miles of Smiles management team has a new architectural requirement:</p>
<p><strong>The disposition decision-making logic needs to be maintained by a separate team and run as an independent service.</strong></p>
<p>This is a common real-world scenario where:</p>
<ol>
<li><strong>Different teams own different capabilities</strong>: The disposition team has specialized expertise and wants to maintain their own service</li>
<li><strong>The service needs to be reusable</strong>: Multiple client applications (not just car management) might need disposition recommendations</li>
<li><strong>Independent scaling is required</strong>: The disposition service might need different resources than the main application</li>
</ol>
<p>Youll learn how to convert Step 4s local <code>DispositionAgent</code> into a remote service using the <a href="https://a2a-protocol.org/" target="_blank"><strong>Agent-to-Agent (A2A) protocol</strong></a>.</p>
<hr>
<h2 id="what-youll-learn">What Youll Learn<a class="headerlink" href="#what-youll-learn" title="Permanent link"></a></h2>
<p>In this step, you will:</p>
<ul>
<li>Understand the <a href="https://a2a-protocol.org/" target="_blank"><strong>Agent-to-Agent (A2A) protocol</strong></a> for distributed agent communication</li>
<li><strong>Convert</strong> Step 4s local <code>DispositionAgent</code> into a remote A2A service</li>
<li>Build a <strong>client agent</strong> that connects to remote A2A agents using <code>@A2AClientAgent</code></li>
<li>Create an <strong>A2A server</strong> that exposes an AI agent as a remote service</li>
<li>Learn about <strong>AgentCard</strong>, <strong>AgentExecutor</strong>, and <strong>TaskUpdater</strong> components from the A2A SDK</li>
<li>Understand the difference between <strong>Tasks</strong> and <strong>Messages</strong> in A2A protocol</li>
<li>Run <strong>multiple Quarkus applications</strong> that communicate via A2A</li>
<li>See the architectural trade-offs: lose Supervisor Pattern sophistication, gain distribution benefits</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At the moment the A2A integration is quite low-level and requires some boilerplate code.
The Quarkus LangChain4j team is working on higher-level abstractions to simplify A2A usage in future releases.</p>
</div>
<hr>
<h2 id="understanding-the-a2a-protocol">Understanding the A2A Protocol<a class="headerlink" href="#understanding-the-a2a-protocol" title="Permanent link"></a></h2>
<p>The <a href="https://a2a-protocol.org/" target="_blank"><strong>Agent-to-Agent (A2A) protocol</strong></a> is an open protocol for AI agents to communicate across different systems and platforms.</p>
<h3 id="why-a2a">Why A2A?<a class="headerlink" href="#why-a2a" title="Permanent link"></a></h3>
<ul>
<li><strong>Separation of concerns</strong>: Different teams can develop specialized agents independently</li>
<li><strong>Scalability</strong>: Distribute agent workload across multiple systems</li>
<li><strong>Reusability</strong>: One agent can serve multiple client applications</li>
<li><strong>Technology independence</strong>: Agents can be implemented in different languages/frameworks</li>
</ul>
<h3 id="a2a-architecture">A2A Architecture<a class="headerlink" href="#a2a-architecture" title="Permanent link"></a></h3>
<div class="panzoom-box" data-key="alt" id="panzoom0" oncontextmenu="return false;">
    
    <nav class="panzoom-nav">
    <button class="panzoom-info panzoom-button">
    <svg class="panzoom-icon" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm169.8-90.7c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"></path>
    </svg>
</button><button class="panzoom-reset panzoom-button">
    <svg class="panzoom-icon" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M125.7 160l50.3 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L48 224c-17.7 0-32-14.3-32-32L16 64c0-17.7 14.3-32 32-32s32 14.3 32 32l0 51.2L97.6 97.6c87.5-87.5 229.3-87.5 316.8 0s87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3s-163.8-62.5-226.3 0L125.7 160z"></path>
    </svg>
</button><button class="panzoom-max panzoom-button">
    <svg class="panzoom-icon" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M32 32C14.3 32 0 46.3 0 64l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L32 32zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM448 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96z"></path>
    </svg>
</button><button class="panzoom-min panzoom-button panzoom-hidden">
    <svg class="panzoom-icon" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M160 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96zM32 320c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM352 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 320c-17.7 0-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0z"></path>
    </svg>
</button>
    </nav>
    <pre class="mermaid"><code>graph LR
    subgraph "Quarkus Runtime 1: Car Management System"
        W[CarProcessingWorkflow] 
        DA["DispositionAgent&lt;br/&gt;@A2AClientAgent"]
        W --&gt; DA
    end

    subgraph "A2A Protocol Layer"
        AP[JSON-RPC over HTTP]
    end

    subgraph "Quarkus Runtime 2: Disposition Service"
        AC[AgentCard&lt;br/&gt;Agent Metadata]
        AE[AgentExecutor&lt;br/&gt;Request Handler]
        AI[DispositionAgent&lt;br/&gt;AI Service]
        T[DispositionTool]

        AC -.describes.-&gt; AI
        AE --&gt; AI
        AI --&gt; T
    end

    DA --&gt;|A2A Request| AP
    AP --&gt;|A2A Response| DA
    AP &lt;--&gt;|JSON-RPC| AE
</code></pre> 
    <div class="panzoom-info-box panzoom-info-box-bottom panzoom-hidden">
Hold "Alt" / "Option" to enable pan &amp; zoom
</div>
</div>
<p><strong>The Flow:</strong></p>
<ol>
<li><strong>Client agent</strong> (<code>DispositionAgent</code> with <code>@A2AClientAgent</code>) sends a request to the remote agent</li>
<li><strong>A2A Protocol Layer</strong> (<a href="https://www.jsonrpc.org/" target="_blank">JSON-RPC</a>) transports the request over HTTP</li>
<li><strong>AgentCard</strong> describes the remote agents capabilities (skills, inputs, outputs)</li>
<li><strong>AgentExecutor</strong> receives the request and orchestrates the execution</li>
<li><strong>Remote AI agent</strong> (<code>DispositionAgent</code> AI service) processes the request using tools</li>
<li>Response flows back through the same path</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Additional A2A Info</p>
<p>For more information about the A2A protocol and the actors involved, see the <a href="https://a2a-protocol.org/latest/topics/key-concepts/#core-actors-in-a2a-interactions" target="_blank">A2A documentation</a>. </p>
</div>
<hr>
<h2 id="understanding-tasks-vs-messages">Understanding Tasks vs. Messages<a class="headerlink" href="#understanding-tasks-vs-messages" title="Permanent link"></a></h2>
<p>The A2A protocol distinguishes between <a href="https://a2a-protocol.org/latest/topics/life-of-a-task/" target="_blank">two types of interactions</a>:</p>
<table>
<thead>
<tr>
<th>Concept</th>
<th>Description</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Task</strong></td>
<td>A long-running job with a defined goal and tracked state</td>
<td>Determine if this car should be scrapped</td>
</tr>
<tr>
<td><strong>Message</strong></td>
<td>A single conversational exchange with no tracked state</td>
<td>Chat messages, quick questions</td>
</tr>
</tbody>
</table>
<p>In this step, well use <strong>Tasks</strong> because car disposition analysis is a discrete job with a clear objective.</p>
<p><strong>Task Lifecycle:</strong></p>
<div class="panzoom-box" data-key="alt" id="panzoom0" oncontextmenu="return false;">
    
    <nav class="panzoom-nav">
    <button class="panzoom-info panzoom-button">
    <svg class="panzoom-icon" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm169.8-90.7c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"></path>
    </svg>
</button><button class="panzoom-reset panzoom-button">
    <svg class="panzoom-icon" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M125.7 160l50.3 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L48 224c-17.7 0-32-14.3-32-32L16 64c0-17.7 14.3-32 32-32s32 14.3 32 32l0 51.2L97.6 97.6c87.5-87.5 229.3-87.5 316.8 0s87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3s-163.8-62.5-226.3 0L125.7 160z"></path>
    </svg>
</button><button class="panzoom-max panzoom-button">
    <svg class="panzoom-icon" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M32 32C14.3 32 0 46.3 0 64l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L32 32zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM448 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96z"></path>
    </svg>
</button><button class="panzoom-min panzoom-button panzoom-hidden">
    <svg class="panzoom-icon" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M160 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96zM32 320c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM352 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 320c-17.7 0-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0z"></path>
    </svg>
</button>
    </nav>
    <pre class="mermaid"><code>sequenceDiagram
    participant Client as Client Agent
    participant Server as A2A Server
    participant Executor as AgentExecutor
    participant AI as AI Agent

    Client-&gt;&gt;Server: Create Task (POST /tasks)
    Server-&gt;&gt;Executor: Initialize TaskUpdater
    Executor-&gt;&gt;AI: Execute with input
    AI-&gt;&gt;AI: Process and use tools
    AI-&gt;&gt;Executor: Return result
    Executor-&gt;&gt;Server: Update task status
    Server-&gt;&gt;Client: Task result</code></pre> 
    <div class="panzoom-info-box panzoom-info-box-bottom panzoom-hidden">
Hold "Alt" / "Option" to enable pan &amp; zoom
</div>
</div>
<hr>
<h2 id="what-are-we-going-to-build">What Are We Going to Build?<a class="headerlink" href="#what-are-we-going-to-build" title="Permanent link"></a></h2>
<p><img alt="App Blueprint" class="center" src="../../images/agentic-app-4.png"></p>
<p>Well convert Step 4s architecture to use remote agents:</p>
<ol>
<li><strong>Keep DispositionFeedbackAgent</strong>: Still analyzes if a car should be disposed (same as Step 4)</li>
<li><strong>Convert DispositionAgent to A2A Client</strong>: Changes from local agent to remote A2A client</li>
<li><strong>Create Remote A2A Server</strong>: A separate Quarkus application exposing the disposition service</li>
<li><strong>Replace Supervisor with Conditional Workflow</strong>: Trade AI-driven orchestration for simpler rule-based routing (architectural trade-off for distribution)</li>
</ol>
<p><strong>The Complete Architecture:</strong></p>
<div class="panzoom-box" data-key="alt" id="panzoom0" oncontextmenu="return false;">
    
    <nav class="panzoom-nav">
    <button class="panzoom-info panzoom-button">
    <svg class="panzoom-icon" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm169.8-90.7c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"></path>
    </svg>
</button><button class="panzoom-reset panzoom-button">
    <svg class="panzoom-icon" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M125.7 160l50.3 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L48 224c-17.7 0-32-14.3-32-32L16 64c0-17.7 14.3-32 32-32s32 14.3 32 32l0 51.2L97.6 97.6c87.5-87.5 229.3-87.5 316.8 0s87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3s-163.8-62.5-226.3 0L125.7 160z"></path>
    </svg>
</button><button class="panzoom-max panzoom-button">
    <svg class="panzoom-icon" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M32 32C14.3 32 0 46.3 0 64l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L32 32zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM448 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96z"></path>
    </svg>
</button><button class="panzoom-min panzoom-button panzoom-hidden">
    <svg class="panzoom-icon" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M160 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96zM32 320c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM352 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 320c-17.7 0-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0z"></path>
    </svg>
</button>
    </nav>
    <pre class="mermaid"><code>graph TD
    subgraph "Main Application (localhost:8080)"
        R[Rental/Cleaning/Maintenance Returns]
        FW[FeedbackWorkflow&lt;br/&gt;Parallel]
        DFA[DispositionFeedbackAgent]
        AW[CarAssignmentWorkflow&lt;br/&gt;Conditional]
        DAC["DispositionAgent&lt;br/&gt;@A2AClientAgent"]

        R --&gt; FW
        FW --&gt; DFA
        DFA --&gt; AW
        AW --&gt; DAC
    end

    subgraph "Remote Disposition Service (localhost:8888)"
        AC[AgentCard]
        AE[AgentExecutor]
        DAI[DispositionAgent&lt;br/&gt;AI Service]
        DT[DispositionTool]

        AE --&gt; DAI
        DAI --&gt; DT
    end

    DAC --&gt;|A2A Protocol| AE
</code></pre> 
    <div class="panzoom-info-box panzoom-info-box-bottom panzoom-hidden">
Hold "Alt" / "Option" to enable pan &amp; zoom
</div>
</div>
<hr>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link"></a></h2>
<p>Before starting:</p>
<ul>
<li><strong>Completed <a href="../step-04/" target="_blank">Step 04</a></strong> - This step directly builds on Step 4s disposition functionality</li>
<li>Application from Step 04 is stopped (Ctrl+C)</li>
<li>Ports 8080 and 8888 are available (youll run two applications simultaneously)</li>
<li>Understanding of Step 4s Supervisor Pattern (well be replacing it with a simpler pattern)</li>
</ul>
<hr>
<h2 id="understanding-the-project-structure">Understanding the Project Structure<a class="headerlink" href="#understanding-the-project-structure" title="Permanent link"></a></h2>
<p>The Step 05 code includes <strong>two separate Quarkus applications</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>section-2/step-05/
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a> multi-agent-system/          # Main car management application (port 8080)
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    src/main/java/com/carmanagement/
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>       agentic/
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>          agents/
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>             DispositionAgent.java          # A2A client agent
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>             DispositionFeedbackAgent.java  # Analyzes disposal needs
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>          workflow/
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>              FeedbackWorkflow.java          # Parallel analysis
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>              CarAssignmentWorkflow.java     # Conditional routing
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>              CarProcessingWorkflow.java     # Main orchestrator
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    pom.xml
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a> remote-a2a-agent/            # Remote disposition service (port 8888)
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>     src/main/java/com/demo/
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        DispositionAgentCard.java       # Describes agent capabilities
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        DispositionAgentExecutor.java   # Handles A2A requests
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        DispositionAgent.java           # AI service
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        DispositionTool.java            # Tool for scrap/sell/donate
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>     pom.xml
</code></pre></div>
<p><strong>Why Two Applications?</strong></p>
<ul>
<li>Simulates a real-world scenario where different teams maintain different agents</li>
<li>The disposition service could be reused by multiple client applications</li>
<li>Demonstrates cross-application agent communication via A2A</li>
</ul>
<hr>
<div class="admonition warning">
<p class="admonition-title">Warning: this chapter involves many steps</p>
<p>In order to build out the solution, you will need to go through quite a few steps.
While it is entirely possible to make the code changes manually (or via copy/paste),
we recommend starting fresh from Step 05 with the changes already applied.
You will then be able to walk through this chapter and focus on the examples and suggested experiments at the end of this chapter.</p>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1">Option 2: Start Fresh from Step 05 [Recommended]</label><label for="__tabbed_1_2">Option 1: Continue from Step 04</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Navigate to the complete <code>section-2/step-05/multi-agent-system</code> directory:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">cd</span><span class="w"> </span>section-2/step-05/multi-agent-system
</code></pre></div>
</div>
<div class="tabbed-block">
<p>If you want to continue building on your previous code, place yourself at the root of your project and copy the updated files:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked id="__tabbed_2_1" name="__tabbed_2" type="radio"><input id="__tabbed_2_2" name="__tabbed_2" type="radio"><div class="tabbed-labels"><label for="__tabbed_2_1">Linux / macOS</label><label for="__tabbed_2_2">Windows</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>cp<span class="w"> </span>../step-05/multi-agent-system/pom.xml<span class="w"> </span>./pom.xml
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>cp<span class="w"> </span>../step-05/multi-agent-system/src/main/java/com/carmanagement/model/CarInfo.java<span class="w"> </span>./src/main/java/com/carmanagement/model/CarInfo.java
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>cp<span class="w"> </span>../step-05/multi-agent-system/src/main/java/com/carmanagement/model/CarStatus.java<span class="w"> </span>./src/main/java/com/carmanagement/model/CarStatus.java
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>cp<span class="w"> </span>../step-05/multi-agent-system/src/main/resources/META-INF/resources/css/styles.css<span class="w"> </span>./src/main/resources/META-INF/resources/css/styles.css
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>cp<span class="w"> </span>../step-05/multi-agent-system/src/main/resources/META-INF/resources/js/app.js<span class="w"> </span>./src/main/resources/META-INF/resources/js/app.js
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>cp<span class="w"> </span>../step-05/multi-agent-system/src/main/resources/META-INF/resources/index.html<span class="w"> </span>./src/main/resources/META-INF/resources/index.html
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>cp<span class="w"> </span>../step-05/multi-agent-system/src/main/resources/import.sql<span class="w"> </span>./src/main/resources/import.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>copy ..\step-05\multi-agent-system\pom.xml .\pom.xml
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>copy ..\step-05\multi-agent-system\src\main\java\com\carmanagement\model\CarInfo.java .\src\main\java\com\carmanagement\model\CarInfo.java
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>copy ..\step-05\multi-agent-system\src\main\java\com\carmanagement\model\CarStatus.java .\src\main\java\com\carmanagement\model\CarStatus.java
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>copy ..\step-05\multi-agent-system\src\main\resources\META-INF\resources\css\styles.css .\src\main\resources\META-INF\resources\css\styles.css
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>copy ..\step-05\multi-agent-system\src\main\resources\META-INF\resources\js\app.js .\src\main\resources\META-INF\resources\js\app.js
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>copy ..\step-05\multi-agent-system\src\main\resources\META-INF\resources\index.html .\src\main\resources\META-INF\resources\index.html
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>copy ..\step-05\multi-agent-system\src\main\resources\import.sql .\src\main\resources\import.sql
</code></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr>
<h2 id="part-1-build-the-client-side-components">Part 1: Build the Client-Side Components<a class="headerlink" href="#part-1-build-the-client-side-components" title="Permanent link"></a></h2>
<h3 id="step-1-update-the-dispositionfeedbackagent">Step 1: Update the DispositionFeedbackAgent<a class="headerlink" href="#step-1-update-the-dispositionfeedbackagent" title="Permanent link"></a></h3>
<p>This agent is similar to Step 4s version but with a simplified system message. In Step 4, we had more sophisticated keyword detection; here we simplify it for the A2A example.</p>
<p>In <code>src/main/java/com/carmanagement/agentic/agents</code>, update <code>DispositionFeedbackAgent.java</code>:</p>
<div class="highlight"><span class="filename">DispositionFeedbackAgent.java</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents</span><span class="p">;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.Agent</span><span class="p">;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.service.SystemMessage</span><span class="p">;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.service.UserMessage</span><span class="p">;</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="cm">/**</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="cm"> * Agent that analyzes feedback to determine if a car should be disposed of.</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="cm"> */</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">DispositionFeedbackAgent</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">    </span><span class="nd">@SystemMessage</span><span class="p">(</span><span class="s">"""</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="s">        You are a car disposition analyzer for a car rental company. Your job is to determine if a car should be disposed of based on feedback.</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="s">        Analyze the maintenance feedback and car information to decide if the car should be scrapped, sold, or donated.</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="hll"><span class="s">        If the car is in decent shape, respond with "DISPOSITION_NOT_REQUIRED".</span>
</span><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="s">        Include the reason for your choice but keep your response short.</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="s">        """</span><span class="p">)</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">    </span><span class="nd">@UserMessage</span><span class="p">(</span><span class="s">"""</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="s">        Car Information:</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="s">        Make: {carMake}</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="s">        Model: {carModel}</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="s">        Year: {carYear}</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="s">        Previous Condition: {carCondition}</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a><span class="s">        Feedback:</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="s">        Rental Feedback: {rentalFeedback}</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="s">        Cleaning Feedback: {cleaningFeedback}</span>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="s">        Maintenance Feedback: {maintenanceFeedback}</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="s">        """</span><span class="p">)</span>
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a><span class="hll"><span class="w">    </span><span class="nd">@Agent</span><span class="p">(</span><span class="n">outputKey</span><span class="o">=</span><span class="s">"dispositionRequest"</span><span class="p">,</span><span class="w"> </span><span class="n">description</span><span class="o">=</span><span class="s">"Car disposition analyzer. Using feedback, determines if a car should be disposed of."</span><span class="p">)</span>
</span><a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">analyzeForDisposition</span><span class="p">(</span>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a><span class="hll"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">rentalFeedback</span><span class="p">,</span>
</span><a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a><span class="hll"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">cleaningFeedback</span><span class="p">,</span>
</span><a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a><span class="hll"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceFeedback</span><span class="p">);</span>
</span><a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key Points:</strong></p>
<ul>
<li><strong>System message</strong>: Focuses on economic viability (is the car worth repairing?)</li>
<li><strong>Specific output format</strong>: Returns <code>"DISPOSITION_NOT_REQUIRED"</code> when the car is repairable</li>
<li><strong>outputKey</strong>: <code>"dispositionRequest"</code> (stores the analysis in AgenticScopes state)</li>
<li><strong>Three feedback sources</strong>: Analyzes rental, cleaning, and maintenance feedback</li>
</ul>
<p><strong>Decision Criteria:</strong></p>
<p>The agent considers:</p>
<ul>
<li>Severity of damage (structural, engine, transmission)</li>
<li>Repair costs vs. car value</li>
<li>Age and condition of the vehicle</li>
<li>Safety concerns</li>
</ul>
<h3 id="step-2-convert-the-dispositionagent-to-a2a-client">Step 2: Convert the DispositionAgent to A2A Client<a class="headerlink" href="#step-2-convert-the-dispositionagent-to-a2a-client" title="Permanent link"></a></h3>
<p><strong>This is the key change from Step 4!</strong> Instead of a local agent with full system messages and logic, we now have a simple client that delegates to a remote service.</p>
<p><strong>Step 4 Version (Local):</strong>
- Had detailed <code>@SystemMessage</code> with disposition criteria
- Received <code>carValue</code> parameter from PricingAgent
- Made decisions locally using AI</p>
<p><strong>Step 5 Version (A2A Client):</strong>
- No <code>@SystemMessage</code> - just a client interface
- Uses <code>@A2AClientAgent</code> to connect to remote service
- Receives <code>dispositionRequest</code> instead of <code>carValue</code>
- Delegates all decision-making to the remote service</p>
<p>In <code>src/main/java/com/carmanagement/agentic/agents</code>, update <code>DispositionAgent.java</code>:</p>
<div class="highlight"><span class="filename">DispositionAgent.java</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents</span><span class="p">;</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.Agent</span><span class="p">;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.A2AClientAgent</span><span class="p">;</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="cm">/**</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="cm"> * Agent that determines how to dispose of a car.</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="cm"> */</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">DispositionAgent</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">    </span><span class="nd">@Agent</span><span class="p">(</span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Car disposition specialist. Determines how to dispose of a car."</span><span class="p">,</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">           </span><span class="n">outputKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"dispositionAction"</span><span class="p">)</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="hll"><span class="w">    </span><span class="nd">@A2AClientAgent</span><span class="p">(</span><span class="n">a2aServerUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"http://localhost:8888"</span><span class="p">)</span>
</span><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">processDisposition</span><span class="p">(</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">);</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Lets break it down:</strong></p>
<h4 id="a2aclientagent-annotation"><code>@A2AClientAgent</code> Annotation<a class="headerlink" href="#a2aclientagent-annotation" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nd">@A2AClientAgent</span><span class="p">(</span><span class="n">a2aServerUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"http://localhost:8888"</span><span class="p">)</span>
</code></pre></div>
<p>This annotation transforms the method into an <strong>A2A client</strong>:</p>
<ul>
<li><strong><code>a2aServerUrl</code></strong>: The URL of the remote A2A server</li>
</ul>
<h4 id="the-method-signature">The Method Signature<a class="headerlink" href="#the-method-signature" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">String</span><span class="w"> </span><span class="nf">processDisposition</span><span class="p">(</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="p">)</span>
</code></pre></div>
<p>These parameters are sent to the remote agent as task inputs. 
The remote agent can access them by name.</p>
<h4 id="how-it-works">How It Works<a class="headerlink" href="#how-it-works" title="Permanent link"></a></h4>
<ol>
<li>
<p>When this method is called, Quarkus LangChain4j:</p>
<ol>
<li>Creates an A2A Task with the method parameters as inputs</li>
<li>Sends the task to the remote server via JSON-RPC</li>
<li>Waits for the remote agent to complete the task</li>
<li>Returns the result as a String</li>
</ol>
</li>
<li>
<p>No manual HTTP requests needed</p>
</li>
<li>Type-safe: compile-time checking of parameters</li>
<li>Automatic error handling and retries</li>
</ol>
<hr>
<h2 id="part-2-update-the-workflows">Part 2: Update the Workflows<a class="headerlink" href="#part-2-update-the-workflows" title="Permanent link"></a></h2>
<h3 id="step-3-update-feedbackworkflow">Step 3: Update FeedbackWorkflow<a class="headerlink" href="#step-3-update-feedbackworkflow" title="Permanent link"></a></h3>
<p>The <code>FeedbackWorkflow</code> is the same as Step 4 - it includes disposition analysis alongside cleaning and maintenance.</p>
<p>Update <code>src/main/java/com/carmanagement/agentic/workflow/FeedbackWorkflow.java</code>:</p>
<div class="highlight"><span class="filename">FeedbackWorkflow.java</span><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.workflow</span><span class="p">;</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.CleaningFeedbackAgent</span><span class="p">;</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.DispositionFeedbackAgent</span><span class="p">;</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.MaintenanceFeedbackAgent</span><span class="p">;</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.ParallelAgent</span><span class="p">;</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="cm">/**</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="cm"> * Workflow for processing car feedback in parallel.</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="cm"> */</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">FeedbackWorkflow</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">    </span><span class="cm">/**</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="cm">     * Runs multiple feedback agents in parallel to analyze different aspects of car feedback.</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="cm">     */</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="hll"><span class="w">    </span><span class="nd">@ParallelAgent</span><span class="p">(</span><span class="n">outputKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"feedbackResult"</span><span class="p">,</span>
</span><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="hll"><span class="w">            </span><span class="n">subAgents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">CleaningFeedbackAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">MaintenanceFeedbackAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">DispositionFeedbackAgent</span><span class="p">.</span><span class="na">class</span><span class="w"> </span><span class="p">})</span>
</span><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">analyzeFeedback</span><span class="p">(</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">rentalFeedback</span><span class="p">,</span>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">cleaningFeedback</span><span class="p">,</span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceFeedback</span><span class="p">);</span>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key changes:</strong></p>
<p>Added <code>DispositionFeedbackAgent</code> to the parallel workflow:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nd">@ParallelAgent</span><span class="p">(</span><span class="n">outputKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"feedbackResult"</span><span class="p">,</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">            </span><span class="n">subAgents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">CleaningFeedbackAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">MaintenanceFeedbackAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">DispositionFeedbackAgent</span><span class="p">.</span><span class="na">class</span><span class="w"> </span><span class="p">})</span>
</code></pre></div>
<p>Now <strong>three agents run concurrently</strong>:</p>
<ul>
<li><code>CleaningFeedbackAgent</code>  analyzes cleaning needs</li>
<li><code>MaintenanceFeedbackAgent</code>  analyzes maintenance needs</li>
<li><code>DispositionFeedbackAgent</code>  analyzes disposal needs</li>
</ul>
<p>This parallel execution is efficient: all three analyses happen at the same time!</p>
<h3 id="step-4-create-carassignmentworkflow">Step 4: Create CarAssignmentWorkflow<a class="headerlink" href="#step-4-create-carassignmentworkflow" title="Permanent link"></a></h3>
<p><strong>Key Architectural Change from Step 4:</strong></p>
<p>In Step 4, we used <code>FleetSupervisorAgent</code> with <code>@SupervisorAgent</code> - an AI-driven orchestrator that made intelligent decisions about which agents to invoke.</p>
<p>In Step 5, were replacing it with <code>CarAssignmentWorkflow</code> using <code>@ConditionalAgent</code> - a simpler, rule-based router.</p>
<p><strong>Why the change?</strong>
- <strong>Trade-off for distribution</strong>: The Supervisor Pattern requires all sub-agents to be local. To use remote agents via A2A, we need a simpler routing mechanism.
- <strong>Simpler but less flexible</strong>: Conditional routing uses hardcoded rules instead of AI reasoning.
- <strong>Still effective</strong>: For this use case, rule-based routing works well.</p>
<p>Create <code>src/main/java/com/carmanagement/agentic/workflow/CarAssignmentWorkflow.java</code>:</p>
<div class="highlight"><span class="filename">CarAssignmentWorkflow.java</span><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.workflow</span><span class="p">;</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.CleaningAgent</span><span class="p">;</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.DispositionAgent</span><span class="p">;</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.MaintenanceAgent</span><span class="p">;</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.ActivationCondition</span><span class="p">;</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.ConditionalAgent</span><span class="p">;</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="cm">/**</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="cm"> * Workflow for assigning cars to appropriate teams based on feedback analysis.</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="cm"> */</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">CarAssignmentWorkflow</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">    </span><span class="cm">/**</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="cm">     * Assigns the car to the appropriate team based on the feedback analysis.</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="cm">     */</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="hll"><span class="w">    </span><span class="nd">@ConditionalAgent</span><span class="p">(</span><span class="n">outputKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"analysisResult"</span><span class="p">,</span>
</span><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="hll"><span class="w">            </span><span class="n">subAgents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">DispositionAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">MaintenanceAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">CleaningAgent</span><span class="p">.</span><span class="na">class</span><span class="w"> </span><span class="p">})</span>
</span><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">processAction</span><span class="p">(</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">cleaningRequest</span><span class="p">,</span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceRequest</span><span class="p">,</span>
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">);</span>
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="w">    </span><span class="nd">@ActivationCondition</span><span class="p">(</span><span class="n">MaintenanceAgent</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">assignToMaintenance</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">isRequired</span><span class="p">(</span><span class="n">maintenanceRequest</span><span class="p">);</span>
<a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a>
<a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="w">    </span><span class="nd">@ActivationCondition</span><span class="p">(</span><span class="n">CleaningAgent</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">assignToCleaning</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">cleaningRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">isRequired</span><span class="p">(</span><span class="n">cleaningRequest</span><span class="p">);</span>
<a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a>
<a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="hll"><span class="w">    </span><span class="nd">@ActivationCondition</span><span class="p">(</span><span class="n">DispositionAgent</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
</span><a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="hll"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">assignToDisposition</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">isRequired</span><span class="p">(</span><span class="n">dispositionRequest</span><span class="p">);</span>
</span><a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a>
<a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isRequired</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">value</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">value</span><span class="p">.</span><span class="na">toUpperCase</span><span class="p">().</span><span class="na">contains</span><span class="p">(</span><span class="s">"NOT_REQUIRED"</span><span class="p">);</span>
<a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key changes:</strong></p>
<h4 id="added-dispositionagent-to-subagents">Added DispositionAgent to SubAgents<a class="headerlink" href="#added-dispositionagent-to-subagents" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nd">@ConditionalAgent</span><span class="p">(</span><span class="n">outputKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"analysisResult"</span><span class="p">,</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">            </span><span class="n">subAgents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">DispositionAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">MaintenanceAgent</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">CleaningAgent</span><span class="p">.</span><span class="na">class</span><span class="w"> </span><span class="p">})</span>
</code></pre></div>
<h4 id="added-activation-condition">Added Activation Condition<a class="headerlink" href="#added-activation-condition" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nd">@ActivationCondition</span><span class="p">(</span><span class="n">DispositionAgent</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">assignToDisposition</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">isRequired</span><span class="p">(</span><span class="n">dispositionRequest</span><span class="p">);</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="p">}</span>
</code></pre></div>
<h4 id="updated-execution-priority">Updated Execution Priority<a class="headerlink" href="#updated-execution-priority" title="Permanent link"></a></h4>
<p>The conditional workflow now has <strong>priority ordering</strong>:</p>
<ol>
<li><strong>Disposition</strong> (highest priority)  if disposal is needed</li>
<li><strong>Maintenance</strong>  if maintenance is needed and disposal isnt</li>
<li><strong>Cleaning</strong>  if cleaning is needed and neither disposal nor maintenance is</li>
<li><strong>Skip</strong>  if nothing is needed</li>
</ol>
<p>This ensures critical issues (disposal) are handled before routine tasks (cleaning).</p>
<h3 id="step-5-update-carprocessingworkflow">Step 5: Update CarProcessingWorkflow<a class="headerlink" href="#step-5-update-carprocessingworkflow" title="Permanent link"></a></h3>
<p><strong>Change from Step 4:</strong></p>
<p>Step 4 used: <code>FeedbackWorkflow  FleetSupervisorAgent  CarConditionFeedbackAgent</code></p>
<p>Step 5 uses: <code>FeedbackWorkflow  CarAssignmentWorkflow  CarConditionFeedbackAgent</code></p>
<p>Weve replaced the AI-driven supervisor with rule-based conditional routing.</p>
<p>Update <code>src/main/java/com/carmanagement/agentic/workflow/CarProcessingWorkflow.java</code>:</p>
<div class="highlight"><span class="filename">CarProcessingWorkflow.java</span><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.workflow</span><span class="p">;</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.agents.CarConditionFeedbackAgent</span><span class="p">;</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.model.CarConditions</span><span class="p">;</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.model.CarAssignment</span><span class="p">;</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.Output</span><span class="p">;</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agentic.declarative.SequenceAgent</span><span class="p">;</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="cm">/**</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="cm"> * Workflow for processing car returns using a sequence of agents.</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="cm"> */</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">CarProcessingWorkflow</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="w">    </span><span class="cm">/**</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="cm">     * Processes a car return by running feedback analysis and then appropriate actions.</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="cm">     */</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">    </span><span class="nd">@SequenceAgent</span><span class="p">(</span><span class="n">outputKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"carProcessingAgentResult"</span><span class="p">,</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="w">            </span><span class="n">subAgents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">FeedbackWorkflow</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">CarAssignmentWorkflow</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">CarConditionFeedbackAgent</span><span class="p">.</span><span class="na">class</span><span class="w"> </span><span class="p">})</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="w">    </span><span class="n">CarConditions</span><span class="w"> </span><span class="nf">processCarReturn</span><span class="p">(</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">rentalFeedback</span><span class="p">,</span>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">cleaningFeedback</span><span class="p">,</span>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceFeedback</span><span class="p">);</span>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="w">    </span><span class="nd">@Output</span>
<a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">CarConditions</span><span class="w"> </span><span class="nf">output</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceRequest</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">cleaningRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="w">        </span><span class="n">CarAssignment</span><span class="w"> </span><span class="n">carAssignment</span><span class="p">;</span>
<a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="w">        </span><span class="c1">// Check maintenance first (higher priority)</span>
<a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRequired</span><span class="p">(</span><span class="n">dispositionRequest</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a><span class="w">            </span><span class="n">carAssignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarAssignment</span><span class="p">.</span><span class="na">DISPOSITION</span><span class="p">;</span>
<a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRequired</span><span class="p">(</span><span class="n">maintenanceRequest</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a><span class="w">            </span><span class="n">carAssignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarAssignment</span><span class="p">.</span><span class="na">MAINTENANCE</span><span class="p">;</span>
<a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRequired</span><span class="p">(</span><span class="n">cleaningRequest</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a><span class="w">            </span><span class="n">carAssignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarAssignment</span><span class="p">.</span><span class="na">CLEANING</span><span class="p">;</span>
<a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a><span class="w">            </span><span class="n">carAssignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarAssignment</span><span class="p">.</span><span class="na">NONE</span><span class="p">;</span>
<a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-13-42" name="__codelineno-13-42" href="#__codelineno-13-42"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CarConditions</span><span class="p">(</span><span class="n">carCondition</span><span class="p">,</span><span class="w"> </span><span class="n">carAssignment</span><span class="p">);</span>
<a id="__codelineno-13-43" name="__codelineno-13-43" href="#__codelineno-13-43"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-44" name="__codelineno-13-44" href="#__codelineno-13-44"></a>
<a id="__codelineno-13-45" name="__codelineno-13-45" href="#__codelineno-13-45"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isRequired</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-46" name="__codelineno-13-46" href="#__codelineno-13-46"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">value</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">value</span><span class="p">.</span><span class="na">toUpperCase</span><span class="p">().</span><span class="na">contains</span><span class="p">(</span><span class="s">"NOT_REQUIRED"</span><span class="p">);</span>
<a id="__codelineno-13-47" name="__codelineno-13-47" href="#__codelineno-13-47"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-48" name="__codelineno-13-48" href="#__codelineno-13-48"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key changes:</strong></p>
<p>The <code>@Output</code> method now checks for disposition requests first:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nd">@Output</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="kd">static</span><span class="w"> </span><span class="n">CarConditions</span><span class="w"> </span><span class="nf">output</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceRequest</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">cleaningRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="n">CarAssignment</span><span class="w"> </span><span class="n">carAssignment</span><span class="p">;</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="c1">// Check maintenance first (higher priority)</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRequired</span><span class="p">(</span><span class="n">dispositionRequest</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">   </span><span class="c1">// Highest priority</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">        </span><span class="n">carAssignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarAssignment</span><span class="p">.</span><span class="na">DISPOSITION</span><span class="p">;</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRequired</span><span class="p">(</span><span class="n">maintenanceRequest</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">        </span><span class="n">carAssignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarAssignment</span><span class="p">.</span><span class="na">MAINTENANCE</span><span class="p">;</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isRequired</span><span class="p">(</span><span class="n">cleaningRequest</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">        </span><span class="n">carAssignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarAssignment</span><span class="p">.</span><span class="na">CLEANING</span><span class="p">;</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="w">        </span><span class="n">carAssignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarAssignment</span><span class="p">.</span><span class="na">NONE</span><span class="p">;</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CarConditions</span><span class="p">(</span><span class="n">carCondition</span><span class="p">,</span><span class="w"> </span><span class="n">carAssignment</span><span class="p">);</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="p">}</span>
</code></pre></div>
<p>Disposition has the highest priority in the result.</p>
<h3 id="step-6-update-carassignment-enum">Step 6: Update CarAssignment Enum<a class="headerlink" href="#step-6-update-carassignment-enum" title="Permanent link"></a></h3>
<p>Update the <code>CarAssignment</code> enum to include disposition:</p>
<p>Update <code>src/main/java/com/carmanagement/model/CarAssignment.java</code>:</p>
<div class="highlight"><span class="filename">CarAssignment.java</span><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.model</span><span class="p">;</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="cm">/**</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="cm"> * Enum representing the type of possible car assignments for car processing</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="cm"> */</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">CarAssignment</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="hll"><span class="w">    </span><span class="n">DISPOSITION</span><span class="p">,</span>
</span><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">    </span><span class="n">MAINTENANCE</span><span class="p">,</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">    </span><span class="n">CLEANING</span><span class="p">,</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">    </span><span class="n">NONE</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="p">}</span>
</code></pre></div>
<h3 id="step-7-update-carmanagementservice">Step 7: Update CarManagementService<a class="headerlink" href="#step-7-update-carmanagementservice" title="Permanent link"></a></h3>
<p>Update the service to handle disposition status:</p>
<p>Update <code>src/main/java/com/carmanagement/service/CarManagementService.java</code>:</p>
<div class="highlight"><span class="filename">CarManagementService.java</span><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.carmanagement.service</span><span class="p">;</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.enterprise.context.ApplicationScoped</span><span class="p">;</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.inject.Inject</span><span class="p">;</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.transaction.Transactional</span><span class="p">;</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.agentic.workflow.CarProcessingWorkflow</span><span class="p">;</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.model.CarConditions</span><span class="p">;</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.model.CarInfo</span><span class="p">;</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.carmanagement.model.CarStatus</span><span class="p">;</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="cm">/**</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="cm"> * Service for managing car returns from various operations.</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="cm"> */</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="nd">@ApplicationScoped</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CarManagementService</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="w">    </span><span class="nd">@Inject</span>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="w">    </span><span class="n">CarProcessingWorkflow</span><span class="w"> </span><span class="n">carProcessingWorkflow</span><span class="p">;</span>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="w">    </span><span class="cm">/**</span>
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="cm">     * Process a car return from any operation.</span>
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="cm">     *</span>
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="cm">     * @param carNumber The car number</span>
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="cm">     * @param rentalFeedback Optional rental feedback</span>
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="cm">     * @param cleaningFeedback Optional cleaning feedback</span>
<a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="cm">     * @param maintenanceFeedback Optional maintenance feedback</span>
<a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a><span class="cm">     * @return Result of the processing</span>
<a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a><span class="cm">     */</span>
<a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a><span class="w">    </span><span class="nd">@Transactional</span>
<a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">processCarReturn</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">rentalFeedback</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">cleaningFeedback</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">maintenanceFeedback</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a><span class="w">        </span><span class="n">CarInfo</span><span class="w"> </span><span class="n">carInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarInfo</span><span class="p">.</span><span class="na">findById</span><span class="p">(</span><span class="n">carNumber</span><span class="p">);</span>
<a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">carInfo</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">"Car not found with number: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">carNumber</span><span class="p">;</span>
<a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a>
<a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a><span class="w">        </span><span class="c1">// Process the car return using the workflow and get the AgenticScope</span>
<a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a><span class="w">        </span><span class="n">CarConditions</span><span class="w"> </span><span class="n">carConditions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">carProcessingWorkflow</span><span class="p">.</span><span class="na">processCarReturn</span><span class="p">(</span>
<a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a><span class="w">                </span><span class="n">carInfo</span><span class="p">.</span><span class="na">make</span><span class="p">,</span>
<a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a><span class="w">                </span><span class="n">carInfo</span><span class="p">.</span><span class="na">model</span><span class="p">,</span>
<a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a><span class="w">                </span><span class="n">carInfo</span><span class="p">.</span><span class="na">year</span><span class="p">,</span>
<a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a><span class="w">                </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-16-43" name="__codelineno-16-43" href="#__codelineno-16-43"></a><span class="w">                </span><span class="n">carInfo</span><span class="p">.</span><span class="na">condition</span><span class="p">,</span>
<a id="__codelineno-16-44" name="__codelineno-16-44" href="#__codelineno-16-44"></a><span class="w">                </span><span class="n">rentalFeedback</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">rentalFeedback</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">""</span><span class="p">,</span>
<a id="__codelineno-16-45" name="__codelineno-16-45" href="#__codelineno-16-45"></a><span class="w">                </span><span class="n">cleaningFeedback</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">cleaningFeedback</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">""</span><span class="p">,</span>
<a id="__codelineno-16-46" name="__codelineno-16-46" href="#__codelineno-16-46"></a><span class="w">                </span><span class="n">maintenanceFeedback</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">maintenanceFeedback</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">""</span><span class="p">);</span>
<a id="__codelineno-16-47" name="__codelineno-16-47" href="#__codelineno-16-47"></a>
<a id="__codelineno-16-48" name="__codelineno-16-48" href="#__codelineno-16-48"></a><span class="w">        </span><span class="c1">// Update the car's condition with the result from CarConditionFeedbackAgent</span>
<a id="__codelineno-16-49" name="__codelineno-16-49" href="#__codelineno-16-49"></a><span class="w">        </span><span class="n">carInfo</span><span class="p">.</span><span class="na">condition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">carConditions</span><span class="p">.</span><span class="na">generalCondition</span><span class="p">();</span>
<a id="__codelineno-16-50" name="__codelineno-16-50" href="#__codelineno-16-50"></a>
<a id="__codelineno-16-51" name="__codelineno-16-51" href="#__codelineno-16-51"></a><span class="w">        </span><span class="c1">// Update the car status based on the required action</span>
<a id="__codelineno-16-52" name="__codelineno-16-52" href="#__codelineno-16-52"></a><span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">carConditions</span><span class="p">.</span><span class="na">carAssignment</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-53" name="__codelineno-16-53" href="#__codelineno-16-53"></a><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">DISPOSITION</span><span class="p">:</span>
<a id="__codelineno-16-54" name="__codelineno-16-54" href="#__codelineno-16-54"></a><span class="hll"><span class="w">                </span><span class="n">carInfo</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarStatus</span><span class="p">.</span><span class="na">PENDING_DISPOSITION</span><span class="p">;</span>
</span><a id="__codelineno-16-55" name="__codelineno-16-55" href="#__codelineno-16-55"></a><span class="hll"><span class="w">                </span><span class="k">break</span><span class="p">;</span>
</span><a id="__codelineno-16-56" name="__codelineno-16-56" href="#__codelineno-16-56"></a><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">MAINTENANCE</span><span class="p">:</span>
<a id="__codelineno-16-57" name="__codelineno-16-57" href="#__codelineno-16-57"></a><span class="w">                </span><span class="n">carInfo</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarStatus</span><span class="p">.</span><span class="na">IN_MAINTENANCE</span><span class="p">;</span>
<a id="__codelineno-16-58" name="__codelineno-16-58" href="#__codelineno-16-58"></a><span class="w">                </span><span class="k">break</span><span class="p">;</span>
<a id="__codelineno-16-59" name="__codelineno-16-59" href="#__codelineno-16-59"></a><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">CLEANING</span><span class="p">:</span>
<a id="__codelineno-16-60" name="__codelineno-16-60" href="#__codelineno-16-60"></a><span class="w">                </span><span class="n">carInfo</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarStatus</span><span class="p">.</span><span class="na">AT_CLEANING</span><span class="p">;</span>
<a id="__codelineno-16-61" name="__codelineno-16-61" href="#__codelineno-16-61"></a><span class="w">                </span><span class="k">break</span><span class="p">;</span>
<a id="__codelineno-16-62" name="__codelineno-16-62" href="#__codelineno-16-62"></a><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">NONE</span><span class="p">:</span>
<a id="__codelineno-16-63" name="__codelineno-16-63" href="#__codelineno-16-63"></a><span class="w">                </span><span class="n">carInfo</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarStatus</span><span class="p">.</span><span class="na">AVAILABLE</span><span class="p">;</span>
<a id="__codelineno-16-64" name="__codelineno-16-64" href="#__codelineno-16-64"></a><span class="w">                </span><span class="k">break</span><span class="p">;</span>
<a id="__codelineno-16-65" name="__codelineno-16-65" href="#__codelineno-16-65"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-16-66" name="__codelineno-16-66" href="#__codelineno-16-66"></a>
<a id="__codelineno-16-67" name="__codelineno-16-67" href="#__codelineno-16-67"></a><span class="w">        </span><span class="c1">// Persist the changes to the database</span>
<a id="__codelineno-16-68" name="__codelineno-16-68" href="#__codelineno-16-68"></a><span class="w">        </span><span class="n">carInfo</span><span class="p">.</span><span class="na">persist</span><span class="p">();</span>
<a id="__codelineno-16-69" name="__codelineno-16-69" href="#__codelineno-16-69"></a>
<a id="__codelineno-16-70" name="__codelineno-16-70" href="#__codelineno-16-70"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">carConditions</span><span class="p">.</span><span class="na">generalCondition</span><span class="p">();</span>
<a id="__codelineno-16-71" name="__codelineno-16-71" href="#__codelineno-16-71"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-16-72" name="__codelineno-16-72" href="#__codelineno-16-72"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key changes:</strong></p>
<p>Added handling for <code>CarAssignment.DISPOSITION</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">carConditions</span><span class="p">.</span><span class="na">carAssignment</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">CarAssignment</span><span class="p">.</span><span class="na">DISPOSITION</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">    </span><span class="n">carInfo</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CarStatus</span><span class="p">.</span><span class="na">PENDING_DISPOSITION</span><span class="p">;</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="p">}</span>
</code></pre></div>
<p>When disposition is required, the car is marked as disposed and removed from the active fleet.</p>
<hr>
<h2 id="part-3-build-the-remote-a2a-server">Part 3: Build the Remote A2A Server<a class="headerlink" href="#part-3-build-the-remote-a2a-server" title="Permanent link"></a></h2>
<p>Now lets build the remote disposition service that will handle A2A requests.</p>
<p>Navigate to the remote-a2a-agent directory:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nb">cd</span><span class="w"> </span>section-2/step-05/remote-a2a-agent
</code></pre></div>
<h3 id="step-8-create-the-dispositiontool">Step 8: Create the DispositionTool<a class="headerlink" href="#step-8-create-the-dispositiontool" title="Permanent link"></a></h3>
<p>The tool that executes disposition actions (scrap, sell, donate).</p>
<p>In <code>src/main/java/com/demo</code>, create <code>DispositionTool.java</code>:</p>
<div class="highlight"><span class="filename">DispositionTool.java</span><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.demo</span><span class="p">;</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.agent.tool.Tool</span><span class="p">;</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.inject.Singleton</span><span class="p">;</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="cm">/**</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="cm"> * Tool for requesting car disposition operations.</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="cm"> * This tool is used by the LLM to determine the appropriate disposition for a car.</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="cm"> */</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="nd">@Singleton</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DispositionTool</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="w">    </span><span class="cm">/**</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="cm">     * Enum representing the possible disposition options for a car.</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="cm">     */</span>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">DispositionOption</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="w">        </span><span class="n">SCRAP</span><span class="p">(</span><span class="s">"Scrap the car"</span><span class="p">),</span>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a><span class="w">        </span><span class="n">SELL</span><span class="p">(</span><span class="s">"Sell the car"</span><span class="p">),</span>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a><span class="w">        </span><span class="n">DONATE</span><span class="p">(</span><span class="s">"Donate the car"</span><span class="p">);</span>
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a>
<a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a><span class="w">        </span><span class="n">DispositionOption</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">description</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>
<a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a>
<a id="__codelineno-19-28" name="__codelineno-19-28" href="#__codelineno-19-28"></a><span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getDescription</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-29" name="__codelineno-19-29" href="#__codelineno-19-29"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>
<a id="__codelineno-19-30" name="__codelineno-19-30" href="#__codelineno-19-30"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-19-31" name="__codelineno-19-31" href="#__codelineno-19-31"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-19-32" name="__codelineno-19-32" href="#__codelineno-19-32"></a>
<a id="__codelineno-19-33" name="__codelineno-19-33" href="#__codelineno-19-33"></a><span class="w">    </span><span class="cm">/**</span>
<a id="__codelineno-19-34" name="__codelineno-19-34" href="#__codelineno-19-34"></a><span class="cm">     * Requests disposition for a car based on the provided parameters.</span>
<a id="__codelineno-19-35" name="__codelineno-19-35" href="#__codelineno-19-35"></a><span class="cm">     *</span>
<a id="__codelineno-19-36" name="__codelineno-19-36" href="#__codelineno-19-36"></a><span class="cm">     * @param carNumber The car number</span>
<a id="__codelineno-19-37" name="__codelineno-19-37" href="#__codelineno-19-37"></a><span class="cm">     * @param carMake The car make</span>
<a id="__codelineno-19-38" name="__codelineno-19-38" href="#__codelineno-19-38"></a><span class="cm">     * @param carModel The car model</span>
<a id="__codelineno-19-39" name="__codelineno-19-39" href="#__codelineno-19-39"></a><span class="cm">     * @param carYear The car year</span>
<a id="__codelineno-19-40" name="__codelineno-19-40" href="#__codelineno-19-40"></a><span class="cm">     * @param dispositionOption The disposition option (SCRAP, SELL, or DONATE)</span>
<a id="__codelineno-19-41" name="__codelineno-19-41" href="#__codelineno-19-41"></a><span class="cm">     * @param carCondition The condition of the car</span>
<a id="__codelineno-19-42" name="__codelineno-19-42" href="#__codelineno-19-42"></a><span class="cm">     * @return A summary of the disposition request</span>
<a id="__codelineno-19-43" name="__codelineno-19-43" href="#__codelineno-19-43"></a><span class="cm">     */</span>
<a id="__codelineno-19-44" name="__codelineno-19-44" href="#__codelineno-19-44"></a><span class="w">    </span><span class="nd">@Tool</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"DispositionTool"</span><span class="p">)</span>
<a id="__codelineno-19-45" name="__codelineno-19-45" href="#__codelineno-19-45"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">requestDisposition</span><span class="p">(</span>
<a id="__codelineno-19-46" name="__codelineno-19-46" href="#__codelineno-19-46"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-19-47" name="__codelineno-19-47" href="#__codelineno-19-47"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-19-48" name="__codelineno-19-48" href="#__codelineno-19-48"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-19-49" name="__codelineno-19-49" href="#__codelineno-19-49"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-19-50" name="__codelineno-19-50" href="#__codelineno-19-50"></a><span class="w">            </span><span class="n">DispositionOption</span><span class="w"> </span><span class="n">dispositionOption</span><span class="p">,</span>
<a id="__codelineno-19-51" name="__codelineno-19-51" href="#__codelineno-19-51"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-52" name="__codelineno-19-52" href="#__codelineno-19-52"></a>
<a id="__codelineno-19-53" name="__codelineno-19-53" href="#__codelineno-19-53"></a><span class="w">        </span><span class="c1">// In a real implementation, this would make an API call to a disposition service</span>
<a id="__codelineno-19-54" name="__codelineno-19-54" href="#__codelineno-19-54"></a><span class="w">        </span><span class="c1">// or update a database with the disposition request</span>
<a id="__codelineno-19-55" name="__codelineno-19-55" href="#__codelineno-19-55"></a>
<a id="__codelineno-19-56" name="__codelineno-19-56" href="#__codelineno-19-56"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Car disposition requested for "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">carMake</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">" "</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-19-57" name="__codelineno-19-57" href="#__codelineno-19-57"></a><span class="w">                </span><span class="n">carModel</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">" ("</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">carYear</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"), Car #"</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-19-58" name="__codelineno-19-58" href="#__codelineno-19-58"></a><span class="w">                </span><span class="n">carNumber</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">": "</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-19-59" name="__codelineno-19-59" href="#__codelineno-19-59"></a><span class="w">                </span><span class="n">dispositionOption</span><span class="p">.</span><span class="na">getDescription</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<a id="__codelineno-19-60" name="__codelineno-19-60" href="#__codelineno-19-60"></a><span class="w">                </span><span class="s">"\n"</span><span class="p">;</span>
<a id="__codelineno-19-61" name="__codelineno-19-61" href="#__codelineno-19-61"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">" DispositionTool result: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
<a id="__codelineno-19-62" name="__codelineno-19-62" href="#__codelineno-19-62"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<a id="__codelineno-19-63" name="__codelineno-19-63" href="#__codelineno-19-63"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-19-64" name="__codelineno-19-64" href="#__codelineno-19-64"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key Points:</strong></p>
<ul>
<li><strong>One method</strong>: <code>requestDisposition</code></li>
<li><strong>@Tool annotation</strong>: Makes each method available to the AI agent</li>
<li><strong>Detailed descriptions</strong>: Help the AI agent choose the appropriate action</li>
</ul>
<h3 id="step-9-create-the-dispositionagent-ai-service">Step 9: Create the DispositionAgent (AI Service)<a class="headerlink" href="#step-9-create-the-dispositionagent-ai-service" title="Permanent link"></a></h3>
<p>The AI agent that actually makes disposition decisions.</p>
<p>In <code>src/main/java/com/demo</code>, create <code>DispositionAgent.java</code>:</p>
<div class="highlight"><span class="filename">DispositionAgent.java</span><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.demo</span><span class="p">;</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.service.SystemMessage</span><span class="p">;</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">dev.langchain4j.service.UserMessage</span><span class="p">;</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.quarkiverse.langchain4j.RegisterAiService</span><span class="p">;</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.quarkiverse.langchain4j.ToolBox</span><span class="p">;</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.enterprise.context.ApplicationScoped</span><span class="p">;</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="cm">/**</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="cm"> * Agent that determines how to dispose of a car.</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="cm"> */</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="nd">@RegisterAiService</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="nd">@ApplicationScoped</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">DispositionAgent</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="w">    </span><span class="nd">@SystemMessage</span><span class="p">(</span><span class="s">"""</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="s">        /nothink, Reasoning: low.</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="s">        You handle intake for the car disposition department.</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="s">        It is your job to submit a request to the provided DispositionTool function to take action on the request (SCRAP, SELL, or DONATE).</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="s">        Be specific about what disposition option is most appropriate based on the car's condition.</span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="s">        """</span><span class="p">)</span>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="w">    </span><span class="nd">@UserMessage</span><span class="p">(</span><span class="s">"""</span>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a><span class="s">        Car Information:</span>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="s">        Make: {carMake}</span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a><span class="s">        Model: {carModel}</span>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a><span class="s">        Year: {carYear}</span>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a><span class="s">        Car Number: {carNumber}</span>
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a>
<a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a><span class="s">        Previous Car Condition:</span>
<a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a><span class="s">        {carCondition}</span>
<a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a>
<a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a><span class="s">        Disposition Request:</span>
<a id="__codelineno-20-33" name="__codelineno-20-33" href="#__codelineno-20-33"></a><span class="s">        {dispositionRequest}</span>
<a id="__codelineno-20-34" name="__codelineno-20-34" href="#__codelineno-20-34"></a><span class="s">        """</span><span class="p">)</span>
<a id="__codelineno-20-35" name="__codelineno-20-35" href="#__codelineno-20-35"></a><span class="w">    </span><span class="nd">@ToolBox</span><span class="p">(</span><span class="n">DispositionTool</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<a id="__codelineno-20-36" name="__codelineno-20-36" href="#__codelineno-20-36"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">processDisposition</span><span class="p">(</span>
<a id="__codelineno-20-37" name="__codelineno-20-37" href="#__codelineno-20-37"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="p">,</span>
<a id="__codelineno-20-38" name="__codelineno-20-38" href="#__codelineno-20-38"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span>
<a id="__codelineno-20-39" name="__codelineno-20-39" href="#__codelineno-20-39"></a><span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span>
<a id="__codelineno-20-40" name="__codelineno-20-40" href="#__codelineno-20-40"></a><span class="w">            </span><span class="n">Long</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span>
<a id="__codelineno-20-41" name="__codelineno-20-41" href="#__codelineno-20-41"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span>
<a id="__codelineno-20-42" name="__codelineno-20-42" href="#__codelineno-20-42"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">dispositionRequest</span><span class="p">);</span>
<a id="__codelineno-20-43" name="__codelineno-20-43" href="#__codelineno-20-43"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Key Points:</strong></p>
<ul>
<li><strong><code>@RegisterAiService</code></strong>: Registers this as an AI service (not an agentic agent)</li>
<li><strong><code>@ToolBox(DispositionTool.class)</code></strong>: Has access to the DispositionTool</li>
<li><strong>System message</strong>: Defines the agent as a car disposition specialist</li>
<li><strong>Decision criteria</strong>: Considers condition, age, safety, and recommendation from the feedback agent</li>
</ul>
<div class="admonition note">
<p class="admonition-title">AI Service vs. Agentic Agent</p>
<p>Notice this is a <strong>traditional AI service</strong> (from Section 1), not an agentic workflow. 
The A2A server can expose both types.</p>
</div>
<h3 id="step-10-create-the-agentcard">Step 10: Create the AgentCard<a class="headerlink" href="#step-10-create-the-agentcard" title="Permanent link"></a></h3>
<p>The <strong>AgentCard</strong> describes the agents capabilities, skills, and interface.</p>
<p>In <code>src/main/java/com/demo</code>, create <code>DispositionAgentCard.java</code>:</p>
<div class="highlight"><span class="filename">DispositionAgentCard.java</span><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.demo</span><span class="p">;</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.enterprise.context.ApplicationScoped</span><span class="p">;</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.enterprise.inject.Produces</span><span class="p">;</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.server.PublicAgentCard</span><span class="p">;</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.AgentCapabilities</span><span class="p">;</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.AgentCard</span><span class="p">;</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.AgentInterface</span><span class="p">;</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.AgentSkill</span><span class="p">;</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.TransportProtocol</span><span class="p">;</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="nd">@ApplicationScoped</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DispositionAgentCard</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="w">    </span><span class="nd">@Produces</span>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="hll"><span class="w">    </span><span class="nd">@PublicAgentCard</span>
</span><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="hll"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">AgentCard</span><span class="w"> </span><span class="nf">agentCard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AgentCard</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span>
</span><a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a><span class="w">                </span><span class="p">.</span><span class="na">name</span><span class="p">(</span><span class="s">"Disposition Agent"</span><span class="p">)</span>
<a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a><span class="w">                </span><span class="p">.</span><span class="na">description</span><span class="p">(</span><span class="s">"Determines how a car should be disposed of based on the car condition and disposition request."</span><span class="p">)</span>
<a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a><span class="w">                </span><span class="p">.</span><span class="na">url</span><span class="p">(</span><span class="s">"http://localhost:8888/"</span><span class="p">)</span>
<a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a><span class="w">                </span><span class="p">.</span><span class="na">version</span><span class="p">(</span><span class="s">"1.0.0"</span><span class="p">)</span>
<a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a><span class="w">                </span><span class="p">.</span><span class="na">protocolVersion</span><span class="p">(</span><span class="s">"1.0.0"</span><span class="p">)</span>
<a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a><span class="w">                </span><span class="p">.</span><span class="na">capabilities</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AgentCapabilities</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span>
<a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a><span class="w">                        </span><span class="p">.</span><span class="na">streaming</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a><span class="w">                        </span><span class="p">.</span><span class="na">pushNotifications</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a><span class="w">                        </span><span class="p">.</span><span class="na">stateTransitionHistory</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a><span class="w">                        </span><span class="p">.</span><span class="na">build</span><span class="p">())</span>
<a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a><span class="w">                </span><span class="p">.</span><span class="na">defaultInputModes</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"text"</span><span class="p">))</span>
<a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a><span class="w">                </span><span class="p">.</span><span class="na">defaultOutputModes</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"text"</span><span class="p">))</span>
<a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a><span class="w">                </span><span class="p">.</span><span class="na">skills</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AgentSkill</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span>
<a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a><span class="w">                                </span><span class="p">.</span><span class="na">id</span><span class="p">(</span><span class="s">"disposition"</span><span class="p">)</span>
<a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a><span class="w">                                </span><span class="p">.</span><span class="na">name</span><span class="p">(</span><span class="s">"Car disposition"</span><span class="p">)</span>
<a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a><span class="w">                                </span><span class="p">.</span><span class="na">description</span><span class="p">(</span><span class="s">"Makes a request to dispose of a car (SCRAP, SELL, or DONATE)"</span><span class="p">)</span>
<a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a><span class="w">                                </span><span class="p">.</span><span class="na">tags</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"disposition"</span><span class="p">))</span>
<a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a><span class="w">                                </span><span class="p">.</span><span class="na">build</span><span class="p">()))</span>
<a id="__codelineno-21-40" name="__codelineno-21-40" href="#__codelineno-21-40"></a><span class="w">                </span><span class="p">.</span><span class="na">preferredTransport</span><span class="p">(</span><span class="n">TransportProtocol</span><span class="p">.</span><span class="na">JSONRPC</span><span class="p">.</span><span class="na">asString</span><span class="p">())</span>
<a id="__codelineno-21-41" name="__codelineno-21-41" href="#__codelineno-21-41"></a><span class="w">                </span><span class="p">.</span><span class="na">additionalInterfaces</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<a id="__codelineno-21-42" name="__codelineno-21-42" href="#__codelineno-21-42"></a><span class="w">                        </span><span class="k">new</span><span class="w"> </span><span class="n">AgentInterface</span><span class="p">(</span><span class="n">TransportProtocol</span><span class="p">.</span><span class="na">JSONRPC</span><span class="p">.</span><span class="na">asString</span><span class="p">(),</span><span class="w"> </span><span class="s">"http://localhost:8888"</span><span class="p">)))</span>
<a id="__codelineno-21-43" name="__codelineno-21-43" href="#__codelineno-21-43"></a><span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<a id="__codelineno-21-44" name="__codelineno-21-44" href="#__codelineno-21-44"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-21-45" name="__codelineno-21-45" href="#__codelineno-21-45"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Lets break it down:</strong></p>
<h4 id="publicagentcard-annotation"><code>@PublicAgentCard</code> Annotation<a class="headerlink" href="#publicagentcard-annotation" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nd">@Produces</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="nd">@PublicAgentCard</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="kd">public</span><span class="w"> </span><span class="n">AgentCard</span><span class="w"> </span><span class="nf">agentCard</span><span class="p">();</span>
</code></pre></div>
<p>This makes the AgentCard available at the <code>/card</code> endpoint. 
Clients can query this endpoint to discover the agents capabilities.</p>
<h4 id="agentcard-components">AgentCard Components<a class="headerlink" href="#agentcard-components" title="Permanent link"></a></h4>
<p><strong>Basic Information:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="p">.</span><span class="na">name</span><span class="p">(</span><span class="s">"Disposition Agent"</span><span class="p">)</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="p">.</span><span class="na">description</span><span class="p">(</span><span class="s">"Determines how a car should be disposed of based on the car condition and disposition request."</span><span class="p">)</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="p">.</span><span class="na">url</span><span class="p">(</span><span class="s">"http://localhost:8888/"</span><span class="p">)</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="p">.</span><span class="na">version</span><span class="p">(</span><span class="s">"1.0.0"</span><span class="p">)</span>
</code></pre></div>
<p><strong>Capabilities:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="p">.</span><span class="na">capabilities</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AgentCapabilities</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">        </span><span class="p">.</span><span class="na">streaming</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">        </span><span class="p">.</span><span class="na">pushNotifications</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">        </span><span class="p">.</span><span class="na">stateTransitionHistory</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">        </span><span class="p">.</span><span class="na">build</span><span class="p">())</span>
</code></pre></div>
<p><strong>Skills:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="p">.</span><span class="na">skills</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AgentSkill</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span><span class="p">.</span><span class="na">id</span><span class="p">(</span><span class="s">"disposition"</span><span class="p">)</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">    </span><span class="p">.</span><span class="na">name</span><span class="p">(</span><span class="s">"Car disposition"</span><span class="p">)</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">    </span><span class="p">.</span><span class="na">description</span><span class="p">(</span><span class="s">"Makes a request to dispose of a car (SCRAP, SELL, or DONATE)"</span><span class="p">)</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">    </span><span class="p">.</span><span class="na">tags</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"disposition"</span><span class="p">))</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">    </span><span class="p">.</span><span class="na">build</span><span class="p">()))</span>
</code></pre></div>
<p>Skills describe what the agent can do. This helps clients discover appropriate agents for their needs.</p>
<p><strong>Transport Protocol:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="p">.</span><span class="na">preferredTransport</span><span class="p">(</span><span class="n">TransportProtocol</span><span class="p">.</span><span class="na">JSONRPC</span><span class="p">.</span><span class="na">asString</span><span class="p">())</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="p">.</span><span class="na">additionalInterfaces</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">AgentInterface</span><span class="p">(</span><span class="n">TransportProtocol</span><span class="p">.</span><span class="na">JSONRPC</span><span class="p">.</span><span class="na">asString</span><span class="p">(),</span><span class="w"> </span><span class="s">"http://localhost:8888"</span><span class="p">)))</span>
</code></pre></div>
<p>Specifies that this agent communicates via JSON-RPC over HTTP.</p>
<h3 id="step-11-create-the-agentexecutor">Step 11: Create the AgentExecutor<a class="headerlink" href="#step-11-create-the-agentexecutor" title="Permanent link"></a></h3>
<p>The <strong>AgentExecutor</strong> handles incoming A2A requests and orchestrates the AI agent.</p>
<p>In <code>src/main/java/com/demo</code>, create <code>DispositionAgentExecutor.java</code>:</p>
<div class="highlight"><span class="filename">DispositionAgentExecutor.java</span><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.demo</span><span class="p">;</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.enterprise.context.ApplicationScoped</span><span class="p">;</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.enterprise.inject.Produces</span><span class="p">;</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.inject.Inject</span><span class="p">;</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.server.agentexecution.AgentExecutor</span><span class="p">;</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.server.agentexecution.RequestContext</span><span class="p">;</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.server.events.EventQueue</span><span class="p">;</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.server.tasks.TaskUpdater</span><span class="p">;</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a>
<a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.JSONRPCError</span><span class="p">;</span>
<a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.Message</span><span class="p">;</span>
<a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.Part</span><span class="p">;</span>
<a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.TextPart</span><span class="p">;</span>
<a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="kn">import</span><span class="w"> </span><span class="nn">io.a2a.spec.UnsupportedOperationError</span><span class="p">;</span>
<a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a>
<a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="cm">/**</span>
<a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a><span class="cm"> * Executor for the DispositionAgent.</span>
<a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a><span class="cm"> * Handles the integration between the A2A framework and the DispositionAgent.</span>
<a id="__codelineno-27-23" name="__codelineno-27-23" href="#__codelineno-27-23"></a><span class="cm"> */</span>
<a id="__codelineno-27-24" name="__codelineno-27-24" href="#__codelineno-27-24"></a><span class="nd">@ApplicationScoped</span>
<a id="__codelineno-27-25" name="__codelineno-27-25" href="#__codelineno-27-25"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DispositionAgentExecutor</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-26" name="__codelineno-27-26" href="#__codelineno-27-26"></a>
<a id="__codelineno-27-27" name="__codelineno-27-27" href="#__codelineno-27-27"></a><span class="w">    </span><span class="nd">@Inject</span>
<a id="__codelineno-27-28" name="__codelineno-27-28" href="#__codelineno-27-28"></a><span class="w">    </span><span class="n">DispositionAgent</span><span class="w"> </span><span class="n">dispositionAgent</span><span class="p">;</span>
<a id="__codelineno-27-29" name="__codelineno-27-29" href="#__codelineno-27-29"></a>
<a id="__codelineno-27-30" name="__codelineno-27-30" href="#__codelineno-27-30"></a><span class="w">    </span><span class="nd">@Inject</span>
<a id="__codelineno-27-31" name="__codelineno-27-31" href="#__codelineno-27-31"></a><span class="w">    </span><span class="n">DispositionTool</span><span class="w"> </span><span class="n">dispositionTool</span><span class="p">;</span>
<a id="__codelineno-27-32" name="__codelineno-27-32" href="#__codelineno-27-32"></a>
<a id="__codelineno-27-33" name="__codelineno-27-33" href="#__codelineno-27-33"></a><span class="w">    </span><span class="nd">@Produces</span>
<a id="__codelineno-27-34" name="__codelineno-27-34" href="#__codelineno-27-34"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">AgentExecutor</span><span class="w"> </span><span class="nf">agentExecutor</span><span class="p">(</span><span class="n">DispositionAgent</span><span class="w"> </span><span class="n">dispositionAgent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-35" name="__codelineno-27-35" href="#__codelineno-27-35"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AgentExecutor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-36" name="__codelineno-27-36" href="#__codelineno-27-36"></a><span class="w">            </span><span class="nd">@Override</span>
<a id="__codelineno-27-37" name="__codelineno-27-37" href="#__codelineno-27-37"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="n">RequestContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">EventQueue</span><span class="w"> </span><span class="n">eventQueue</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">JSONRPCError</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-38" name="__codelineno-27-38" href="#__codelineno-27-38"></a>
<a id="__codelineno-27-39" name="__codelineno-27-39" href="#__codelineno-27-39"></a><span class="w">                </span><span class="n">TaskUpdater</span><span class="w"> </span><span class="n">updater</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TaskUpdater</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">eventQueue</span><span class="p">);</span>
<a id="__codelineno-27-40" name="__codelineno-27-40" href="#__codelineno-27-40"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="na">getTask</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-41" name="__codelineno-27-41" href="#__codelineno-27-41"></a><span class="w">                    </span><span class="n">updater</span><span class="p">.</span><span class="na">submit</span><span class="p">();</span>
<a id="__codelineno-27-42" name="__codelineno-27-42" href="#__codelineno-27-42"></a><span class="w">                </span><span class="p">}</span>
<a id="__codelineno-27-43" name="__codelineno-27-43" href="#__codelineno-27-43"></a><span class="w">                </span><span class="n">updater</span><span class="p">.</span><span class="na">startWork</span><span class="p">();</span>
<a id="__codelineno-27-44" name="__codelineno-27-44" href="#__codelineno-27-44"></a>
<a id="__codelineno-27-45" name="__codelineno-27-45" href="#__codelineno-27-45"></a><span class="w">                </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<a id="__codelineno-27-46" name="__codelineno-27-46" href="#__codelineno-27-46"></a>
<a id="__codelineno-27-47" name="__codelineno-27-47" href="#__codelineno-27-47"></a><span class="w">                </span><span class="c1">// Process the request message</span>
<a id="__codelineno-27-48" name="__codelineno-27-48" href="#__codelineno-27-48"></a><span class="w">                </span><span class="n">Message</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getMessage</span><span class="p">();</span>
<a id="__codelineno-27-49" name="__codelineno-27-49" href="#__codelineno-27-49"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="na">getParts</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-50" name="__codelineno-27-50" href="#__codelineno-27-50"></a><span class="w">                    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Part</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">message</span><span class="p">.</span><span class="na">getParts</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-51" name="__codelineno-27-51" href="#__codelineno-27-51"></a><span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">part</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">TextPart</span><span class="w"> </span><span class="n">textPart</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-52" name="__codelineno-27-52" href="#__codelineno-27-52"></a><span class="w">                            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">"\uD83D\uDCAC Text part: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">textPart</span><span class="p">.</span><span class="na">getText</span><span class="p">());</span>
<a id="__codelineno-27-53" name="__codelineno-27-53" href="#__codelineno-27-53"></a><span class="w">                            </span><span class="n">inputs</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">textPart</span><span class="p">.</span><span class="na">getText</span><span class="p">());</span>
<a id="__codelineno-27-54" name="__codelineno-27-54" href="#__codelineno-27-54"></a><span class="w">                        </span><span class="p">}</span>
<a id="__codelineno-27-55" name="__codelineno-27-55" href="#__codelineno-27-55"></a><span class="w">                    </span><span class="p">}</span>
<a id="__codelineno-27-56" name="__codelineno-27-56" href="#__codelineno-27-56"></a><span class="w">                </span><span class="p">}</span>
<a id="__codelineno-27-57" name="__codelineno-27-57" href="#__codelineno-27-57"></a>
<a id="__codelineno-27-58" name="__codelineno-27-58" href="#__codelineno-27-58"></a><span class="w">                </span><span class="c1">// Call the agent with all parameters as strings</span>
<a id="__codelineno-27-59" name="__codelineno-27-59" href="#__codelineno-27-59"></a><span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">agentResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dispositionAgent</span><span class="p">.</span><span class="na">processDisposition</span><span class="p">(</span>
<a id="__codelineno-27-60" name="__codelineno-27-60" href="#__codelineno-27-60"></a><span class="w">                        </span><span class="n">inputs</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w">                      </span><span class="c1">// carMake</span>
<a id="__codelineno-27-61" name="__codelineno-27-61" href="#__codelineno-27-61"></a><span class="w">                        </span><span class="n">inputs</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w">                      </span><span class="c1">// carModel</span>
<a id="__codelineno-27-62" name="__codelineno-27-62" href="#__codelineno-27-62"></a><span class="w">                        </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="w">    </span><span class="c1">// carYear</span>
<a id="__codelineno-27-63" name="__codelineno-27-63" href="#__codelineno-27-63"></a><span class="w">                        </span><span class="n">Long</span><span class="p">.</span><span class="na">parseLong</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span><span class="w">      </span><span class="c1">// carNumber</span>
<a id="__codelineno-27-64" name="__codelineno-27-64" href="#__codelineno-27-64"></a><span class="w">                        </span><span class="n">inputs</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="w">                      </span><span class="c1">// carCondition</span>
<a id="__codelineno-27-65" name="__codelineno-27-65" href="#__codelineno-27-65"></a><span class="w">                        </span><span class="n">inputs</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span><span class="w">                     </span><span class="c1">// dispositionRequest</span>
<a id="__codelineno-27-66" name="__codelineno-27-66" href="#__codelineno-27-66"></a>
<a id="__codelineno-27-67" name="__codelineno-27-67" href="#__codelineno-27-67"></a><span class="w">                </span><span class="c1">// Return the result</span>
<a id="__codelineno-27-68" name="__codelineno-27-68" href="#__codelineno-27-68"></a><span class="w">                </span><span class="n">TextPart</span><span class="w"> </span><span class="n">responsePart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TextPart</span><span class="p">(</span><span class="n">agentResponse</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
<a id="__codelineno-27-69" name="__codelineno-27-69" href="#__codelineno-27-69"></a><span class="w">                </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Part</span><span class="o">&lt;?&gt;&gt;</span><span class="w"> </span><span class="n">parts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">responsePart</span><span class="p">);</span>
<a id="__codelineno-27-70" name="__codelineno-27-70" href="#__codelineno-27-70"></a><span class="w">                </span><span class="n">updater</span><span class="p">.</span><span class="na">addArtifact</span><span class="p">(</span><span class="n">parts</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
<a id="__codelineno-27-71" name="__codelineno-27-71" href="#__codelineno-27-71"></a><span class="w">                </span><span class="n">updater</span><span class="p">.</span><span class="na">complete</span><span class="p">();</span>
<a id="__codelineno-27-72" name="__codelineno-27-72" href="#__codelineno-27-72"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-27-73" name="__codelineno-27-73" href="#__codelineno-27-73"></a>
<a id="__codelineno-27-74" name="__codelineno-27-74" href="#__codelineno-27-74"></a><span class="w">            </span><span class="nd">@Override</span>
<a id="__codelineno-27-75" name="__codelineno-27-75" href="#__codelineno-27-75"></a><span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">cancel</span><span class="p">(</span><span class="n">RequestContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">EventQueue</span><span class="w"> </span><span class="n">eventQueue</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">JSONRPCError</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-76" name="__codelineno-27-76" href="#__codelineno-27-76"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UnsupportedOperationError</span><span class="p">();</span>
<a id="__codelineno-27-77" name="__codelineno-27-77" href="#__codelineno-27-77"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-27-78" name="__codelineno-27-78" href="#__codelineno-27-78"></a><span class="w">        </span><span class="p">};</span>
<a id="__codelineno-27-79" name="__codelineno-27-79" href="#__codelineno-27-79"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-27-80" name="__codelineno-27-80" href="#__codelineno-27-80"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Lets break it down:</strong></p>
<h4 id="cdi-bean-with-agentexecutor-factory">CDI Bean with AgentExecutor Factory<a class="headerlink" href="#cdi-bean-with-agentexecutor-factory" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="nd">@ApplicationScoped</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DispositionAgentExecutor</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">    </span><span class="nd">@Produces</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">AgentExecutor</span><span class="w"> </span><span class="nf">agentExecutor</span><span class="p">(</span><span class="n">DispositionAgent</span><span class="w"> </span><span class="n">dispositionAgent</span><span class="p">)</span>
</code></pre></div>
<p>Produces an <code>AgentExecutor</code> bean that Quarkus LangChain4j will use to handle A2A task requests.</p>
<h4 id="task-processing">Task Processing<a class="headerlink" href="#task-processing" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="n">RequestContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">EventQueue</span><span class="w"> </span><span class="n">eventQueue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">    </span><span class="n">TaskUpdater</span><span class="w"> </span><span class="n">updater</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TaskUpdater</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">eventQueue</span><span class="p">);</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">    </span><span class="c1">// Extract input parts from the task</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w">    </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">MessagePart</span><span class="o">&gt;</span><span class="w"> </span><span class="n">inputParts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">task</span><span class="p">().</span><span class="na">input</span><span class="p">();</span>
</code></pre></div>
<p>The <code>RequestContext</code> contains the incoming task with all input parameters sent by the client.</p>
<h4 id="extract-parameters">Extract Parameters<a class="headerlink" href="#extract-parameters" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="n">String</span><span class="w"> </span><span class="n">carMake</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getTextPart</span><span class="p">(</span><span class="n">inputParts</span><span class="p">,</span><span class="w"> </span><span class="s">"carMake"</span><span class="p">);</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="n">String</span><span class="w"> </span><span class="n">carModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getTextPart</span><span class="p">(</span><span class="n">inputParts</span><span class="p">,</span><span class="w"> </span><span class="s">"carModel"</span><span class="p">);</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="n">Integer</span><span class="w"> </span><span class="n">carYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getIntegerPart</span><span class="p">(</span><span class="n">inputParts</span><span class="p">,</span><span class="w"> </span><span class="s">"carYear"</span><span class="p">);</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="c1">// ... etc</span>
</code></pre></div>
<p>Extracts each parameter by name from the task input. These names must match the client agents method parameters.</p>
<h4 id="call-the-ai-agent">Call the AI Agent<a class="headerlink" href="#call-the-ai-agent" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dispositionAgent</span><span class="p">.</span><span class="na">processDisposition</span><span class="p">(</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="w">    </span><span class="n">carMake</span><span class="p">,</span><span class="w"> </span><span class="n">carModel</span><span class="p">,</span><span class="w"> </span><span class="n">carYear</span><span class="p">,</span><span class="w"> </span><span class="n">carNumber</span><span class="p">,</span><span class="w"> </span><span class="n">carCondition</span><span class="p">,</span><span class="w"> </span><span class="n">dispositionRequest</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="p">);</span>
</code></pre></div>
<p>Invokes the AI agent to process the disposition request.</p>
<h4 id="update-task-status">Update Task Status<a class="headerlink" href="#update-task-status" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="n">updater</span><span class="p">.</span><span class="na">finishTask</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">MessagePart</span><span class="p">.</span><span class="na">text</span><span class="p">(</span><span class="n">result</span><span class="p">)));</span>
</code></pre></div>
<p>Sends the result back to the client via the <code>TaskUpdater</code>. This completes the A2A task.</p>
<h4 id="helper-methods">Helper Methods<a class="headerlink" href="#helper-methods" title="Permanent link"></a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getTextPart</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">MessagePart</span><span class="o">&gt;</span><span class="w"> </span><span class="n">parts</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="w">    </span><span class="n">MessagePart</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parts</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">part</span><span class="p">.</span><span class="na">content</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">""</span><span class="p">;</span>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="p">}</span>
</code></pre></div>
<p>Safely extracts text values from MessagePart objects.</p>
<hr>
<h2 id="try-it-out">Try It Out<a class="headerlink" href="#try-it-out" title="Permanent link"></a></h2>
<p>Youll need to run <strong>two applications simultaneously</strong>.</p>
<h3 id="terminal-1-start-the-remote-a2a-server">Terminal 1: Start the Remote A2A Server<a class="headerlink" href="#terminal-1-start-the-remote-a2a-server" title="Permanent link"></a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="nb">cd</span><span class="w"> </span>section-2/step-05/remote-a2a-agent
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>./mvnw<span class="w"> </span>quarkus:dev
</code></pre></div>
<p>Wait for:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>Listening on: http://localhost:8888
</code></pre></div>
<p>The disposition service is now running and ready to accept A2A requests!</p>
<h3 id="terminal-2-start-the-main-application">Terminal 2: Start the Main Application<a class="headerlink" href="#terminal-2-start-the-main-application" title="Permanent link"></a></h3>
<p>Open a <strong>new terminal</strong> and run:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="nb">cd</span><span class="w"> </span>section-2/step-05/multi-agent-system
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>./mvnw<span class="w"> </span>quarkus:dev
</code></pre></div>
<p>Wait for:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>Listening on: http://localhost:8080
</code></pre></div>
<h3 id="test-the-complete-flow">Test the Complete Flow<a class="headerlink" href="#test-the-complete-flow" title="Permanent link"></a></h3>
<p>Open your browser to <a href="http://localhost:8080" target="_blank">http://localhost:8080</a>.</p>
<p>Youll see the same UI as Step 4 with the <strong>Returns and Dispositions</strong> section and the <strong>Dispositions</strong> tab (introduced in Step 4).</p>
<p><img alt="Maintenance Returns Tab" class="center" src="../../images/agentic-UI-maintenance-returns-2.png"></p>
<p>On the Maintenance Return tab, enter feedback indicating severe damage for the Ford F-150:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>looks like this car hit a tree
</code></pre></div>
<p>Click <strong>Return</strong>.</p>
<p><strong>What happens?</strong></p>
<ol>
<li>
<p><strong>Parallel Analysis</strong> (FeedbackWorkflow):</p>
<ol>
<li><code>DispositionFeedbackAgent</code>: Disposition required  severe damage</li>
<li><code>MaintenanceFeedbackAgent</code>: Major repairs needed</li>
<li><code>CleaningFeedbackAgent</code>: Not applicable</li>
</ol>
</li>
<li>
<p><strong>Conditional Routing</strong> (CarAssignmentWorkflow):</p>
<ol>
<li>Disposition condition: <code>true</code> (required)</li>
<li> Executes <code>DispositionAgent</code> (A2A client)</li>
</ol>
</li>
<li>
<p><strong>A2A Communication</strong>:</p>
<ol>
<li>Client sends task to <code>http://localhost:8888</code></li>
<li><code>AgentExecutor</code> receives and processes task</li>
<li><code>DispositionAgent</code> (AI service) analyzes using <code>DispositionTool</code></li>
<li>Result flows back to client</li>
</ol>
</li>
<li>
<p><strong>UI Update</strong>:</p>
<ol>
<li>Car status  <code>DISPOSED</code></li>
<li>Car appears in the Dispositions tab</li>
</ol>
</li>
</ol>
<h3 id="check-the-logs">Check the Logs<a class="headerlink" href="#check-the-logs" title="Permanent link"></a></h3>
<p><strong>Terminal 1 (Remote A2A Server):</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a> DispositionTool result: Ford F-150 (2021), Car #11: Scrap the car
</code></pre></div>
<p><strong>Terminal 2 (Main Application):</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>[DispositionFeedbackAgent] DISPOSITION_REQUIRED - Severe structural damage, uneconomical to repair
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>[CarAssignmentWorkflow] Activating DispositionAgent
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>[DispositionAgent @A2AClientAgent] Sending task to http://localhost:8888
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>[DispositionAgent @A2AClientAgent] Received result: Car should be scrapped...
</code></pre></div>
<p>Notice the <strong>cross-application communication</strong> via A2A!</p>
<hr>
<h2 id="how-it-all-works-together">How It All Works Together<a class="headerlink" href="#how-it-all-works-together" title="Permanent link"></a></h2>
<p>Lets trace the complete flow:</p>
<div class="panzoom-box" data-key="alt" id="panzoom0" oncontextmenu="return false;">
    
    <nav class="panzoom-nav">
    <button class="panzoom-info panzoom-button">
    <svg class="panzoom-icon" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm169.8-90.7c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"></path>
    </svg>
</button><button class="panzoom-reset panzoom-button">
    <svg class="panzoom-icon" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M125.7 160l50.3 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L48 224c-17.7 0-32-14.3-32-32L16 64c0-17.7 14.3-32 32-32s32 14.3 32 32l0 51.2L97.6 97.6c87.5-87.5 229.3-87.5 316.8 0s87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3s-163.8-62.5-226.3 0L125.7 160z"></path>
    </svg>
</button><button class="panzoom-max panzoom-button">
    <svg class="panzoom-icon" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M32 32C14.3 32 0 46.3 0 64l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L32 32zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM448 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96z"></path>
    </svg>
</button><button class="panzoom-min panzoom-button panzoom-hidden">
    <svg class="panzoom-icon" viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
        <path d="M160 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64-64 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l96 0c17.7 0 32-14.3 32-32l0-96zM32 320c-17.7 0-32 14.3-32 32s14.3 32 32 32l64 0 0 64c0 17.7 14.3 32 32 32s32-14.3 32-32l0-96c0-17.7-14.3-32-32-32l-96 0zM352 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0 0-64zM320 320c-17.7 0-32 14.3-32 32l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0z"></path>
    </svg>
</button>
    </nav>
    <pre class="mermaid"><code>sequenceDiagram
    participant User
    participant Service as CarManagementService
    participant Workflow as CarProcessingWorkflow
    participant FeedbackWF as FeedbackWorkflow
    participant ActionWF as CarAssignmentWorkflow
    participant Client as DispositionAgent&lt;br/&gt;@A2AClientAgent
    participant A2A as A2A Protocol&lt;br/&gt;(JSON-RPC)
    participant Executor as AgentExecutor
    participant Remote as DispositionAgent&lt;br/&gt;AI Service
    participant Tool as DispositionTool

    User-&gt;&gt;Service: Return car with severe damage
    Service-&gt;&gt;Workflow: processCarReturn(...)

    rect rgb(255, 243, 205)
    Note over Workflow,FeedbackWF: Parallel Analysis
    Workflow-&gt;&gt;FeedbackWF: Execute
    par Concurrent Execution
        FeedbackWF-&gt;&gt;FeedbackWF: CleaningFeedbackAgent
    and
        FeedbackWF-&gt;&gt;FeedbackWF: MaintenanceFeedbackAgent
    and
        FeedbackWF-&gt;&gt;FeedbackWF: DispositionFeedbackAgent&lt;br/&gt;Result: "DISPOSITION_REQUIRED"
    end
    end

    rect rgb(248, 215, 218)
    Note over Workflow,ActionWF: Conditional Routing
    Workflow-&gt;&gt;ActionWF: Execute
    ActionWF-&gt;&gt;ActionWF: Check: dispositionRequest required? YES
    ActionWF-&gt;&gt;Client: Execute DispositionAgent
    end

    rect rgb(212, 237, 218)
    Note over Client,Tool: A2A Communication
    Client-&gt;&gt;A2A: Create Task with inputs
    A2A-&gt;&gt;Executor: POST /tasks
    Executor-&gt;&gt;Remote: processDisposition(...)
    Remote-&gt;&gt;Tool: scrapCar() / sellCar() / donateCar()
    Tool-&gt;&gt;Tool: Execute disposal action
    Tool-&gt;&gt;Remote: Return result
    Remote-&gt;&gt;Executor: Return recommendation
    Executor-&gt;&gt;A2A: Update task status
    A2A-&gt;&gt;Client: Return result
    end

    Client-&gt;&gt;Workflow: Return disposition result
    Workflow-&gt;&gt;Service: Return CarConditions
    Service-&gt;&gt;Service: Set status to DISPOSED
    Service-&gt;&gt;User: Update UI</code></pre> 
    <div class="panzoom-info-box panzoom-info-box-bottom panzoom-hidden">
Hold "Alt" / "Option" to enable pan &amp; zoom
</div>
</div>
<hr>
<h2 id="understanding-the-a2a-implementation">Understanding the A2A Implementation<a class="headerlink" href="#understanding-the-a2a-implementation" title="Permanent link"></a></h2>
<h3 id="client-side-a2aclientagent">Client Side (<code>@A2AClientAgent</code>)<a class="headerlink" href="#client-side-a2aclientagent" title="Permanent link"></a></h3>
<p>The client agent is remarkably simple:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="nd">@A2AClientAgent</span><span class="p">(</span><span class="n">a2aServerUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"http://localhost:8888"</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="n">String</span><span class="w"> </span><span class="nf">processDisposition</span><span class="p">(...)</span>
</code></pre></div>
<p>Quarkus LangChain4j handles:</p>
<ul>
<li>Creating the A2A task</li>
<li>Serializing method parameters as task inputs</li>
<li>Sending the HTTP request via JSON-RPC</li>
<li>Waiting for the response</li>
<li>Deserializing the result</li>
<li>Error handling and retries</li>
</ul>
<h3 id="server-side-agentcard-agentexecutor">Server Side (AgentCard + AgentExecutor)<a class="headerlink" href="#server-side-agentcard-agentexecutor" title="Permanent link"></a></h3>
<p>The server requires more components:</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>AgentCard</strong></td>
<td>Describes agent capabilities, published at <code>/card</code> endpoint</td>
</tr>
<tr>
<td><strong>AgentExecutor</strong></td>
<td>Receives and processes A2A task requests</td>
</tr>
<tr>
<td><strong>TaskUpdater</strong></td>
<td>Updates task status and sends results back to client</td>
</tr>
<tr>
<td><strong>AI Agent</strong></td>
<td>The actual AI service that processes requests</td>
</tr>
<tr>
<td><strong>Tools</strong></td>
<td>Actions the AI agent can perform</td>
</tr>
</tbody>
</table>
<p>This separation allows:
- Agents to focus on business logic
- A2A infrastructure to handle protocol details
- Multiple agents to be exposed from one server</p>
<hr>
<h2 id="key-takeaways">Key Takeaways<a class="headerlink" href="#key-takeaways" title="Permanent link"></a></h2>
<ul>
<li><strong>A2A enables distributed agents</strong>: Different teams can maintain specialized agents in separate systems</li>
<li><strong><code>@A2AClientAgent</code> is powerful</strong>: Simple annotation transforms a method into an A2A client</li>
<li><strong>AgentCard describes capabilities</strong>: Clients can discover what remote agents can do</li>
<li><strong>AgentExecutor handles protocol</strong>: Separates A2A infrastructure from agent logic</li>
<li><strong>Tasks vs. Messages</strong>: A2A supports both task-based and conversational interactions</li>
<li><strong>Type-safe integration</strong>: Method parameters automatically become task inputs</li>
<li><strong>Remote agents integrate seamlessly</strong>: Works with existing workflows and agents</li>
<li><strong>Two runtimes communicate</strong>: Real-world simulation of distributed agent systems</li>
<li><strong>Architectural trade-offs</strong>: We traded Step 4s sophisticated Supervisor Pattern for simpler Conditional routing to enable distribution</li>
<li><strong>Distribution benefits</strong>: The disposition service can now be maintained independently, scaled separately, and reused by other applications</li>
</ul>
<hr>
<h2 id="experiment-further">Experiment Further<a class="headerlink" href="#experiment-further" title="Permanent link"></a></h2>
<h3 id="1-add-agent-discovery">1. Add Agent Discovery<a class="headerlink" href="#1-add-agent-discovery" title="Permanent link"></a></h3>
<p>The AgentCard is published at <code>http://localhost:8888/card</code>. Try:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>curl<span class="w"> </span>http://localhost:8888/card<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq
</code></pre></div>
<p>Youll see the full agent description including skills, capabilities, and transport protocols.</p>
<h3 id="2-test-different-disposition-scenarios">2. Test Different Disposition Scenarios<a class="headerlink" href="#2-test-different-disposition-scenarios" title="Permanent link"></a></h3>
<p>Try these feedback examples:</p>
<p><strong>Scenario 1: Sell the car</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>Minor engine issues, good body condition, low mileage. Repair cost: $800.
</code></pre></div>
<p><strong>Scenario 2: Donate the car</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>Old car, high mileage, runs but needs work. Market value low.
</code></pre></div>
<p><strong>Scenario 3: Scrap the car</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>Total loss from flood damage, electrical system destroyed.
</code></pre></div>
<p>Observe how the remote agent makes different decisions!</p>
<h3 id="3-create-your-own-a2a-agent">3. Create Your Own A2A Agent<a class="headerlink" href="#3-create-your-own-a2a-agent" title="Permanent link"></a></h3>
<p>What other specialized agents could be useful?</p>
<ul>
<li><strong>Pricing Agent</strong>: Determines optimal rental pricing based on demand</li>
<li><strong>Route Planner Agent</strong>: Plans maintenance schedules for the fleet</li>
<li><strong>Insurance Agent</strong>: Assesses insurance claims for damaged cars</li>
</ul>
<p>Try creating a simple A2A server for one of these!</p>
<h3 id="4-monitor-a2a-communication">4. Monitor A2A Communication<a class="headerlink" href="#4-monitor-a2a-communication" title="Permanent link"></a></h3>
<p>Add logging to see the JSON-RPC messages:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="c1"># In application.properties</span>
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="na">quarkus.log.category."io.a2a".level</span><span class="o">=</span><span class="s">DEBUG</span>
</code></pre></div>
<p>This shows the raw A2A protocol messages.</p>
<hr>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link"></a></h2>
<details class="warning">
<summary>Connection refused to localhost:8888</summary>
<p>Make sure the remote A2A server is running in Terminal 1. Check for:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>Listening on: http://localhost:8888
</code></pre></div>
<p>If you see Port already in use, another application is using port 8888. You can change it in <code>remote-a2a-agent/src/main/resources/application.properties</code>:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="na">quarkus.http.port</span><span class="o">=</span><span class="s">8889</span>
</code></pre></div>
<p>Then update the clients <code>a2aServerUrl</code> accordingly.</p>
</details>
<details class="warning">
<summary>Task execution timeout</summary>
<p>If the remote agent takes too long to respond, you might see a timeout error. The default timeout is sufficient for most cases, but you can increase it if needed by configuring the A2A client.</p>
</details>
<details class="warning">
<summary>Parameter mismatch errors</summary>
<p>If you see errors about missing parameters, verify that:</p>
<ul>
<li>Client agent method parameter names match what AgentExecutor extracts</li>
<li>The <code>getTextPart()</code> / <code>getIntegerPart()</code> calls use the correct keys</li>
<li>All required parameters are being sent by the client</li>
</ul>
</details>
<details class="warning">
<summary>Agent not activating</summary>
<p>If the DispositionAgent never executes, check:</p>
<ul>
<li>The <code>@ActivationCondition</code> method is correctly implemented</li>
<li>The <code>dispositionRequest</code> contains <code>"DISPOSITION_REQUIRED"</code></li>
<li>The condition is being checked in the correct order</li>
</ul>
</details>
<details class="warning">
<summary>Both applications on same port</summary>
<p>If you see Port already in use on 8080:</p>
<ul>
<li>Make sure you stopped the application from Step 04</li>
<li>Only run the main application from <code>multi-agent-system</code>, not from a previous step directory</li>
<li>Check for zombie Java processes: <code>ps aux | grep java</code></li>
</ul>
</details>
<hr>
<h2 id="whats-next">Whats Next?<a class="headerlink" href="#whats-next" title="Permanent link"></a></h2>
<p>Youve successfully converted Step 4s local disposition system into a distributed agent system using the A2A protocol!</p>
<p>You learned how to:</p>
<ul>
<li>Convert local agents to remote A2A services</li>
<li>Connect to remote agents using <code>@A2AClientAgent</code></li>
<li>Build A2A servers with AgentCard and AgentExecutor</li>
<li>Integrate remote agents into complex workflows</li>
<li>Run multiple Quarkus applications that communicate via A2A</li>
<li>Understand the architectural trade-offs between local and distributed agents</li>
</ul>
<p><strong>Key Progression:</strong>
- <strong>Step 4</strong>: Sophisticated local orchestration with Supervisor Pattern
- <strong>Step 5</strong>: Distributed architecture with A2A protocol</p>
<p>This completes <strong>Section 2: Agentic Systems</strong>! Youve progressed from simple agents to complex distributed workflows with remote agent communication.</p>
<p><strong>Congratulations!</strong> You now have the skills to build sophisticated multi-agent systems with Quarkus LangChain4j!</p>
<hr>
<h2 id="additional-resources">Additional Resources<a class="headerlink" href="#additional-resources" title="Permanent link"></a></h2>
<ul>
<li><a href="https://a2a.dev">A2A Protocol Specification</a></li>
<li><a href="https://docs.quarkiverse.io/quarkus-langchain4j/dev/">Quarkus LangChain4j Documentation</a></li>
<li><a href="https://docs.quarkiverse.io/quarkus-langchain4j/dev/agentic.html">Quarkus LangChain4j Agentic Module</a></li>
</ul></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../step-04/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Step 4 - Supervisor pattern for dynamic orchestration">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Step 4 - Supervisor pattern for dynamic orchestration
              </div>
            </div>
          </a>
        
        
          
          <a href="../conclusion/" class="md-footer__link md-footer__link--next" aria-label="Next: Mastering Agentic Systems">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Mastering Agentic Systems
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <!--
  Copyright (c) 2016-2022 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Copyright and theme information, adapter to have the Red Hat footer -->
<div class="md-copyright">
    <div class="md-copyright__highlight">
        <a href="https://creativecommons.org/licenses/by/3.0/">CC by 3.0</a> |
        <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </div>
    
    Made with
    <a
            href="https://squidfunk.github.io/mkdocs-material/"
            target="_blank" rel="noopener"
    >
        Material for MkDocs
    </a>
    
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.sections", "content.tabs.link", "content.code.annotate", "navigation.instant", "navigation.indexes", "navigation.tracking", "navigation.footer", "navigation.tabs.sticky", "content.code.select", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../assets/javascripts/panzoom.min.js"></script>
      
        <script src="../../assets/javascripts/zoompan.js"></script>
      
    
  </body>
</html>